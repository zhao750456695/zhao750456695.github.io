<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>FinGeek</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-07-23T05:45:42.892Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>JieZhao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>svm前奏：凸优化对偶理论</title>
    <link href="http://yoursite.com/post/svm1.html"/>
    <id>http://yoursite.com/post/svm1.html</id>
    <published>2018-07-23T02:28:21.000Z</published>
    <updated>2018-07-23T05:45:42.892Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础知识回顾"><a class="markdownIt-Anchor" href="#基础知识回顾"></a> 基础知识回顾</h1><h2 id="一般优化问题"><a class="markdownIt-Anchor" href="#一般优化问题"></a> 一般优化问题</h2><p>无约束优化问题:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>b</mi></msup><mo>↦</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{R}^b \mapsto \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.860108em;vertical-align:-0.011em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">b</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mspace width="2em"></mspace><mi>x</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">minf(x)   \qquad x \in\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mspace qquad"></span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span></span></p><p>局部最优解常规解法</p><p>直接法</p><p>​        梯度等于0，求得驻点，必要时Hessian矩阵再进一步推断</p><p>迭代法</p><p>​        梯度下降法</p><p>​        牛顿法</p><p>​        拟牛顿法</p><p>一般约束优化问题</p><p>​        约束优化问题一般形式：</p>\begin{align*}&minimize \quad f_0(x)\\&subject \quad to\quad f_i(x)\leqslant0 \quad for \quad i=1,i=2,...,m\\&\qquad\qquad\qquad h_i(x)=0\quad for \quad i=1,2,...,p\end{align*}<p>可行域：满足f(x)定义域和约束条件的x的集合，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f_i(x)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>表明不等式约束被激活。</p><h2 id="凸集和凸函数"><a class="markdownIt-Anchor" href="#凸集和凸函数"></a> 凸集和凸函数</h2><h3 id="凸集"><a class="markdownIt-Anchor" href="#凸集"></a> 凸集</h3><p>如果一个集合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">C \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.72799em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span>是仿射函的，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>中两点间的直线也在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>中，如$x=\theta x_1+(1-\theta )x_2\in C\quad,\theta \in \mathbb{R} , 即AX=b$的解.</p><p>一个集合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">C\in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.72799em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span>是凸的，则对于任意的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">x,y\in C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>,有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mi>x</mi><mo>+</mo><mo>(</mo><mn>1</mn><mo>+</mo><mi>x</mi><mo>)</mo><mi>θ</mi><mo>∈</mo><mi>C</mi><mspace width="1em"></mspace><mn>0</mn><mo>≤</mo><mi>θ</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\theta x+(1+x) \theta \in C \quad 0\le \theta \le 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mspace quad"></span><span class="mord">0</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span>.</p><p>仿射一定是凸集，而反过来则不一定。即连接两点的直线在集合内，连接两点的线段必定在集合内。</p><h3 id="常见的凸集"><a class="markdownIt-Anchor" href="#常见的凸集"></a> 常见的凸集</h3><ul><li><p>所有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.68889em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span>,给定任意<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x,y \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span>,则有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mi>x</mi><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo><mi>y</mi><mo>∈</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\theta x+(1-\theta)y \in \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span></p></li><li><p>所有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="double-struck">R</mi><mo>+</mo><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{R}^n_+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.994221em;vertical-align:-0.305331em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"></span></span></span></span></span></span></span></span></p></li><li><p>超平面(Hyperplane)：既是仿射又是凸 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><mo>{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msup><mi>a</mi><mi>T</mi></msup><mi>x</mi><mo>=</mo><mi>b</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">C=\{x|a^Tx=b\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord mathit">x</span><span class="mord">∣</span><span class="mord"><span class="mord mathit">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">b</span><span class="mclose">}</span></span></span></span></p></li><li><p>半空间(Halfspace)：只是凸</p></li><li><p>向量范数</p><p>2-norm：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mn>2</mn></msub><mo>=</mo><msqrt><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>i</mi></msub><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow></msqrt><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi></mrow><annotation encoding="application/x-tex">||X||_2=\sqrt{\sum^n\limits_{i=1}|X_i|^2}=X^T X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.771864em;"></span><span class="strut bottom" style="height:3.04em;vertical-align:-1.268136em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.771864em;"><span class="svg-align" style="top:-5em;"><span class="pstrut" style="height:5em;"></span><span class="mord" style="padding-left:1em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.731864em;"><span class="pstrut" style="height:5em;"></span><span class="hide-tail" style="min-width:1.02em;height:3.08em;"><svg width="400em" height="3.08em" viewbox="0 0 400000 3240" preserveaspectratio="xMinYMin slice"><path d="M473,2793c339.3,-1799.3,509.3,-2700,510,-2702c3.3,-7.3,9.3,-11,18,-11H400000v40H1017.7s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,606zM1001 80H400000v40H1017z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.268136em;"></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span></p><p>1-norm：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mn>1</mn></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">||X||_1= \sum\limits^n_{i=1}|X_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord">∣</span></span></span></span></p><p>\infin-norm：||X||_\infin = \max\limits_{i=1,...,n}|X_i|</p><p>​</p><p>上面的向量范数可以统一成下面的形式：</p><p>p-norm,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p\ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">p</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span>：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mi>P</mi></msub><mo>=</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>i</mi></msub><msup><mi mathvariant="normal">∣</mi><mi>p</mi></msup><msup><mo>)</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>p</mi></mrow></mfrac></msup></mrow><annotation encoding="application/x-tex">||X||_P=(\sum\limits^n_{i=1}|X_i|^p)^{\frac{1}{p}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0367899999999999em;"><span style="top:-3.44577em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span></span></span></span><span style="top:-3.1275em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy mtight" style="height:0.245em;"><svg width="400em" height="0.245em" viewbox="0 0 400000 200" preserveaspectratio="xMinYMin slice"><path d="M0 80H400000 v40H0z M0 80H400000 v40H0z"/></svg></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.48288571428571425em;"></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>当p趋于无穷时就是无穷范数。</p><p>​</p><p>​</p></li></ul><p>​        欧几里德范数要满足三条性质：</p><p>​-  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">||X||\ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></p><p>​- 齐次性： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>α</mi><mi>X</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>=</mo><mi mathvariant="normal">∣</mi><mi>α</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">||\alpha X||=|\alpha| ||X||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord">∣</span></span></span></span></p><p>​- 三角不等式：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>+</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>Y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">||X+Y|| \le ||X||+||Y||</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord">∣</span></span></span></span></p><pre><code>近似范数，如$||X||_0$计算非0元的个数，实际上不是真正的范数。</code></pre><ul><li>范数球</li></ul><h3 id="凸集的性质"><a class="markdownIt-Anchor" href="#凸集的性质"></a> 凸集的性质</h3><p>凸集的交集是凸集，凸集的并集不一定是凸集。</p><h3 id="凸函数"><a class="markdownIt-Anchor" href="#凸函数"></a> 凸函数</h3><p>凸函数局部最优就是全局最优</p><p>一个函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup><mo>↦</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">f:\mathbb{R}^n \mapsto \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span>被称为凸集，如果</p><p>1.dom(f)(f的定义域)是凸集</p><p>2.对于任何<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>∈</mo><mi>d</mi><mi>o</mi><mi>m</mi><mo>(</mo><mi>f</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">x,y \in dom(f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>≤</mo><mi>θ</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0\le\theta\le1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base"><span class="mord">0</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span></span></span></span>,有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>θ</mi><mi>x</mi><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo><mi>y</mi><mo>)</mo><mo>≤</mo><mi>θ</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>θ</mi><mo>)</mo><mi>f</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(\theta x+(1-\theta )y) \le \theta f(x)+(1-\theta)f(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></p><h3 id="凸函数的一阶二阶条件"><a class="markdownIt-Anchor" href="#凸函数的一阶二阶条件"></a> 凸函数的一阶二阶条件</h3><p>一阶充要条件（不好用）：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>)</mo><mo>≥</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msup><mi mathvariant="normal">∇</mi><mi>T</mi></msup><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x_1)\ge f(x)+\nabla^Tf(x)(x-x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mclose">)</span></span></span></span>对于所有x_1、x均成立。</p><p>二阶充要条件：如果f二阶可导，则凸函数充要条件：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H(x)\ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>,即海森矩阵半正定。</p><h3 id="保凸运算"><a class="markdownIt-Anchor" href="#保凸运算"></a> 保凸运算</h3><ul><li>非负加权求和</li></ul><p>如果函数f是凸函数且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>,则函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">\alpha f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span>也为凸函数。如果函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>都是凸函数，则它们的和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_1+f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>也是凸函数。将非负伸缩以及求和运算结合起来，可以看出，凸函数的集合本身是一个凸锥：凸函数的非负加权求和仍是凸函数，即函数</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>f</mi><mn>1</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>w</mi><mi>m</mi></msub><msub><mi>f</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">f=w_1 f_1 + ... + w_mf_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span></span></p><p>是凸函数。类似地，凹函数的非负加权和仍是凹函数。</p><ul><li><p>复合仿射映射</p><p>假设函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup><mo>↦</mo><mrow><mi mathvariant="double-struck">R</mi></mrow><mo separator="true">,</mo><mi>A</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">f:\mathbb{R}^n \mapsto \mathbb{R}, A \in \mathbb{R}^{n \times m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.771331em;"></span><span class="strut bottom" style="height:0.9657709999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">A</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span><span class="mbin mtight">×</span><span class="mord mathit mtight">m</span></span></span></span></span></span></span></span></span></span></span></span>,以及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">b \in \mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="base"><span class="mord mathit">b</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span></span></span>,定义<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>:</mo><msup><mi mathvariant="double-struck">R</mi><mi>m</mi></msup><mo>↦</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">g:\mathbb{R}^m \mapsto \mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68889em;"></span><span class="strut bottom" style="height:0.88333em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span>为</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>f</mi><mo>(</mo><mi>A</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(x)=f(Ax+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">A</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>o</mi><mi>m</mi><mi>g</mi><mo>=</mo><mo>{</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo>∈</mo><mi>d</mi><mi>o</mi><mi>m</mi><mi>f</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">dom g = \{x|Ax+b \in dom f\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mopen">{</span><span class="mord mathit">x</span><span class="mord">∣</span><span class="mord mathit">A</span><span class="mord mathit">x</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">b</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">}</span></span></span></span>.若函数是凸函数，则函数g是凸函数；如果函数f是凹函数，那么函数g是凹函数。</p></li><li><p>逐点最大和逐点上确界</p><p>如果函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">f_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>均为凸函数，则二者的逐点最大函数f</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><msub><mi>f</mi><mn>1</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo separator="true">,</mo><msub><mi>f</mi><mn>2</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">f(x) = max{f_1(x), f_2(x)},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span><span class="mpunct">,</span></span></span></span></span></p><p>其定义域为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>o</mi><mi>m</mi><mi>f</mi><mo>=</mo><mi>d</mi><mi>o</mi><mi>m</mi><msub><mi>f</mi><mn>1</mn></msub><mo>∩</mo><mi>d</mi><mi>o</mi><mi>m</mi><msub><mi>f</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">dom f = dom f_1 \cap dom f_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">d</span><span class="mord mathit">o</span><span class="mord mathit">m</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>,仍然是凸函数。</p><p>​</p><p>逐点最大的性质可以扩展至无限个凸函数的逐点上确界。如果对于任意<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">y \in A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">A</span></span></span></span>,函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>关于x都是凸的，则函数g</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><munder><mi>sup</mi><mo>⁡</mo><mrow><mi>y</mi><mo>∈</mo><mi>A</mi></mrow></munder><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(x) = \sup\limits_{y \in A} f(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.8248790000000001em;vertical-align:-1.0748790000000001em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999983em;"><span style="top:-1.861229em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span><span class="mrel mtight">∈</span><span class="mord mathit mtight">A</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">sup</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0748790000000001em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span></p><p>关于x也是凸的。此时，函数g的定义域为</p>dom g =\{x|(x, y) \in dom f \forall y \in A, \sup\limits_{y \in A}f(x, y)<\infin\}. <p="">类似地，一系列凹函数的逐点下确界仍是凹函数。<p></p></\infin\}.></li></ul><h2 id="凸优化问题"><a class="markdownIt-Anchor" href="#凸优化问题"></a> 凸优化问题</h2><p>在一个凸集上极小化一个凸的目标函数，凸优化问题局部最优等于全局最优。</p><p>标准形式</p>\begin{align*}&minimize f_0(x)\\&subject\quad to\quad f_i(x)\le 0\quad for \quad i=1,2, ... ,m\\&\qquad\qquad\qquad h_i(x)=0\quad for \quad i=1,2,...,p\end{align*}<p>则有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f_0(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>是凸函数，可行域是凸集。</p><p>目标函数是凸的</p><p>不等式约束必须是凸的</p><p>等式约束函数必须是仿射的</p><p>最优值（目标函数在可行域上最小值）</p><h3 id="典型的凸优化问题"><a class="markdownIt-Anchor" href="#典型的凸优化问题"></a> 典型的凸优化问题</h3><ul><li><p>线性规划问题</p>\begin{align*}&minimize C^TX+d\\&subject\quad to\quad GX\le h \\&\qquad\qquad\qquad AX=b\end{align*}<p>​</p></li><li><p>二次规划（P半正定）QP问题</p>\begin{align*}&minimize \frac{1}{2}X^TPX+C^TX+d\\&subject\quad to\quad GX\le h \\&\qquad\qquad\qquad AX=b\end{align*}<p>​</p></li><li><p>QCQP（P和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Q_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span></span></span></span>均正定）</p>\begin{align*}&minimize \frac{1}{2}X^TPX+C^TX+d\\&subject\quad to\quad  \frac{1}{2}X^TQ_iX+r_i^TX+S_i\le0,\quad i=1,...,m, \quad AX=d \\&\qquad\qquad\qquad AX=b\end{align*}<p>​</p></li></ul><h1 id="对偶"><a class="markdownIt-Anchor" href="#对偶"></a> 对偶</h1><p>一般优化问题</p>\begin{align*}&minimize f_0(x)\\&subject\quad to\quad f_i(x)\le 0\quad for \quad i=1,2, ... ,m\\&\qquad\qquad\qquad h_i(x)=0\quad for \quad i=1,2,...,p\end{align*}<h2 id="lagrangian"><a class="markdownIt-Anchor" href="#lagrangian"></a> Lagrangian</h2><p>合并目标函数和约束</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(x, \lambda,v)=f_0(x)+\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6985050000000004em;"></span><span class="strut bottom" style="height:2.9761740000000003em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p><p>主变量：x</p><p>对偶变量：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">\lambda\ge0,v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">λ</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></p><p>主问题</p><p>Lagrangian</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>v</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(x, \lambda, v)=f_0(x)+\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_i(x)h_i(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6985050000000004em;"></span><span class="strut bottom" style="height:2.9761740000000003em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>p</mi><mo>∗</mo></msup><mo>=</mo><munder><mi>min</mi><mo>⁡</mo><mi>x</mi></munder><mo>(</mo><munder><mi>max</mi><mo>⁡</mo><mrow><mi>λ</mi><mo separator="true">,</mo><mi>v</mi></mrow></munder><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">p^*=\min\limits_x(\max\limits_{\lambda,v}L(x,\lambda,v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.638216em;vertical-align:-0.8882159999999999em;"></span><span class="base"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.1em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.0478920000000005em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>最大最小在一起很麻烦，下面分开看，先看里面的max</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mi>max</mi><mo>⁡</mo><mrow><mi>λ</mi><mo separator="true">,</mo><mi>v</mi></mrow></munder><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munder><mi>max</mi><mo>⁡</mo><mrow><mi>λ</mi><mo separator="true">,</mo><mi>v</mi></mrow></munder><mo>(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\max\limits_{\lambda,v}L(x,\lambda,v)=f_0(x)+\max\limits_{\lambda,v}(\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6985050000000004em;"></span><span class="strut bottom" style="height:2.9761740000000003em;vertical-align:-1.277669em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.0478920000000005em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.0478920000000005em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em;"></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>因为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f_0(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>和\lambda、v没关系，所以单独分出来。</p><p>看后面出来<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>max</mi><mo>⁡</mo><mrow><mi>λ</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\max\limits_{\lambda,v}(\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.398505em;"></span><span class="strut bottom" style="height:2.376174em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.0478920000000005em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em;"></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.398505em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.997113em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>,要进行最大化，根据约束条件</p>f_i(x)\le 0\quad for \quad i=1,2, ... ,m\\h_i(x)=0\quad for \quad i=1,2,...,p<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h_i(x)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>,所以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^pv_ih_i(x)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.398505em;"></span><span class="strut bottom" style="height:2.376174em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.398505em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.997113em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f_i(x)\le0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_i\ge0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base"><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>,所以要取最大值<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^m\lambda_if_i(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>只能为0，所以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>max</mi><mo>⁡</mo><mrow><mi>λ</mi><mo separator="true">,</mo><mi>v</mi></mrow></msub><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\max\limits_{\lambda,v}L(x,\lambda,v)=f_0(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.638216em;vertical-align:-0.8882159999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.0478920000000005em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">λ</span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882159999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>，于是就是最小化<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f_0(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>，也就是对偶问题和主问题实际上是一样的。</p><p>主问题是minmax</p><h3 id="lagrrange函数对偶问题"><a class="markdownIt-Anchor" href="#lagrrange函数对偶问题"></a> Lagrrange函数对偶问题</h3><p>maxmin</p><p>先对x求最大值，再对\lambda、v求最小值</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>min</mi><mo>⁡</mo><mrow><mi>x</mi><mo>∈</mo><mi>D</mi></mrow></msub><mo>{</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">g(\lambda,v)=\min\limits_{x\in D}\{f_0(x)+\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.398505em;"></span><span class="strut bottom" style="height:2.376174em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.055669em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathit mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.771701em;"></span></span></span></span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.398505em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.997113em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f_0(x)+\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.398505em;"></span><span class="strut bottom" style="height:2.376174em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.398505em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.997113em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>可以写成<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msup><mi>λ</mi><mi>T</mi></msup><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><msup><mi>v</mi><mi>T</mi></msup><mi>h</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f_0(x)+\lambda^Tf(x)+v^Th(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>，是关于\lambda、v的仿射函数。</p><p><strong>于是g是这个仿射函数的逐点下确界，总是凹的，即使原问题非凸</strong>。</p><p>有个比较具体的证明过程：<a href="https://blog.csdn.net/u014540876/article/details/79153913" target="_blank" rel="noopener">https://blog.csdn.net/u014540876/article/details/79153913</a></p><p>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\widetilde{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.6905600000000001em;"></span><span class="strut bottom" style="height:0.6905600000000001em;vertical-align:0em;"></span><span class="base"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span></span></span></span>是一个可行点，则</p><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>min</mi><mo>⁡</mo><mrow><mi>x</mi><mo>∈</mo><mi>D</mi></mrow></msub><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>≤</mo><mi>L</mi><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo>)</mo><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo>)</mo><mo>)</mo><mo>≤</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">g(\lambda,v)=\min\limits_{x\in D}L(x,\lambda,v)\le L(\widetilde{x}, \lambda,v)=f_0(\widetilde{x})+\sum\limits_{i=1}^m\lambda_if_i(\widetilde{x})+\sum\limits_{i=1}^pv_ih_i(\widetilde{x}))\le f_0(\widetilde{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.398505em;"></span><span class="strut bottom" style="height:2.376174em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.055669em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathit mtight" style="margin-right:0.02778em;">D</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.771701em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.398505em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.997113em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>所以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>≤</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mover accent="true"><mrow><mi>x</mi></mrow><mo stretchy="true">~</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">g(\lambda,v)\le f_0(\widetilde{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6905600000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="svg-align" style="width:calc(100% - 0.05556em);margin-left:0.05556em;top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">x^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>也是可行点，即在\widetilde{x}中，所以有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>≤</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo>)</mo><mo>=</mo><msup><mi>p</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">g(\lambda,v)\le f_0(x^*)=p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></p><p>所以，对偶函数是原函数最优值的下界</p><p>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">d^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>(</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">g(\lambda,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span> 最大值，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup><mo>≤</mo><msup><mi>p</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">d^*\le p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></p><p>强弱对偶</p><p>弱对偶：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup><mo>≤</mo><msup><mi>p</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">d^*\le p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，无论凸或非凸问题，总成立。</p><p>强对偶：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup><mo>=</mo><msup><mi>p</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">d^*=p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>,该条件通常不成立，但对于凸优化问题通常成立。</p><p>凸优化问题可以写为：</p>minimize \quad f_0(x)\\subject\quad to \quad f_i(x)\le 0\quad ,for \quad i=1, 2,...,m<p>如果满足slater条件，即：存在内点x，使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>&lt;</mo><mn>0</mn><mspace width="1em"></mspace><mi>f</mi><mi>o</mi><mi>r</mi><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">f_i(x)&lt;0\quad for \quad i=1,2,...,m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mspace quad"></span><span class="mord mathit">i</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">m</span></span></span></span>均成立，则强对偶成立。</p><p>或者满足：</p>minimize \quad f_0(x)\\subject\quad to\quad Ax=b<p>强对偶依然成立。</p><p>一个凸优化不满足slater条件，强对偶不一定成立，因此slater条件是强对偶的充分条件。</p><h3 id="从对偶问题解主问题"><a class="markdownIt-Anchor" href="#从对偶问题解主问题"></a> 从对偶问题解主问题</h3><p>如果强对偶成立，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>λ</mi><mo>∗</mo></msup><mo separator="true">,</mo><msup><mi>v</mi><mo>∗</mo></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">(x^*,\lambda^*,v^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>是主问题的最优解，有</p>p^*=f_0(x^*)=d^*=g(\lambda^*,v^*)=\min\limits_x(f_0(x)+\sum\limits_{i=1}^m\lambda_i^*f_i(x)+\sum\limits_{i=1}^pv_i^*h_i(x))\\\le f_0(x^*)+\sum\limits_{i=1}^m\lambda_i^*f_i(x^*)+\sum\limits_{i=1}^mv_i^*h_i(x^*)\le f_0(x^*)<p>因为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo>)</mo><mo>=</mo><msup><mi>d</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">f_0(x^*)=d^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>，上式的小于等于号只能取等号，于是后面的两个求和都是0，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mi>v</mi><mi>i</mi><mo>∗</mo></msubsup><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^mv_i^*h_i(x^*)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span>一直成立，因此<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mi>λ</mi><mi>i</mi><mo>∗</mo></msubsup><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^m\lambda_i^*f_i(x^*)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></p><p>结论1：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mi>λ</mi><mi>i</mi><mo>∗</mo></msubsup><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msup><mi>x</mi><mo>∗</mo></msup><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum\limits_{i=1}^m\lambda_i^*f_i(x^*)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.3513970000000004em;"></span><span class="strut bottom" style="height:2.329066em;vertical-align:-0.9776689999999999em;"></span><span class="base"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3513970000000004em;"><span style="top:-2.122331em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0000050000000003em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9776689999999999em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></p><p>结论2：L(x,\lambda^*,v^*)关于x^*处取极小值，有\nabla_x L(x^*,\lambda^*,v^*)=0</p>g(\lambda^*,v^*)=L(x^*,\lambda^*,v^*)\\g(\lambda^*,v^*)=\min\limits_xL(X,\lambda^*,v^*)<h3 id="kkt条件"><a class="markdownIt-Anchor" href="#kkt条件"></a> KKT条件</h3><p>凸优化问题</p>\begin{align*}&minimize \quad f_0(x)\\&subject\quad to\quad f_i(x)\le0,\quad for\quad i=1,2,...,m\\&\qquad\qquad\qquad h_i(x)=0\quad for\quad i=1,2,...,m\end{align*}<p>Lagrangian</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>λ</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo><mo>=</mo><msub><mi>f</mi><mn>0</mn></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>λ</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>i</mi></msub><mo>(</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">L(x,\lambda ,v)=f_0(x)+\sum\limits_{i=1}^m\lambda_if_i(x)+\sum\limits_{i=1}^pv_ih_i(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6985050000000004em;"></span><span class="strut bottom" style="height:2.9761740000000003em;vertical-align:-1.277669em;"></span><span class="base"><span class="mord mathit">L</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">λ</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mord rule" style="margin-right:0.2222222222222222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985050000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"></span></span></span></span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></span></p><p>凸优化问题强对偶成立，充要条件：</p>\begin{align*}&f_i(x^*)\le0,\quad i=1,2,...,m\\&h_i(x^*)=0,\quad i=1,2,...,p\\&\lambda^*\ge0,\quad i=1,2,...,m\\&\lambda^*_if_i(x^*)=0,\quad i=1,2,...,m\\&\nabla f_0(x^*)+\sum\lambda_i \nabla f_i(x^*)+\sum v_ih_i(x^*)=0&\end{align*}<p>最后这个条件又上面结论2的梯度为0得到。</p>\lambda_i和f_i(x)不会同时为0，当f_i(x)<0时，\lambda_i=0，这个不等式没有被激活，当f_i(x)=0时，\\\lambda_i>0,此时不等式约束被激活。<p>KKT条件在凸优化强对偶成立时解出来的解是全局最优解，在非凸问题弱对偶时，KKT只是局部极小解的一阶必要条件。</p></0时，\lambda_i=0，这个不等式没有被激活，当f_i(x)=0时，\\\lambda_i>]]></content>
    
    <summary type="html">
    
      秃是不好的，但凸是极好的。
    
    </summary>
    
    
      <category term="机器学习" scheme="http://yoursite.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>linux安装xgboost、</title>
    <link href="http://yoursite.com/post/ed550a7c.html"/>
    <id>http://yoursite.com/post/ed550a7c.html</id>
    <published>2018-06-21T12:00:48.000Z</published>
    <updated>2018-07-23T05:02:20.272Z</updated>
    
    <content type="html"><![CDATA[<p>1、先安装git</p><p>ubuntu:   apt-get install git</p><p>centos:    yum install git</p><p>2、下载xgboost仓库，注意有–recursive(有子模块哦）</p><p>git clone --recursive <a href="https://github.com/dmlc/xgboost.git" target="_blank" rel="noopener">https://github.com/dmlc/xgboost.git</a><br>cd xgboost<br>./build.sh<br>cd python-package<br>python <a href="http://setup.py" target="_blank" rel="noopener">setup.py</a> install</p><p>3、测试</p><p>python</p><p>import xgboost</p><p>如果服务器太慢，可以本地下载，再上传到服务器</p><p>运行 bash ./build.sh出现“SYNTAX ERROR:UNEXPECTED END OF FILE”错误</p><p>原因是</p><p>dos文件传输到unix系统时,会在每行的结尾多一个^M,在vim的时候,当你用如下命令查看：cat -A SCRIPT<br>示例：<br>[root@localhost~]#cat -A <a href="http://installhttp.sh" target="_blank" rel="noopener">installhttp.sh</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#！/bin/bash^M$</span><br><span class="line">#The script is autoinstallhttp.sh^M$</span><br><span class="line">#Author Joah^M$</span><br><span class="line">#Version 1.0.0^M$</span><br><span class="line">version=`grep -o &quot; [0-9]\&gt;&quot; /etc/centos-release`^M$</span><br><span class="line">if [ $version -eq 7 ];do^M$</span><br><span class="line">echo &quot;We will install newversion.Please wait!&quot;^M$</span><br></pre></td></tr></table></figure><p>2、解决方法<br>使用命令dos2unix命令将SCRIPT脚本格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost~]#dos2unix installhttp.sh </span><br><span class="line">dos2unix: converting file installhttp.sh to UNIX format ...</span><br><span class="line">123</span><br></pre></td></tr></table></figure><p>或者：<br>[root@localhost/app]#vim <a href="http://installhttp.sh" target="_blank" rel="noopener">installhttp.sh</a><br>:set fileformat=unix<br>:wq</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;1、先安装git&lt;/p&gt;
&lt;p&gt;ubuntu:   apt-get install git&lt;/p&gt;
&lt;p&gt;centos:    yum install git&lt;/p&gt;
&lt;p&gt;2、下载xgboost仓库，注意有–recursive(有子模块哦）&lt;/p&gt;
&lt;p&gt;git clon
      
    
    </summary>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>centos下python3.6安装</title>
    <link href="http://yoursite.com/post/2980a69f.html"/>
    <id>http://yoursite.com/post/2980a69f.html</id>
    <published>2018-06-21T09:47:12.000Z</published>
    <updated>2018-07-23T05:02:20.263Z</updated>
    
    <content type="html"><![CDATA[<p><strong>安装python3.6可能使用的依赖</strong></p><p># yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel</p><p><strong>下载python3.6编译安装</strong></p><p>到python官网下载<a href="https://www.python.org/" target="_blank" rel="noopener">https://www.python.org</a></p><p>下载最新版源码，使用make altinstall，如果使用make install，在系统中将会有两个不同版本的Python在/usr/bin/目录中。这将会导致很多问题，而且不好处理。</p><p># wgethttps://www.python.org/ftp/python/3.6.0/Python-3.6.0.tgz</p><p># tar -xzvf Python-3.6.0.tgz -C  /tmp</p><p># cd  /tmp/Python-3.6.0/</p><p>把Python3.6安装到 /usr/local 目录</p><p># ./configure --prefix=<strong>/usr/local</strong></p><p># make</p><p># make altinstall</p><p>解决问题：</p><p>zipimport.ZipImportError: can’t decompress data; zlib not available</p><p>yum -y install zlib*</p><p>用pip安装　提示找不到ssl模块</p><p>在./configure过程中，如果没有加上–with-ssl参数时，默认安装的软件涉及到ssl的功能不可用，刚好pip3过程需要ssl模块，而由于没有指定，所以该功能不可用。</p><p>解决办法是重新对python3.6进行编译安装，用一下过程来实现编译安装:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd Python-3.6.2</span><br><span class="line">./configure --with-ssl</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>pip3.6 install virtualenv</p><p>进入想创建虚拟环境的目录</p><p>virtualenv ai ai是我们给虚拟环境起的名字</p><p>进入ai</p><p>进入ai的bin</p><p>source ./activate 进入虚拟环境</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;安装python3.6可能使用的依赖&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;# yum install openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel&lt;/p&gt;
      
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>docker基础</title>
    <link href="http://yoursite.com/post/5ae6092.html"/>
    <id>http://yoursite.com/post/5ae6092.html</id>
    <published>2018-06-21T09:07:32.000Z</published>
    <updated>2018-07-23T05:02:20.265Z</updated>
    
    <content type="html"><![CDATA[<p>在centos7下安装docker</p><p><code>yum -y install docker</code></p><p>启动和停止docker服务</p><p><code>systemctl start docker</code></p><p><code>systemctl stop docker</code></p><p>搜索镜像，如搜索与python相关的镜像</p><p><code>docker search python</code></p><p>想把镜像下载下来</p><p><code>docker pull 镜像名字</code></p><p>查看本地的镜像</p><p><code>docker images</code></p><p>创建容器 tid 创建并运行一个容器，但不进入 依据选定的镜像创建</p><p><code>docker run -tid 镜像id（前四位即可）</code></p><p>查看容器</p><p><code>docker ps -a 所有的容器</code></p><p>进入容器</p><p><code>docker attach 容器id</code></p><p>不停止退出</p><p><code>ctrl+p+q</code></p><p>给容器起一个名字 根据某个名称的镜像创建某个名称的容器</p><p><code>docker run -tid --name 容器名 镜像名</code></p><p>启动停止的容器</p><p><code>docker start 容器id</code></p><p>封装镜像</p><p><code>docker commit 容器id 镜像名字:版本号</code></p><p>从容器里面拷文件到宿主机</p><p>在宿主机里面执行以下命令<code>docker cp 容器名：要拷贝的文件在容器里面的路径 要拷贝到宿主机的相应路径</code></p><p>从宿主机拷文件到容器里面</p><p>在宿主机里面执行如下命令<code>docker cp 要拷贝的文件路径 容器名：要拷贝到容器里面对应的路径</code></p><p>通过docker save命令，将镜像保存为tar文件</p><p><code>docker save -o /root/google-cadvisor.tar google/cadvisor</code></p><p>通过docker load命令将tar文件加载进来</p><p><code>docker load -i /root/google-cadvisor.tar</code></p><p><code>docker images</code></p><p>无关随记</p><p>make是gcc的编译器，VPS买来必定要安装</p><p>安装：</p><p><code>yum -y install gcc automake autoconf libtool make</code></p><p>安装g++:</p><p><code>yum install gcc gcc-c++</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在centos7下安装docker&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yum -y install docker&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;启动和停止docker服务&lt;/p&gt;
&lt;p&gt;&lt;code&gt;systemctl start docker&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;
      
    
    </summary>
    
    
      <category term="docker" scheme="http://yoursite.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>python中常见的内置函数</title>
    <link href="http://yoursite.com/post/963825dc.html"/>
    <id>http://yoursite.com/post/963825dc.html</id>
    <published>2018-05-24T02:28:11.000Z</published>
    <updated>2018-07-23T05:02:20.280Z</updated>
    
    <content type="html"><![CDATA[<h6 id="python-enumerate用法总结"><a class="markdownIt-Anchor" href="#python-enumerate用法总结"></a> python enumerate用法总结</h6><h2 id="enumerate说明"><a class="markdownIt-Anchor" href="#enumerate说明"></a> enumerate()说明</h2><ul><li><p>enumerate()是python的内置函数</p></li><li><p>enumerate在字典上是枚举、列举的意思</p></li><li><p>对于一个可迭代的（iterable）/可遍历的对象（如列表、字符串），enumerate将其组成一个索引序列，利用它可以同时获得索引和值</p></li><li><p>enumerate多用于在for循环中得到计数</p></li><li><p>例如对于一个seq，得到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(0, seq[0]), (1, seq[1]), (2, seq[2])1</span><br></pre></td></tr></table></figure></li><li><p>enumerate()返回的是一个enumerate对象，例如：<br><img src="https://img-blog.csdn.net/20160612190332206" alt="这里写图片描述"></p></li></ul><hr><h2 id="enumerate使用"><a class="markdownIt-Anchor" href="#enumerate使用"></a> enumerate()使用</h2><ul><li>如果对一个列表，既要遍历索引又要遍历元素时，首先可以这样写：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&quot;这&quot;, &quot;是&quot;, &quot;一个&quot;, &quot;测试&quot;]</span><br><span class="line">for i in range (len(list1)):</span><br><span class="line">    print i ,list1[i]123</span><br></pre></td></tr></table></figure><ul><li>上述方法有些累赘，利用enumerate()会更加直接和优美：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&quot;这&quot;, &quot;是&quot;, &quot;一个&quot;, &quot;测试&quot;]</span><br><span class="line">for index, item in enumerate(list1):</span><br><span class="line">    print index, item</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">0 这</span><br><span class="line">1 是</span><br><span class="line">2 一个</span><br><span class="line">3 测试12345678</span><br></pre></td></tr></table></figure><ul><li>enumerate还可以接收第二个参数，用于指定索引起始值，如：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list1 = [&quot;这&quot;, &quot;是&quot;, &quot;一个&quot;, &quot;测试&quot;]</span><br><span class="line">for index, item in enumerate(list1, 1):</span><br><span class="line">    print index, item</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">1 这</span><br><span class="line">2 是</span><br><span class="line">3 一个</span><br><span class="line">4 测试12345678</span><br></pre></td></tr></table></figure><hr><h2 id="补充"><a class="markdownIt-Anchor" href="#补充"></a> 补充</h2><p>如果要统计文件的行数，可以这样写：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">count = len(open(filepath, &apos;r&apos;).readlines())1</span><br></pre></td></tr></table></figure><p>这种方法简单，但是可能比较慢，当<strong>文件比较大</strong>时甚至不能工作。</p><p>可以利用enumerate()：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">count = 0</span><br><span class="line">for index, line in enumerate(open(filepath,&apos;r&apos;))： </span><br><span class="line">    count += 1</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h6 id=&quot;python-enumerate用法总结&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#python-enumerate用法总结&quot;&gt;&lt;/a&gt; python enumerate用法总结&lt;/h6&gt;
&lt;h2 id=&quot;enumerate说明&quot;&gt;
      
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>python中的@property、@classmethod和@staticmethod</title>
    <link href="http://yoursite.com/post/f1b59888.html"/>
    <id>http://yoursite.com/post/f1b59888.html</id>
    <published>2018-05-23T03:57:09.000Z</published>
    <updated>2018-07-23T05:02:20.283Z</updated>
    
    <content type="html"><![CDATA[<h1 id="property"><a class="markdownIt-Anchor" href="#property"></a> @property</h1><p>@property使我们可以直接像调用属性一样调用方法，并且能都进行检查，而不必另设置getter、setter方法，像下面都名为score就好了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def score(self):</span><br><span class="line">        return self._score</span><br><span class="line"></span><br><span class="line">    @score.setter</span><br><span class="line">    def score(self, value):</span><br><span class="line">        if not isinstance(value, int):</span><br><span class="line">            raise ValueError(&apos;score must be an integer!&apos;)</span><br><span class="line">        if value &lt; 0 or value &gt; 100:</span><br><span class="line">            raise ValueError(&apos;score must between 0 ~ 100!&apos;)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure><p><code>@property</code>的实现比较复杂，我们先考察如何使用。把一个getter方法变成属性，只需要加上<code>@property</code>就可以了，此时，<code>@property</code>本身又创建了另一个装饰器<code>@score.setter</code>，负责把一个setter方法变成属性赋值，于是，我们就拥有一个可控的属性操作：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; s = Student()</span><br><span class="line">&gt;&gt;&gt; s.score = 60 # OK，实际转化为s.set_score(60)</span><br><span class="line">&gt;&gt;&gt; s.score # OK，实际转化为s.get_score()</span><br><span class="line">60</span><br><span class="line">&gt;&gt;&gt; s.score = 9999</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  ...</span><br><span class="line">ValueError: score must between 0 ~ 100!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def birth(self):</span><br><span class="line">        return self._birth</span><br><span class="line"></span><br><span class="line">    @birth.setter</span><br><span class="line">    def birth(self, value):</span><br><span class="line">        self._birth = value</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    def age(self):</span><br><span class="line">        return 2015 - self._birth</span><br></pre></td></tr></table></figure><p>上面的<code>birth</code>是可读写属性，而<code>age</code>就是一个<em>只读</em>属性，因为<code>age</code>可以根据<code>birth</code>和当前时间计算出来。</p><p><code>@property</code>广泛应用在类的定义中，可以让调用者写出简短的代码，同时保证对参数进行必要的检查，这样，程序运行时就减少了出错的可能性。</p><h1 id="classmethod和classmethod"><a class="markdownIt-Anchor" href="#classmethod和classmethod"></a> @classmethod和@classmethod</h1><p>Python其实有3个方法,即静态方法(staticmethod),类方法(classmethod)和实例方法,如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def foo(x):</span><br><span class="line">    print &quot;executing foo(%s)&quot;%(x)</span><br><span class="line"></span><br><span class="line">class A(object):</span><br><span class="line">    def foo(self,x):</span><br><span class="line">        print &quot;executing foo(%s,%s)&quot;%(self,x)</span><br><span class="line"></span><br><span class="line">    @classmethod</span><br><span class="line">    def class_foo(cls,x):</span><br><span class="line">        print &quot;executing class_foo(%s,%s)&quot;%(cls,x)</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def static_foo(x):</span><br><span class="line">        print &quot;executing static_foo(%s)&quot;%x</span><br><span class="line"></span><br><span class="line">a=A()</span><br></pre></td></tr></table></figure><p>这里先理解下函数参数里面的self和cls.这个self和cls是对类或者实例的绑定,对于一般的函数来说我们可以这么调用<code>foo(x)</code>,这个函数就是最常用的,它的工作跟任何东西(类,实例)无关.对于实例方法,我们知道在类里每次定义方法的时候都需要绑定这个实例,就是<code>foo(self, x)</code>,为什么要这么做呢?因为实例方法的调用离不开实例,我们需要把实例自己传给函数,调用的时候是这样的<code>a.foo(x)</code>(其实是<code>foo(a, x)</code>).类方法一样,只不过它传递的是类而不是实例,<code>A.class_foo(x)</code>.注意这里的self和cls可以替换别的参数,但是python的约定是这俩,还是不要改的好.</p><p>对于静态方法其实和普通的方法一样,不需要对谁进行绑定,唯一的区别是调用的时候需要使用<code>a.static_foo(x)</code>或者<code>A.static_foo(x)</code>来调用.</p><table><thead><tr><th>\</th><th>实例方法</th><th>类方法</th><th>静态方法</th></tr></thead><tbody><tr><td>a = A()</td><td>a.foo(x)</td><td>a.class_foo(x)</td><td>a.static_foo(x)</td></tr><tr><td>A</td><td>不可用</td><td>A.class_foo(x)</td><td>A.static_foo(x)</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">class A(object):</span><br><span class="line">    def foo(self, x):</span><br><span class="line">        print(&quot;executing foo(%s,%s)&quot; % (self, x))</span><br><span class="line">        print(&apos;self:&apos;, self)</span><br><span class="line">    @classmethod</span><br><span class="line">    def class_foo(cls, x):</span><br><span class="line">        print(&quot;executing class_foo(%s,%s)&quot; % (cls, x))</span><br><span class="line">        print(&apos;cls:&apos;, cls)</span><br><span class="line">    @staticmethod</span><br><span class="line">    def static_foo(x):</span><br><span class="line">        print(&quot;executing static_foo(%s)&quot; % x)  </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">A.static_foo(&apos;h&apos;)</span><br><span class="line">executing static_foo(h)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A.class_foo(&apos;h&apos;)</span><br><span class="line">executing class_foo(&lt;class &apos;__main__.A&apos;&gt;,h)</span><br><span class="line">cls: &lt;class &apos;__main__.A&apos;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A.foo(&apos;h&apos;)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-46-901d70beca99&gt; in &lt;module&gt;()</span><br><span class="line">----&gt; 1 A.foo(&apos;h&apos;)</span><br><span class="line"></span><br><span class="line">TypeError: foo() missing 1 required positional argument: &apos;x&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">a.foo(&apos;h&apos;)</span><br><span class="line">executing foo(&lt;__main__.A object at 0x0000000009A5FE48&gt;,h)</span><br><span class="line">self: &lt;__main__.A object at 0x0000000009A5FE48&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@classmethod和@classmethod二者是为类量身定制的，但是实例非要使用，也不会报错。</span><br><span class="line">a.static_foo(&apos;h&apos;)</span><br><span class="line">executing static_foo(h)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a.class_foo(&apos;h&apos;)</span><br><span class="line">executing class_foo(&lt;class &apos;__main__.A&apos;&gt;,h)</span><br><span class="line">cls: &lt;class &apos;__main__.A&apos;&gt;</span><br></pre></td></tr></table></figure><p>应用场景:编写类时需要采用很多不同的方式来创建实例，而我们只有一个__init__函数，此时静态方法就派上用场了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class Date:</span><br><span class="line">    def __init__(self,year,month,day):</span><br><span class="line">        self.year=year</span><br><span class="line">        self.month=month</span><br><span class="line">        self.day=day</span><br><span class="line">    @staticmethod</span><br><span class="line">    def now(): #用Date.now()的形式去产生实例,该实例用的是当前时间</span><br><span class="line">        t=time.localtime() #获取结构化的时间格式</span><br><span class="line">        return Date(t.tm_year,t.tm_mon,t.tm_mday) #新建实例并且返回</span><br><span class="line">    @staticmethod</span><br><span class="line">    def tomorrow():#用Date.tomorrow()的形式去产生实例,该实例用的是明天的时间</span><br><span class="line">        t=time.localtime(time.time()+86400)</span><br><span class="line">        return Date(t.tm_year,t.tm_mon,t.tm_mday)</span><br><span class="line"></span><br><span class="line">a=Date(&apos;1987&apos;,11,27) #自己定义时间</span><br><span class="line">b=Date.now() #采用当前时间</span><br><span class="line">c=Date.tomorrow() #采用明天的时间</span><br><span class="line"></span><br><span class="line">print(a.year,a.month,a.day)</span><br><span class="line">print(b.year,b.month,b.day)</span><br><span class="line">print(c.year,c.month,c.day)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;property&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#property&quot;&gt;&lt;/a&gt; @property&lt;/h1&gt;
&lt;p&gt;@property使我们可以直接像调用属性一样调用方法，并且能都进行检查，而不必另设置getter、set
      
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>python中的*args、**kwargs</title>
    <link href="http://yoursite.com/post/ab9e77b5.html"/>
    <id>http://yoursite.com/post/ab9e77b5.html</id>
    <published>2018-05-20T05:05:38.000Z</published>
    <updated>2018-07-23T05:02:20.282Z</updated>
    
    <content type="html"><![CDATA[<p>在python中，函数参数的工作方式很简单，当编写func(a, b, c, d=some, e=value)时，位置和关键字参数其实分别是被打包成元组和字典的。</p><p>函数其实接受的是一个元组args和一个字典kwargs，并在内部完成如下转换：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a, b, c = args</span><br><span class="line"></span><br><span class="line">d = kwargs.get(&apos;d&apos;: d_default_value)</span><br><span class="line"></span><br><span class="line">e = kwargs.get(&apos;e&apos;: e_default_value)</span><br></pre></td></tr></table></figure><blockquote><p>dict.get(key, default=None)<br>key – 字典中要查找的键。<br>default – 如果指定键的值不存在时，返回该默认值值。</p><p>Python 字典(Dictionary) get() 函数返回指定键的值，如果值不在字典中返回默认值。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;#!/usr/bin/python</span><br><span class="line">&gt;</span><br><span class="line">&gt;dict = &#123;&apos;Name&apos;: &apos;Zara&apos;, &apos;Age&apos;: 27&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt;print &quot;Value : %s&quot; %  dict.get(&apos;Age&apos;)</span><br><span class="line">&gt;print &quot;Value : %s&quot; %  dict.get(&apos;Sex&apos;, &quot;Never&quot;)</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt;Value : 27</span><br><span class="line">&gt;Value : Never</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>这一切都是在幕后悄悄发生的。当然，它还会执行一些错误检查，还允许你将位置参数当成关键字参数那样进行指定(即使它们在函数定义中并不是关键字参数)。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def say_hello_then_call_f(f, *args, **kwargs):</span><br><span class="line"></span><br><span class="line">    print(&apos;args is&apos;, args)</span><br><span class="line"></span><br><span class="line">    print(&apos;kwargs is&apos;, kwargs)</span><br><span class="line"></span><br><span class="line">    print(&apos;Hello!Now I am going to call %s&apos; % f)</span><br><span class="line"></span><br><span class="line">    return f(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">def g(x, y, z=1):</span><br><span class="line"></span><br><span class="line">    return (x+y) / z</span><br><span class="line"></span><br><span class="line">say_hello_then_call_f(g, 1, 2, z=5.)</span><br></pre></td></tr></table></figure><p>结果是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">args is (1, 2)</span><br><span class="line">kwargs is &#123;&apos;z&apos;: 5.0&#125;</span><br><span class="line">Hello!Now I am going to call &lt;function g at 0x7f00404e0510&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Out[2]: 0.6</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在python中，函数参数的工作方式很简单，当编写func(a, b, c, d=some, e=value)时，位置和关键字参数其实分别是被打包成元组和字典的。&lt;/p&gt;
&lt;p&gt;函数其实接受的是一个元组args和一个字典kwargs，并在内部完成如下转换：&lt;/p&gt;
&lt;fig
      
    
    </summary>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>特征工程</title>
    <link href="http://yoursite.com/post/8ae97bf8.html"/>
    <id>http://yoursite.com/post/8ae97bf8.html</id>
    <published>2018-05-15T12:45:08.000Z</published>
    <updated>2018-07-23T05:02:20.303Z</updated>
    
    <content type="html"><![CDATA[<h1 id="特征工程概览"><a class="markdownIt-Anchor" href="#特征工程概览"></a> 特征工程概览</h1><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1frc6fow71cj20kq0k8ae9.jpg" alt=""></p><h1 id="数据探索"><a class="markdownIt-Anchor" href="#数据探索"></a> 数据探索</h1><p>数据探索有助于选择合适的数据预处理和建模方法。</p><ul><li>数据质量分析<ul><li>缺失值</li><li>异常值</li></ul></li><li>特征分布特征分析<ul><li>统计量</li><li>直方图</li></ul></li><li>特征之间的相关性</li></ul><h2 id="缺失值分析"><a class="markdownIt-Anchor" href="#缺失值分析"></a> 缺失值分析</h2><p>统计缺失样本数目及缺失率</p><p>缺失值处理</p><ul><li>删除含有（1个或多个）缺失值的样本（行）</li><li>删除缺失值太多的特征（列）</li><li>对缺失值进行插补</li><li>不处理</li></ul><p>缺失值的填补</p><ul><li>scikit-learn的类Imputer提供了一些常见填补方法<ul><li>均值mean（默认方法）</li><li>中位数median</li><li>众数most_frequent</li></ul></li><li>pandas库的fillna函数也可以处理缺失值，而且更加灵活，但是重用性较弱</li></ul><table><thead><tr><th style="text-align:center">插补方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">均值/中值/众数插补</td><td style="text-align:center">用该属性的均值/中值/众数进行插补 通常数值型变量用均值/中值、类别型变量用众数插补</td></tr><tr><td style="text-align:center">固定值插补</td><td style="text-align:center">根据背景知识用某个常量进行插补</td></tr><tr><td style="text-align:center">最近邻插补</td><td style="text-align:center">寻找最相似的样本，用该样本的属性值插补 可采用相关系数矩阵来确定哪个变量（X）与缺失值所在变量（Y）最相关。然后把所有样本按X的取值大小进行排序，变量Y的缺失值可以用排在缺失值前的那个样本的数据来代替</td></tr><tr><td style="text-align:center">回归方法</td><td style="text-align:center">选择若干个预测缺失值的自变量X，然后建立回归方程估计缺失值</td></tr><tr><td style="text-align:center">插值法</td><td style="text-align:center">利用该变量已有数据建立合适的插值函数进行插补</td></tr></tbody></table><h2 id="异常值分析"><a class="markdownIt-Anchor" href="#异常值分析"></a> 异常值分析</h2><p>异常值也被成为离群点，是样本的某属性值明显偏离其余观测值。通常认为这些点是噪声，对模型有坏的影响。</p><ul><li><p>发现异常值</p><ul><li>最大值/最小值分析</li><li>2<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base"><span class="mord mathit" style="margin-right:0.03588em;">σ</span></span></span></span>原则</li><li>箱型图</li><li>直方图（尾巴）</li><li>散点图（散点图上孤立的点）</li><li>分位数（0.5%-99.5%分位数以外）</li></ul></li><li><p>异常值处理：类似缺失值处理</p><ul><li>注意分析异常值产生的原因</li></ul><p>​</p></li></ul><h2 id="特征分布分析"><a class="markdownIt-Anchor" href="#特征分布分析"></a> 特征分布分析</h2><h3 id="直方图"><a class="markdownIt-Anchor" href="#直方图"></a> 直方图</h3><p>直方图：每个取值在数据集中出现的次数，可视为概率函数(PDF)的估计(seaborn可视化工具比较简单)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import seaborn as sns</span><br><span class="line">sns.ditplot(tranin.price.values, bins=50, kde=True)</span><br></pre></td></tr></table></figure><p>核密度估计</p><ul><li>Kernel Density Estimation，KDE</li><li>直方图的加窗平滑</li></ul><p>在分类任务中，关心不同类别的特征分布</p><ul><li>核密度估计</li><li>order=[‘low’, ‘medium’, ‘high’]</li><li>sns.violinplot(x=‘interest_level’, y= ‘price’, data=train, order=order)</li></ul><h3 id="表示集中趋势的统计量"><a class="markdownIt-Anchor" href="#表示集中趋势的统计量"></a> 表示集中趋势的统计量</h3><ul><li>均值</li><li>中值</li><li>众数</li></ul><h3 id="表示散布程度的统计量"><a class="markdownIt-Anchor" href="#表示散布程度的统计量"></a> 表示散布程度的统计量</h3><ul><li>方差</li><li>四分位数间距</li><li>IQR在箱体图boxplot(seaborn.boxplot())中用到：分布的图形概述<ul><li>长方形为IQR</li><li>中间的线为中值</li><li>两头的虚线：1.51QR</li></ul></li></ul><h3 id="相关性"><a class="markdownIt-Anchor" href="#相关性"></a> 相关性</h3><ul><li>希望特征与标签强相关<ul><li>分类直方图可以从某种程度上看出特征与标签的相关性：不同类别的直方图差异大</li></ul></li><li>特征与特征之间强相关的话意味着信息冗余<ul><li>可以两个特征只保留一个</li><li>或采用主成分分析（PCA)等降维</li></ul></li></ul><h1 id="数据预处理"><a class="markdownIt-Anchor" href="#数据预处理"></a> 数据预处理</h1><p>数据取值范围缩放</p><ul><li>数据标准化（Standardization）</li><li>数据归一化（Scaling）</li><li>数据正规化（Normalization）</li><li>数据二值化</li></ul><p>from sklearn.preprocessing import …</p><table><thead><tr><th style="text-align:center">类</th><th style="text-align:center">功能</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">StandardScaler</td><td style="text-align:center">无量纲化</td><td style="text-align:center">标准化，基于特征矩阵的列，将特征值转换至服从标准正态分布</td></tr><tr><td style="text-align:center">MinMaxScaler</td><td style="text-align:center">无量纲化</td><td style="text-align:center">区间缩放，基于最大最小值，将特征值转换到[0,1]区间上</td></tr><tr><td style="text-align:center">Normalizer</td><td style="text-align:center">归一化</td><td style="text-align:center">基于特征矩阵的行，将样本向量转换为“单位向量”</td></tr><tr><td style="text-align:center">Binarizer</td><td style="text-align:center">二值化</td><td style="text-align:center">基于给定阈值，将定量特征按阈值划分</td></tr><tr><td style="text-align:center">OneHotEncoder</td><td style="text-align:center">哑编码</td><td style="text-align:center">将定性数据编码为定量数据</td></tr><tr><td style="text-align:center">Imputer</td><td style="text-align:center">缺失值处理</td><td style="text-align:center">计算缺失值，缺失值可填充为均值等</td></tr><tr><td style="text-align:center">PolynomialFeatures</td><td style="text-align:center">多项式数据转换</td><td style="text-align:center">多项式数据转换</td></tr><tr><td style="text-align:center">Function Transformer</td><td style="text-align:center">自定义单元格数据转换</td><td style="text-align:center">使用单变元的函数来转换数据</td></tr></tbody></table><h1 id="特征编码"><a class="markdownIt-Anchor" href="#特征编码"></a> 特征编码</h1><ul><li>数值型</li><li>类别型</li><li>时间类</li><li>文本型</li><li>统计型</li></ul><h2 id="数值型特征"><a class="markdownIt-Anchor" href="#数值型特征"></a> 数值型特征</h2><ul><li><p>有时候数值特征并不能直接适用于线性模型，可以选择使用log(x+1)变换来处理我们的数值特征，其中x表示数值特征</p><ul><li><p>检查数据偏斜度（skewness），并以此衡量数据分布的形状</p></li><li><p>当使用回归方法时，如果目标变量出现偏斜，则有必要对目标变量进行对数变换(log-transform)。通过对数变换，可以改善数据的线性度。</p><p><code>train.SalePrice=np.loglp(train.SalesPrice)</code></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1frc7zd7emoj20fd03twew.jpg" alt=""></p></li></ul></li><li><p>还可以根据需要进行多项式扩展数值特征</p></li></ul><p>模型很多时候是线性模型，可以在特征上做一些工作，让模型包含一些非线性特征</p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1frc858vs43j20y60bldhc.jpg" alt=""></p><p>默认值为2，则特征两两组合，先和自己再和其他</p><h2 id="数值型特征离散化"><a class="markdownIt-Anchor" href="#数值型特征离散化"></a> 数值型特征离散化</h2><ul><li>有时候将数值型属性转换成类别表示更有意义<ul><li>如年龄，根据人生阶段划分往往更有意义</li><li>房屋到街道的距离分为远、中、近</li></ul></li><li>了解领域背景知识，确保特征划分成分区有意义<ul><li>所有落入一个分区的数值都呈现出共同的特征</li><li>在实际应用中，需要仔细考虑分区的粒度，防止过拟合</li></ul></li><li>也可以采用聚类技术实现分组</li></ul><p>注意：如果数据的准确率很重要的话，此时离散化不合适</p><h2 id="类别型特征"><a class="markdownIt-Anchor" href="#类别型特征"></a> 类别型特征</h2><ul><li>有些模型只能处理数值型数据。如果给定的数据是不同的类型，必须先将数据编程数值型。<ul><li>用0和1来代表样本是否有某种特性</li></ul></li><li>LbabelEncoder：用有序数对不连续的数字或者文本进行编号<ul><li>如用数字表示房屋质量：分别用1、2 、3表示质量差、中、好</li><li>存储量小</li></ul></li><li>如果不希望有序数关系，采用哑编码（OneHotEncoder）：将类别型整数输入从1维----&gt;K维的稀疏编码<ul><li>统计该特征上有多少类，就设置几维(K)的向量</li><li>输入必须是数值型数据（对字符串输入，先调用LabelEncoder变成数字，再用OneHotEncoder）</li><li>存储要求高，通常要求K&lt;10（低基数）</li></ul></li><li>对高基数类别型特征：通常有成百上千个不同的取值（如邮政编码、街道名称…）<ul><li>可先采用降维/聚类：1维—&gt;K维，K为聚类的类别数</li><li>或采用均值编码：在贝叶斯的架构下，利用标签变量，有监督地确定最适合特定特征的编码方式</li></ul></li></ul><h2 id="均值编码"><a class="markdownIt-Anchor" href="#均值编码"></a> 均值编码</h2><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frc8wl4rsaj20t30ajq45.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1frc8zvjf8sj20s00be75g.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frc90307n8j20t20bi0vw.jpg" alt=""></p><h2 id="日期型特征"><a class="markdownIt-Anchor" href="#日期型特征"></a> 日期型特征</h2><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frc944nnp8j20s30b3dgj.jpg" alt=""></p><h2 id="文本型特征"><a class="markdownIt-Anchor" href="#文本型特征"></a> 文本型特征</h2><p>文本型特征无法直接送到学习器，需要先进行特征提取</p><p>scikit-learn采用简单的文本特征提取，更多文本特征提取可采用Natural Language Tookit（NLTK）</p><ul><li>词向量（1-gram模型）：即词袋模型，统计次出现的次数（词频）<ul><li>CountVectorizer</li></ul></li><li>n-gram模型：将词或 扩展为n个词语组成的短语</li></ul><p>TF-IDF特征：</p><ul><li>TF(Term Frequency)：衡量一个term在文档中出现的多频繁</li><li>IDF(Inverse Document Frequency)：衡量一个term有多重要<ul><li>有些词出现的很多，但是并没有什么作用 ‘is’、‘the’…</li><li>将罕见的词重要性调高，常见词重要性调低</li></ul></li><li>TF(t)=(词t在当前文中出现次数)/(当前文档中出现的单词的总次数)</li><li>IDF(t)=ln(总文档数/含t的文档数)</li><li>TF-IDF(t)=TF(t)*IDF(t)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.feature_extraction.text.TfidfTransformer(norm=&apos;l2&apos;, use_idf=True, smooth_idf=True, sublinear_tf=False)</span><br></pre></td></tr></table></figure><p>可用词云可视化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from wordcloud import WordCloud</span><br><span class="line">wordcloud = WordCloud(background_color=&apos;white&apos;, width=600, height=300,</span><br><span class="line">max_font_size=50, max_words=40)</span><br><span class="line">wordcloud.generate(text)</span><br></pre></td></tr></table></figure><h1 id="构造特征"><a class="markdownIt-Anchor" href="#构造特征"></a> 构造特征</h1><p>将特征进行混合或组合以得到新的特征</p><ul><li>根据经验组合特征<ul><li>如经纬度组合到一起，就代表地理上特定的区域</li></ul></li><li>Top K个特征组合</li><li>GBDT得到特征序列，组合这些特征</li></ul><p>组合方式</p><ul><li>串联</li><li>加减乘除：房间单价=房屋价格/房间数</li><li>差分</li><li>统计<ul><li>均值：节假日数据的统计信息、平均一周（月）的人数</li><li>加减平均：超过平均值</li><li>分位数/线：你超过了x%的用户</li><li>次序</li><li>比例</li></ul></li></ul><h1 id="特征选择"><a class="markdownIt-Anchor" href="#特征选择"></a> 特征选择</h1><p>原因：</p><ul><li>冗余：部分特征之间相关度太高</li><li>噪声</li></ul><p>特征选择vs.降维</p><ul><li>降维(PCA/SVD)：对原始特征进行线性组合，得到低维表示</li><li>特征选择：剔除与预测关系不大的特征子集<ul><li>减少特征数目，防止过拟合，提高模型泛化能力</li><li>有助于更好地理解特征的特性及其与响应之间的关系</li></ul></li></ul><p>如何：</p><ul><li><p>删除方差过小的特征</p><p>方差小意味着变化很小（标准差小），意味着该特征包含信息少，特征区分度很低</p><p><code>class sklearn.feature_selection.VarianceThreshold(threshold=0.0)</code></p><ul><li>删除方差小于threshold的特征</li><li>threshold缺省值为0，保留所有特征</li></ul></li><li><p>过滤型</p><p>根据单变量的统计测试选择分数最佳特征</p><ul><li>sklearn.feature_selection.SelectKBest：选择分数最高的k个特征</li><li>sklearn.feature_selection.SelectPercentile:选择分数最高的百分比特征</li><li>缺点：没有考虑到特征之间的关联作用，可能把有用的关联特征误踢掉</li></ul></li></ul><p>​         分数度量</p><p>​           相关系数</p><p>​                 相关系数只对线性关系敏感，不太能发现非线性相关<br>相关系数只对两个实数型随机变量有定义<br>互信息／最大信息系数</p><ul><li>互信息</li></ul><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1frcard2gtlj20qg095aao.jpg" alt=""></p><ul><li>最大信息系数</li></ul><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcasn6c3mj20ms0a6wgo.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcaycph7mj20m709lgmd.jpg" alt=""></p><p>sklearn</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcazjto1vj20n30b4aeq.jpg" alt=""></p><ul><li>包裹型</li></ul><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1frcb36zodyj20lu07974t.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcb417b0aj20i40cfjve.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcb4zp60kj20l50d9gq0.jpg" alt=""></p><ul><li><p>嵌入型</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1frcb5w4ifzj20n809m0tj.jpg" alt=""></p><p>​</p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1frcb6zvdzxj20og0b3gqh.jpg" alt=""></p><p>​</p><p>​</p><p>​</p><h1 id="如何获取重要特征"><a class="markdownIt-Anchor" href="#如何获取重要特征"></a> 如何获取重要特征</h1></li><li><p>相关领域的专家知识</p></li><li><p>深度学习自动学习特征</p></li><li><p>试验、经验与发现</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;特征工程概览&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#特征工程概览&quot;&gt;&lt;/a&gt; 特征工程概览&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;http://wx2.sinaimg.cn/mw690/c3a5a043ly1frc6fow71cj
      
    
    </summary>
    
    
      <category term="机器学习" scheme="http://yoursite.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>pandas的API</title>
    <link href="http://yoursite.com/post/f78af6eb.html"/>
    <id>http://yoursite.com/post/f78af6eb.html</id>
    <published>2018-05-10T10:55:10.000Z</published>
    <updated>2018-07-23T05:02:20.278Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>zookeeper</title>
    <link href="http://yoursite.com/post/3ad834c9.html"/>
    <id>http://yoursite.com/post/3ad834c9.html</id>
    <published>2018-05-08T12:06:18.000Z</published>
    <updated>2018-07-23T05:02:20.296Z</updated>
    
    <content type="html"><![CDATA[<h1 id="zookeeper部署"><a class="markdownIt-Anchor" href="#zookeeper部署"></a> zookeeper部署</h1><p>安装到3台虚拟机上</p><p>安装好JDK</p><h2 id="上传"><a class="markdownIt-Anchor" href="#上传"></a> 上传</h2><h2 id="解压"><a class="markdownIt-Anchor" href="#解压"></a> 解压</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su – hadoop（切换到hadoop用户）</span><br><span class="line">tar -zxvf zookeeper-3.4.5.tar.gz（解压）</span><br></pre></td></tr></table></figure><h2 id="重命名"><a class="markdownIt-Anchor" href="#重命名"></a> 重命名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv zookeeper-3.4.5 zookeeper #（重命名文件夹zookeeper-3.4.5为zookeeper）</span><br></pre></td></tr></table></figure><h2 id="修改环境变量"><a class="markdownIt-Anchor" href="#修改环境变量"></a> 修改环境变量</h2><p>root用户下</p><p>在三台虚拟机上都要执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su – root</span><br><span class="line">vi /etc/profile(修改文件)</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><p>profile里：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ZOOKEEPER_HOME=/root/app/zookeeper-3.4.11</span><br><span class="line">export PATH=$PATH:$ZOOKEEPER_HOME/bin</span><br></pre></td></tr></table></figure><h2 id="修改配置文件"><a class="markdownIt-Anchor" href="#修改配置文件"></a> 修改配置文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su - hadoop</span><br><span class="line">cd zookeeper/conf</span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br><span class="line">vi zoo.cfg</span><br></pre></td></tr></table></figure><p>添加以下内容:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dataDir=/home/hadoop/zookeeper/data</span><br><span class="line"></span><br><span class="line">dataLogDir=/home/hadoop/zookeeper/log</span><br><span class="line"></span><br><span class="line">server.1=slave1:2888:3888 (主机名, 心跳端口、数据端口)</span><br><span class="line"></span><br><span class="line">server.2=slave2:2888:3888</span><br><span class="line"></span><br><span class="line">server.3=slave3:2888:3888</span><br></pre></td></tr></table></figure><p>slave处也可以填ip地址，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.1=192.168.88.131:2888:3888</span><br><span class="line">server.2=192.168.88.141:2888:3888</span><br><span class="line">server.3=192.168.88.139:2888:3888</span><br></pre></td></tr></table></figure><p>创建文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop/zookeeper/</span><br><span class="line">mkdir -m 755 data</span><br><span class="line">mkdir -m 755 log</span><br></pre></td></tr></table></figure><p>在data文件夹下新建myid文件，myid的文件内容为：</p><p>cd data</p><p>echo 1 &gt; myid</p><h2 id="将集群下发到其他机器上"><a class="markdownIt-Anchor" href="#将集群下发到其他机器上"></a> 将集群下发到其他机器上</h2><p>scp -r /home/hadoop/zookeeperhadoop@slave2:/home/hadoop/</p><p>scp -r /home/hadoop/zookeeper hadoop@slave3:/home/hadoop/</p><h2 id="修改其他机器的配置文件"><a class="markdownIt-Anchor" href="#修改其他机器的配置文件"></a> 修改其他机器的配置文件</h2><p>到slave2上：修改myid为：2</p><p>到slave3上：修改myid为：3</p><h2 id="查看集群状态"><a class="markdownIt-Anchor" href="#查看集群状态"></a> 查看集群状态</h2><p>1、  jps（查看进程）</p><p>2、  <a href="http://zkServer.sh" target="_blank" rel="noopener">zkServer.sh</a> status（查看集群状态，主从信息）</p><h1 id="zookeeper-结构和命令"><a class="markdownIt-Anchor" href="#zookeeper-结构和命令"></a> zookeeper 结构和命令</h1><h2 id="zookeeper特性"><a class="markdownIt-Anchor" href="#zookeeper特性"></a> zookeeper特性</h2><p>1、Zookeeper：一个leader，多个follower组成的集群</p><p>2、全局数据一致：每个server保存一份相同的数据副本，client无论连接到哪个server，数据都是一致的</p><p>3、分布式读写，更新请求转发，由leader实施</p><p>4、更新请求顺序进行，来自同一个client的更新请求按其发送顺序依次执行</p><p>5、数据更新原子性，一次数据更新要么成功，要么失败</p><p>6、实时性，在一定时间范围内，client能读到最新数据</p><h2 id="zookeeper数据结构"><a class="markdownIt-Anchor" href="#zookeeper数据结构"></a> zookeeper数据结构</h2><p>1、层次化的目录结构，命名符合常规文件系统规范(见下图)</p><p>2、每个节点在zookeeper中叫做znode,并且其有一个唯一的路径标识</p><p>3、节点Znode可以包含数据和子节点（但是EPHEMERAL类型的节点不能有子节点，下一页详细讲解）</p><p>4、客户端应用可以在节点上设置监视器（后续详细讲解）</p><h2 id="数据结构的图"><a class="markdownIt-Anchor" href="#数据结构的图"></a> 数据结构的图</h2><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fr4vjfih3fj20af06ddgb.jpg" alt=""></p><p>最上面 / 父节点</p><p>每个节点都可以存放数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 0] ls /</span><br><span class="line">[zookeeper, app1, eclipse]</span><br></pre></td></tr></table></figure><p>/ 下面有三个子节点</p><p>再创建一个子节点app2 后面的<code>&quot;this is app2 servers parent&quot;</code>是写入的数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 3] create /app2 &quot;this is app2 servers parent&quot; </span><br><span class="line">Created /app2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 5] ls /         </span><br><span class="line">[zookeeper, app2, app1, eclipse]</span><br></pre></td></tr></table></figure><p>于是根下多了app2</p><p>可以继续在app2下创建</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 6] create /app2/server01 &quot;192.168.33.5,100&quot;</span><br><span class="line">Created /app2/server01</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 10] get /app2</span><br><span class="line">this is app2 servers parent</span><br><span class="line">cZxid = 0x400000004</span><br><span class="line">ctime = Wed May 09 10:28:11 CST 2018</span><br><span class="line">mZxid = 0x400000004</span><br><span class="line">mtime = Wed May 09 10:28:11 CST 2018</span><br><span class="line">pZxid = 0x400000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 27</span><br><span class="line">numChildren = 1</span><br><span class="line"></span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 11] get /app2/server01</span><br><span class="line">192.168.33.5,100</span><br><span class="line">cZxid = 0x400000005</span><br><span class="line">ctime = Wed May 09 10:31:18 CST 2018</span><br><span class="line">mZxid = 0x400000005</span><br><span class="line">mtime = Wed May 09 10:31:18 CST 2018</span><br><span class="line">pZxid = 0x400000005</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 16</span><br><span class="line">numChildren = 0</span><br></pre></td></tr></table></figure><p>用get查看数据</p><p>数据下面的是事务编号等信息</p><h2 id="节点类型"><a class="markdownIt-Anchor" href="#节点类型"></a> 节点类型</h2><p>1、Znode有两种类型：</p><p>短暂（ephemeral）（断开连接自己删除）</p><p>监控服务器是否掉线时有用，掉线节点会被删除</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 12] create -e /app-e &quot;hello this e&quot;</span><br><span class="line">Created /app-e</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 13] ls /</span><br><span class="line">[app-e, zookeeper, app2, app1, eclipse]</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 14] quit</span><br><span class="line">Quitting...</span><br><span class="line">2018-05-09 10:49:30,494 [myid:] - INFO  [main:ZooKeeper@687] - Session: 0x20007fd41fe0000 closed</span><br><span class="line">2018-05-09 10:49:30,498 [myid:] - INFO  [main-EventThread:ClientCnxn$EventThread@520] - EventThread shut down for session: 0x20007fd41fe0000</span><br><span class="line">[root@mini3 conf]# zkCli.sh -server 192.168.88.141</span><br><span class="line">Connecting to 192.168.88.141</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 0] ls /</span><br><span class="line">[zookeeper, app2, app1, eclipse]</span><br></pre></td></tr></table></figure><p>创建一个暂时节点，退出重连后app-e消失</p><p>持久（persistent）（断开连接不删除）</p><p>2、Znode有四种形式的目录节点（默认是persistent ）</p><p>PERSISTENT</p><p>PERSISTENT_SEQUENTIAL（持久序列/test0000000019）</p><p>EPHEMERAL</p><p>EPHEMERAL_SEQUENTIAL</p><p>带序号，创建的节点名字后面会自动有序号，不怕名字重复。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 1] create /test 888</span><br><span class="line">Created /test</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 2] create -s /test/aa 999</span><br><span class="line">Created /test/aa0000000000</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 3] create -s /test/bb 999</span><br><span class="line">Created /test/bb0000000001</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 4] create -s /test/aa 999</span><br><span class="line">Created /test/aa0000000002</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 5] create -s /app2/aa 999</span><br><span class="line">Created /app2/aa0000000001</span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 6] create -e -s /app2/aa 999</span><br><span class="line">Created /app2/aa0000000002</span><br></pre></td></tr></table></figure><p>3、创建znode时设置顺序标识，znode名称后会附加一个值，顺序号是一个单调递增的计数器，由父节点维护</p><p>4、在分布式系统中，顺序号可以被用于为所有的事件进行全局排序，这样客户端可以通过顺序号推断事件的顺序</p><h2 id="zookeeper命令行操作"><a class="markdownIt-Anchor" href="#zookeeper命令行操作"></a> zookeeper命令行操作</h2><p>运行 <a href="http://zkCli.sh" target="_blank" rel="noopener">zkCli.sh</a> –server <ip>进入命令行工具</ip></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkCli.sh -server 192.168.88.141</span><br></pre></td></tr></table></figure><p>没有-server会连接到自己</p><p>可以help命令，查看可以使用的命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 1] help</span><br><span class="line">ZooKeeper -server host:port cmd args</span><br><span class="line">        stat path [watch]</span><br><span class="line">        set path data [version]</span><br><span class="line">        ls path [watch]</span><br><span class="line">        delquota [-n|-b] path</span><br><span class="line">        ls2 path [watch]</span><br><span class="line">        setAcl path acl</span><br><span class="line">        setquota -n|-b val path</span><br><span class="line">        history </span><br><span class="line">        redo cmdno</span><br><span class="line">        printwatches on|off</span><br><span class="line">        delete path [version]</span><br><span class="line">        sync path</span><br><span class="line">        listquota path</span><br><span class="line">        rmr path</span><br><span class="line">        get path [watch]</span><br><span class="line">        create [-s] [-e] path data acl</span><br><span class="line">        addauth scheme auth</span><br><span class="line">        quit </span><br><span class="line">        getAcl path</span><br><span class="line">        close </span><br><span class="line">        connect host:port</span><br></pre></td></tr></table></figure><p>1、使用 ls 命令来查看当前 ZooKeeper 中所包含的内容：</p><p>[zk: 202.115.36.251:2181(CONNECTED) 1] ls /</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 0] ls /</span><br><span class="line">[zookeeper, app1, eclipse]</span><br></pre></td></tr></table></figure><p>2、创建一个新的 znode ，使用 create /zk myData 。这个命令创建了一个新的 znode 节点“ zk ”以及与它关联的字符串：</p><p>[zk: 202.115.36.251:2181(CONNECTED) 2] create /zk &quot;myData“</p><p>3、我们运行 get 命令来确认 znode 是否包含我们所创建的字符串：</p><p>[zk: 202.115.36.251:2181(CONNECTED) 3] get /zk</p><p>#监听这个节点的变化,当另外一个客户端改变/zk时,它会打出下面的</p><p>#WATCHER::</p><p>#WatchedEvent state:SyncConnectedtype:NodeDataChanged path:/zk</p><p>[zk: localhost:2181(CONNECTED) 4] get /zkwatch</p><p>4、下面我们通过 set 命令来对 zk 所关联的字符串进行设置：</p><p>set 进行更新</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 1] get /app1</span><br><span class="line">this is app1 service parent</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x200000004</span><br><span class="line">mtime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 27</span><br><span class="line">numChildren = 1</span><br><span class="line"></span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 2] set /app1 uuuuu</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000003</span><br><span class="line">mtime = Wed May 09 13:14:07 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br><span class="line"></span><br><span class="line">[zk: 192.168.88.141(CONNECTED) 3] get /app1</span><br><span class="line">uuuuu</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000003</span><br><span class="line">mtime = Wed May 09 13:14:07 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure><p>在另一台虚拟机mini3里连接客户端：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mini3 ~]# zkCli.sh</span><br><span class="line">Connecting to localhost:2181</span><br><span class="line">[zk: localhost:2181(CONNECTED) 0] ls /</span><br><span class="line">[zookeeper, app2, test, app1, eclipse]</span><br></pre></td></tr></table></figure><p>在虚拟机mini1中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 4] set /app1 yyyyy</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000005</span><br><span class="line">mtime = Wed May 09 13:20:19 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 2</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure><p>于是mini3中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 1] get /app1</span><br><span class="line">yyyyy</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000005</span><br><span class="line">mtime = Wed May 09 13:20:19 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 2</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure><p>瞬间就能取到变化了的数据，毫秒级别，但是机器非常多时就会有些延迟了。</p><p>5、get 监听功能</p><p>在mini3里</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 2] get /app1 watch</span><br><span class="line">yyyyy</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000005</span><br><span class="line">mtime = Wed May 09 13:20:19 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 2</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure><p>在mini1里修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 5] set /app1 hhhhh</span><br><span class="line">cZxid = 0x200000004</span><br><span class="line">ctime = Mon Jan 29 15:44:58 CST 2018</span><br><span class="line">mZxid = 0x500000006</span><br><span class="line">mtime = Wed May 09 13:25:56 CST 2018</span><br><span class="line">pZxid = 0x200000005</span><br><span class="line">cversion = 1</span><br><span class="line">dataVersion = 3</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 5</span><br><span class="line">numChildren = 1</span><br></pre></td></tr></table></figure><p>于是因为mini3中开启了监听功能，mini3中会自动出现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 3] </span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:NodeDataChanged path:/app1</span><br></pre></td></tr></table></figure><p>但是这个监听只生效一次</p><p>并且添加节点不会监听，因为get的监听只会监听数据变化</p><p>想监听节点变化 用ls watch</p><p>mini3里</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 3] ls /app1 watch</span><br><span class="line">[server01]</span><br></pre></td></tr></table></figure><p>mini1里</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 192.168.88.141(CONNECTED) 6] create /app1/hello 123</span><br><span class="line">Created /app1/hello</span><br></pre></td></tr></table></figure><p>mini3里会出现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: localhost:2181(CONNECTED) 4] </span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:NodeChildrenChanged path:/app1</span><br></pre></td></tr></table></figure><p>6、下面我们将刚才创建的 znode 删除：</p><p>[zk: 202.115.36.251:2181(CONNECTED) 5] delete /zk</p><p>7、删除节点：rmr</p><p>[zk: 202.115.36.251:2181(CONNECTED) 5] rmr /zk</p><h1 id="zookeeper启动脚本"><a class="markdownIt-Anchor" href="#zookeeper启动脚本"></a> zookeeper启动脚本</h1><p>export 一个 变量到底是在环境里还是哪里</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# a=1</span><br><span class="line">[root@mini2 ~]# vi s1.sh</span><br><span class="line">[root@mini2 ~]# echo $a</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">[root@mini2 ~]# chmod 777 s1.sh</span><br><span class="line">[root@mini2 ~]# ./s1.sh         </span><br><span class="line"></span><br><span class="line">[root@mini2 ~]#</span><br></pre></td></tr></table></figure><p>脚本里是</p><p>#!/bin/bash</p><p>echo $a</p><p>打印不出</p><p>因为脚本s1.sh在运行的时候是在另外一个bash子进程中</p><p>利用pstree命令</p><p>米有安装先安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# yum install psmisc</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# pstree</span><br><span class="line">systemd─┬─NetworkManager─┬─dhclient</span><br><span class="line">        │                └─2*[&#123;NetworkManager&#125;]</span><br><span class="line">        ├─VGAuthService</span><br><span class="line">        ├─abrt-watch-log</span><br><span class="line">        ├─abrtd</span><br><span class="line">        ├─auditd───&#123;auditd&#125;</span><br><span class="line">        ├─chronyd</span><br><span class="line">        ├─crond</span><br><span class="line">        ├─dbus-daemon───&#123;dbus-daemon&#125;</span><br><span class="line">        ├─java───22*[&#123;java&#125;]</span><br><span class="line">        ├─login───bash</span><br><span class="line">        ├─master─┬─pickup</span><br><span class="line">        │        └─qmgr</span><br><span class="line">        ├─polkitd───5*[&#123;polkitd&#125;]</span><br><span class="line">        ├─rsyslogd───2*[&#123;rsyslogd&#125;]</span><br><span class="line">        ├─sshd───sshd───bash───pstree</span><br><span class="line">        ├─systemd-journal</span><br><span class="line">        ├─systemd-logind</span><br><span class="line">        ├─systemd-udevd</span><br><span class="line">        ├─tuned───4*[&#123;tuned&#125;]</span><br><span class="line">        └─vmtoolsd───&#123;vmtoolsd&#125;</span><br></pre></td></tr></table></figure><p>脚本不运行在当前bash中</p><p>export后可以打印</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# unset a</span><br><span class="line">[root@mini2 ~]# export a=1</span><br><span class="line">[root@mini2 ~]# ./s1.sh           </span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>修改脚本s1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">b=2</span><br><span class="line">echo &quot;in s1,a=&quot;$a</span><br><span class="line">echo &quot;in s1,b=&quot;$b</span><br><span class="line">./s2.sh</span><br></pre></td></tr></table></figure><p>创建s2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># /bin/bash</span><br><span class="line">echo &quot;in s2,a=&quot;$a</span><br><span class="line">echo &quot;in s2,b=&quot;$b</span><br></pre></td></tr></table></figure><p>运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# export a=1</span><br><span class="line">[root@mini2 ~]# ./s1.sh           </span><br><span class="line">1</span><br><span class="line">[root@mini2 ~]# vi s1.sh          </span><br><span class="line">[root@mini2 ~]# chmod 777 s1.sh   </span><br><span class="line">[root@mini2 ~]# vi s1.sh       </span><br><span class="line">[root@mini2 ~]# vi s2.sh</span><br><span class="line">[root@mini2 ~]# chmod +x s2.sh</span><br><span class="line"></span><br><span class="line"># 运行</span><br><span class="line">[root@mini2 ~]# ./s1.sh</span><br><span class="line">in s1,a=1</span><br><span class="line">in s1,b=2</span><br><span class="line">in s2,a=1</span><br><span class="line">in s2,b=</span><br></pre></td></tr></table></figure><p>b只运行在s1脚本子shell当中</p><p>在s1中export</p><p>#!/bin/bash</p><p>export b=2<br>echo &quot;in s1,a=&quot;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>e</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi mathvariant="normal">&quot;</mi><mi>i</mi><mi>n</mi><mi>s</mi><mn>1</mn><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">aecho &quot;in s1,b=&quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base"><span class="mord mathit">a</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">h</span><span class="mord mathit">o</span><span class="mord">&quot;</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">s</span><span class="mord">1</span><span class="mpunct">,</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord mathit">b</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">&quot;</span></span></span></span>b<br>./s2.sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# ./s1.sh </span><br><span class="line">in s1,a=1</span><br><span class="line">in s1,b=2</span><br><span class="line">in s2,a=1</span><br><span class="line">in s2,b=2</span><br></pre></td></tr></table></figure><p>但是在命令行中echo不到b</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# echo $b</span><br><span class="line"></span><br><span class="line">[root@mini2 ~]#</span><br></pre></td></tr></table></figure><p>s1和s2运行在当前bash的子进程中，父进程中没有b</p><p>要想在所有进程中都生效用source</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@mini2 ~]# source s1.sh</span><br><span class="line">in s1,a=1</span><br><span class="line">in s1,b=2</span><br><span class="line">in s2,a=1</span><br><span class="line">in s2,b=2</span><br><span class="line">[root@mini2 ~]# echo $b</span><br><span class="line">2</span><br></pre></td></tr></table></figure><p>启动登陆时会自动运行  /etc/porfile等</p><p>但ssh时不会运行，必须手动source</p><p><a href="http://startzk.sh" target="_blank" rel="noopener">startzk.sh</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;start zkServer...&quot;</span><br><span class="line">for i in 1 2 3</span><br><span class="line">do</span><br><span class="line">ssh mini$i &quot;source /etc/profile;/root/app/zookeeper/bin/zkServer.sh start&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h1 id="zookeeper-api应用"><a class="markdownIt-Anchor" href="#zookeeper-api应用"></a> zookeeper-api应用</h1><h2 id="基本使用"><a class="markdownIt-Anchor" href="#基本使用"></a> 基本使用</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;zookeeper部署&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#zookeeper部署&quot;&gt;&lt;/a&gt; zookeeper部署&lt;/h1&gt;
&lt;p&gt;安装到3台虚拟机上&lt;/p&gt;
&lt;p&gt;安装好JDK&lt;/p&gt;
&lt;h2 id=&quot;上传&quot;&gt;&lt;a cl
      
    
    </summary>
    
    
      <category term="大数据 zookeeper" scheme="http://yoursite.com/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE-zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>linux中的crontab</title>
    <link href="http://yoursite.com/post/b00607be.html"/>
    <id>http://yoursite.com/post/b00607be.html</id>
    <published>2018-05-07T12:16:26.000Z</published>
    <updated>2018-07-23T05:02:20.267Z</updated>
    
    <content type="html"><![CDATA[<p>at 命令是针对仅运行一次的任务，循环运行的例行性计划任务，linux系统则是由 cron (crond) 这个系统服务来控制的。Linux 系统上面原本就有非常多的计划性工作，因此这个系统服务是默认启动的。另外, 由于使用者自己也可以设置计划任务，所以， Linux 系统也提供了使用者控制计划任务的命令 :crontab 命令。</p><p><strong>一、crond简介</strong></p><p>crond是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。</p><p>Linux下的任务调度分为两类，系统任务调度和用户任务调度。</p><p>系统任务调度：系统周期性所要执行的工作，比如写缓存数据到硬盘、日志清理等。在/etc目录下有一个crontab文件，这个就是系统任务调度的配置文件。</p><p>/etc/crontab文件包括下面几行：</p><p>[root@localhost ~]# cat /etc/crontab</p><p>SHELL=/bin/bash</p><p>PATH=/sbin:/bin:/usr/sbin:/usr/bin</p><p>MAILTO=&quot;&quot;HOME=/</p><p># run-parts</p><p>51 * * * * root run-parts /etc/cron.hourly</p><p>24 7 * * * root run-parts /etc/cron.daily</p><p>22 4 * * 0 root run-parts /etc/cron.weekly</p><p>42 4 1 * * root run-parts /etc/cron.monthly</p><p>[root@localhost ~]#</p><p>前四行是用来配置crond任务运行的环境变量，第一行SHELL变量指定了系统要使用哪个shell，这里是bash，第二行PATH变量指定了系统执行命令的路径，第三行MAILTO变量指定了crond的任务执行信息将通过电子邮件发送给root用户，如果MAILTO变量的值为空，则表示不发送任务执行信息给用户，第四行的HOME变量指定了在执行命令或者脚本时使用的主目录。第六至九行表示的含义将在下个小节详细讲述。这里不在多说。</p><p>用户任务调度：用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用 crontab 工具来定制自己的计划任务。所有用户定义的crontab 文件都被保存在 /var/spool/cron目录中。其文件名与用户名一致。</p><p><strong>使用者权限文件：</strong></p><p>文件：</p><p>/etc/cron.deny</p><p>说明：</p><p>该文件中所列用户不允许使用crontab命令</p><p>文件：</p><p>/etc/cron.allow</p><p>说明：</p><p>该文件中所列用户允许使用crontab命令</p><p>文件：</p><p>/var/spool/cron/</p><p>说明：</p><p>所有用户crontab文件存放的目录,以用户名命名</p><p><strong>crontab****文件的含义：</strong></p><p>用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：</p><p>minute   hour   day   month   week   command</p><p>其中：</p><p>minute： 表示分钟，可以是从0到59之间的任何整数。</p><p>hour：表示小时，可以是从0到23之间的任何整数。</p><p>day：表示日期，可以是从1到31之间的任何整数。</p><p>month：表示月份，可以是从1到12之间的任何整数。</p><p>week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。</p><p>command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。</p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fr31js0swtj20en0bsq4h.jpg" alt="img"></p><p><strong>在以上各个字段中，还可以使用以下特殊字符：</strong></p><p>星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。</p><p>逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”</p><p>中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”</p><p>正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。</p><p><strong>二、crond服务</strong></p><p>安装crontab：</p><p>yum install crontabs</p><p>服务操作说明：</p><p>/sbin/service crond start //启动服务</p><p>/sbin/service crond stop //关闭服务</p><p>/sbin/service crond restart //重启服务</p><p>/sbin/service crond reload //重新载入配置</p><p>查看crontab服务状态：</p><p>service crond status</p><p>手动启动crontab服务：</p><p>service crond start</p><p>查看crontab服务是否已设置为开机启动，执行命令：</p><p>ntsysv</p><p>加入开机自动启动：</p><p>chkconfig –level 35 crond on</p><p><strong>三、crontab命令详解</strong></p><p><strong>1</strong>**．**<strong>命令格式：</strong></p><p>crontab [-u user] file</p><p>crontab [-u user] [ -e | -l | -r ]</p><p><strong>2</strong>**．**<strong>命令功能：</strong></p><p>通过crontab 命令，我们可以在固定的间隔时间执行指定的系统指令或 shell script脚本。时间间隔的单位可以是分钟、小时、日、月、周及以上的任意组合。这个命令非常设合周期性的日志分析或数据备份等工作。</p><p><strong>3</strong>**．**<strong>命令参数：</strong></p><p>-u user：用来设定某个用户的crontab服务，例如，“-u ixdba”表示设定ixdba用户的crontab服务，此参数一般有root用户来运行。</p><p>file：file是命令文件的名字,表示将file做为crontab的任务列表文件并载入crontab。如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。</p><p>-e：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。</p><p>-l：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。</p><p>-r：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。</p><p>-i：在删除用户的crontab文件时给确认提示。</p><p><strong>4</strong>**．**<strong>常用方法：</strong></p><p><strong>1).</strong> <strong>创建一个新的crontab文件</strong></p><p>在考虑向cron进程提交一个crontab文件之前，首先要做的一件事情就是设置环境变量EDITOR。cron进程根据它来确定使用哪个编辑器编辑crontab文件。9 9 %的UNIX和LINUX用户都使用vi，如果你也是这样，那么你就编辑$ HOME目录下的. profile文件，在其中加入这样一行：</p><p>EDITOR=vi; export EDITOR</p><p>然后保存并退出。不妨创建一个名为<user> cron的文件，其中<user>是用户名，例如， davecron。在该文件中加入如下的内容。</user></user></p><p>​     # (put your own initials here)echo the date to the console every</p><p>​     # 15minutes between 6pm and 6am</p><p>​     0,15,30,45 18-06 * * * /bin/echo ‘date’ &gt; /dev/console</p><p>​    保存并退出。确信前面5个域用空格分隔。</p><p>在上面的例子中，系统将每隔1 5分钟向控制台输出一次当前时间。如果系统崩溃或挂起，从最后所显示的时间就可以一眼看出系统是什么时间停止工作的。在有些系统中，用tty1来表示控制台，可以根据实际情况对上面的例子进行相应的修改。为了提交你刚刚创建的crontab文件，可以把这个新创建的文件作为cron命令的参数：</p><p>​    $ crontab davecron</p><p>现在该文件已经提交给cron进程，它将每隔1 5分钟运行一次。</p><p>同时，新创建文件的一个副本已经被放在/var/spool/cron目录中，文件名就是用户名(即dave)。</p><p><strong>2).</strong> <strong>列出crontab文件</strong></p><p>为了列出crontab文件，可以用：</p><p>​    $ crontab -l</p><p>​    0,15,30,45,18-06 * * * /bin/echo <code>date</code> &gt; dev/tty1</p><p>你将会看到和上面类似的内容。可以使用这种方法在$ H O M E目录中对crontab文件做一备份：</p><p>​    $ crontab -l &gt; $HOME/mycron</p><p>​    这样，一旦不小心误删了crontab文件，可以用上一节所讲述的方法迅速恢复。</p><p><strong>3).</strong> <strong>编辑crontab文件</strong></p><p>如果希望添加、删除或编辑crontab文件中的条目，而E D I TO R环境变量又设置为v i，那么就可以用v i来编辑crontab文件，相应的命令为：</p><p>​    $ crontab -e</p><p>可以像使用v i编辑其他任何文件那样修改crontab文件并退出。如果修改了某些条目或添加了新的条目，那么在保存该文件时， c r o n会对其进行必要的完整性检查。如果其中的某个域出现了超出允许范围的值，它会提示你。</p><p>我们在编辑crontab文件时，没准会加入新的条目。例如，加入下面的一条：</p><p>​    # DT:delete core files,at 3.30am on 1,7,14,21,26,26 days of each month</p><p>​    30 3 1,7,14,21,26 * * /bin/find -name &quot;core’ -exec rm {} ;</p><p>现在保存并退出。最好在crontab文件的每一个条目之上加入一条注释，这样就可以知道它的功能、运行时间，更为重要的是，知道这是哪位用户的作业。</p><p>现在让我们使用前面讲过的crontab -l命令列出它的全部信息：</p><p>$ crontab -l</p><h1 id="crondave-installed-on-tue-may-4-130743-1999"><a class="markdownIt-Anchor" href="#crondave-installed-on-tue-may-4-130743-1999"></a> (crondave installed on Tue May 4 13:07:43 1999)</h1><h1 id="dtech-the-date-to-the-console-every-30-minites"><a class="markdownIt-Anchor" href="#dtech-the-date-to-the-console-every-30-minites"></a> DT:ech the date to the console every 30 minites</h1><p>0,15,30,45 18-06 * * * /bin/echo <code>date</code> &gt; /dev/tty1</p><h1 id="dtdelete-core-filesat-330am-on-1714212626-days-of-each-month"><a class="markdownIt-Anchor" href="#dtdelete-core-filesat-330am-on-1714212626-days-of-each-month"></a> DT:delete core files,at 3.30am on 1,7,14,21,26,26 days of each month</h1><p>30 3 1,7,14,21,26 * * /bin/find -name &quot;core’ -exec rm {} ;</p><p><strong>4).</strong> <strong>删除crontab文件</strong></p><p>要删除crontab文件，可以用：</p><p>$ crontab -r</p><p><strong>5).</strong> <strong>恢复丢失的crontab文件</strong></p><p>如果不小心误删了crontab文件，假设你在自己的$ H O M E目录下还有一个备份，那么可以将其拷贝到/var/spool/cron/<username>，其中<username>是用户名。如果由于权限问题无法完成拷贝，可以用：</username></username></p><p>​    $ crontab <filename></filename></p><p>​    其中，<filename>是你在$ H O M E目录中副本的文件名。</filename></p><p>我建议你在自己的$ H O M E目录中保存一个该文件的副本。我就有过类似的经历，有数次误删了crontab文件（因为r键紧挨在e键的右边）。这就是为什么有些系统文档建议不要直接编辑crontab文件，而是编辑该文件的一个副本，然后重新提交新的文件。</p><p>有些crontab的变体有些怪异，所以在使用crontab命令时要格外小心。如果遗漏了任何选项，crontab可能会打开一个空文件，或者看起来像是个空文件。这时敲delete键退出，不要按<ctrl-d>，否则你将丢失crontab文件。</ctrl-d></p><p><strong>5</strong>**．**<strong>使用实例</strong></p><p><strong>实例1：每1分钟执行一次command</strong></p><p><strong>命令：</strong></p><ul><li><ul><li><ul><li><ul><li><ul><li>command</li></ul></li></ul></li></ul></li></ul></li></ul><p><strong>实例2：每小时的第3和第15分钟执行</strong></p><p><strong>命令：</strong></p><p>3,15 * * * * command</p><p><strong>实例3：在上午8点到11点的第3和第15分钟执行</strong></p><p><strong>命令：</strong></p><p>3,15 8-11 * * * command</p><p><strong>实例4：每隔两天的上午8点到11点的第3和第15分钟执行</strong></p><p><strong>命令：</strong></p><p>3,15 8-11 */2 * * command</p><p><strong>实例5：每个星期一的上午8点到11点的第3和第15分钟执行</strong></p><p><strong>命令：</strong></p><p>3,15 8-11 * * 1 command</p><p><strong>实例6：每晚的21:30重启smb</strong></p><p><strong>命令：</strong></p><p>30 21 * * * /etc/init.d/smb restart</p><p><strong>实例7：每月1、10、22日的4 : 45重启smb</strong></p><p><strong>命令：</strong></p><p>45 4 1,10,22 * * /etc/init.d/smb restart</p><p><strong>实例8：每周六、周日的1 : 10重启smb</strong></p><p><strong>命令：</strong></p><p>10 1 * * 6,0 /etc/init.d/smb restart</p><p><strong>实例9：每天18 : 00至23 : 00之间每隔30分钟重启smb</strong></p><p><strong>命令：</strong></p><p>0,30 18-23 * * * /etc/init.d/smb restart</p><p><strong>实例10：每星期六的晚上11 : 00 pm重启smb</strong></p><p><strong>命令：</strong></p><p>0 23 * * 6 /etc/init.d/smb restart</p><p><strong>实例11：每一小时重启smb</strong></p><p><strong>命令：</strong></p><ul><li>*/1 * * * /etc/init.d/smb restart</li></ul><p><strong>实例12：晚上11点到早上7点之间，每隔一小时重启smb</strong></p><p><strong>命令：</strong></p><ul><li>23-7/1 * * * /etc/init.d/smb restart</li></ul><p><strong>实例13：每月的4号与每周一到周三的11点重启smb</strong></p><p><strong>命令：</strong></p><p>0 11 4 * mon-wed /etc/init.d/smb restart</p><p><strong>实例14：一月一号的4点重启smb</strong></p><p><strong>命令：</strong></p><p>0 4 1 jan * /etc/init.d/smb restart</p><p><strong>实例15：每小时执行/etc/cron.hourly目录内的脚本</strong></p><p><strong>命令：</strong></p><p>01   *   *   *   *     root run-parts /etc/cron.hourly</p><p><strong>说明：</strong></p><p>run-parts这个参数了，如果去掉这个参数的话，后面就可以写要运行的某个脚本名，而不是目录名了</p><p><strong>四、使用注意事项</strong></p><p><strong>1.</strong> <strong>注意环境变量问题</strong></p><p>有时我们创建了一个crontab，但是这个任务却无法自动执行，而手动执行这个任务却没有问题，这种情况一般是由于在crontab文件中没有配置环境变量引起的。</p><p>在crontab文件中定义多个调度任务时，需要特别注意的一个问题就是环境变量的设置，因为我们手动执行某个任务时，是在当前shell环境下进行的，程序当然能找到环境变量，而系统自动执行任务调度时，是不会加载任何环境变量的，因此，就需要在crontab文件中指定任务运行所需的所有环境变量，这样，系统执行任务调度时就没有问题了。</p><p>不要假定cron知道所需要的特殊环境，它其实并不知道。所以你要保证在shelll脚本中提供所有必要的路径和环境变量，除了一些自动设置的全局变量。所以注意如下3点：</p><p>1）脚本中涉及文件路径时写全局路径；</p><p>2）脚本执行要用到java或其他环境变量时，通过source命令引入环境变量，如：</p><p>cat start_cbp.sh</p><p>#!/bin/sh</p><p>source /etc/profile</p><p>export RUN_CONF=/home/d139/conf/platform/cbp/cbp_jboss.conf</p><p>/usr/local/jboss-4.0.5/bin/run.sh -c mev &amp;</p><p>3）当手动执行脚本OK，但是crontab死活不执行时。这时必须大胆怀疑是环境变量惹的祸，并可以尝试在crontab中直接引入环境变量解决问题。如：</p><p>0 * * * * . /etc/profile;/bin/sh /var/www/java/audit_no_count/bin/restart_audit.sh</p><p><strong>2.</strong> <strong>注意清理系统用户的邮件日志</strong></p><p>每条任务调度执行完毕，系统都会将任务输出信息通过电子邮件的形式发送给当前系统用户，这样日积月累，日志信息会非常大，可能会影响系统的正常运行，因此，将每条任务进行重定向处理非常重要。</p><p>例如，可以在crontab文件中设置如下形式，忽略日志输出：</p><p>0 */3 * * * /usr/local/apache2/apachectl restart &gt;/dev/null 2&gt;&amp;1</p><p>“/dev/null 2&gt;&amp;1”表示先将标准输出重定向到/dev/null，然后将标准错误重定向到标准输出，由于标准输出已经重定向到了/dev/null，因此标准错误也会重定向到/dev/null，这样日志输出问题就解决了。</p><p><strong>3.</strong> <strong>系统级任务调度与用户级任务调度</strong></p><p>系统级任务调度主要完成系统的一些维护操作，用户级任务调度主要完成用户自定义的一些任务，可以将用户级任务调度放到系统级任务调度来完成（不建议这么做），但是反过来却不行，root用户的任务调度操作可以通过“crontab –uroot –e”来设置，也可以将调度任务直接写入/etc/crontab文件，需要注意的是，如果要定义一个定时重启系统的任务，就必须将任务放到/etc/crontab文件，即使在root用户下创建一个定时重启系统的任务也是无效的。</p><p><strong>4.</strong> <strong>其他注意事项</strong></p><p>新创建的cron job，不会马上执行，至少要过2分钟才执行。如果重启cron则马上执行。</p><p>当crontab突然失效时，可以尝试/etc/init.d/crond restart解决问题。或者查看日志看某个job有没有执行/报错tail -f /var/log/cron。</p><p>千万别乱运行crontab -r。它从Crontab目录（/var/spool/cron）中删除用户的Crontab文件。删除了该用户的所有crontab都没了。</p><p>在crontab中%是有特殊含义的，表示换行的意思。如果要用的话必须进行转义%，如经常用的date ‘+%Y%m%d’在crontab里是不会执行的，应该换成date ‘+%Y%m%d</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;at 命令是针对仅运行一次的任务，循环运行的例行性计划任务，linux系统则是由 cron (crond) 这个系统服务来控制的。Linux 系统上面原本就有非常多的计划性工作，因此这个系统服务是默认启动的。另外, 由于使用者自己也可以设置计划任务，所以， Linux 系统
      
    
    </summary>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>linux中的sort、cut、wc命令</title>
    <link href="http://yoursite.com/post/d9a9646d.html"/>
    <id>http://yoursite.com/post/d9a9646d.html</id>
    <published>2018-05-07T10:41:43.000Z</published>
    <updated>2018-07-23T05:02:20.270Z</updated>
    
    <content type="html"><![CDATA[<p>sort 命令对 File 参数指定的文件中的行排序，并将结果写到标准输出。如果 File 参数指定多个文件，那么 sort 命令将这些文件连接起来，并当作一个文件进行排序。</p><p>sort语法</p><p>[root@www ~]# sort [-fbMnrtuk][file or stdin]<br>选项与参数：<br>-f  ：忽略大小写的差异，例如 A 与 a 视为编码相同；<br>-b  ：忽略最前面的空格符部分；<br>-M  ：以月份的名字来排序，例如 JAN, DEC 等等的排序方法；<br>-n  ：使用『纯数字』进行排序(默认是以文字型态来排序的)；<br>-r  ：反向排序；<br>-u  ：就是 uniq ，相同的数据中，仅出现一行代表；<br>-t  ：分隔符，默认是用 [tab] 键来分隔；<br>-k  ：以那个区间 (field) 来进行排序的意思</p><p>对/etc/passwd 的账号进行排序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cat /etc/passwd | sort</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">apache:x:48:48:Apache:/var/www:/sbin/nologin</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure><p>sort 是默认以第一个数据来排序，而且默认是以字符串形式来排序,所以由字母 a 开始升序排序。</p><p>/etc/passwd 内容是以 : 来分隔的，我想以第三栏来排序，该如何</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cat /etc/passwd | sort -t &apos;:&apos; -k 3</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">games:x:12:100:games:/usr/games:/sbin/nologin</span><br></pre></td></tr></table></figure><p>默认是以字符串来排序的，如果想要使用数字排序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd | sort -t &apos;:&apos; -k 3n</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br></pre></td></tr></table></figure><p>默认是升序排序，如果要倒序排序，如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd | sort -t &apos;:&apos; -k 3nr</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">ntp:x:106:113::/home/ntp:/bin/false</span><br><span class="line">messagebus:x:105:109::/var/run/dbus:/bin/false</span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><p>如果要对/etc/passwd,先以第六个域的第2个字符到第4个字符进行正向排序，再基于第一个域进行反向排序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd |  sort -t&apos;:&apos; -k 6.2,6.4 -k 1r      </span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br></pre></td></tr></table></figure><p>查看/etc/passwd有多少个shell:对/etc/passwd的第七个域进行排序，然后去重:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd |  sort -t&apos;:&apos; -k 7 -u</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">syslog:x:101:102::/home/syslog:/bin/false</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br></pre></td></tr></table></figure><h1 id="uniq"><a class="markdownIt-Anchor" href="#uniq"></a> uniq</h1><p>uniq命令可以去除排序过的文件中的重复行，因此uniq经常和sort合用。也就是说，为了使uniq起作用，所有的重复行必须是相邻的。</p><p>uniq语法</p><p>[root@www ~]# uniq [-icu]<br>选项与参数：<br>-i   ：忽略大小写字符的不同；<br>-c  ：进行计数<br>-u  ：只显示唯一的行</p><p>testfile的内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat testfile</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">friend</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">hello</span><br></pre></td></tr></table></figure><p>未经排序的文件，将会发现没有任何行被去重</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">uniq testfile</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">friend</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">hello</span><br></pre></td></tr></table></figure><p>去重之前要进行排序</p><p>排序文件，默认是去重</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat testfile | sort | uniq</span><br><span class="line"></span><br><span class="line">friend</span><br><span class="line">hello</span><br><span class="line">world</span><br></pre></td></tr></table></figure><p>排序之后删除了重复行，同时在行首位置输出该行重复的次数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat testfile | sort | uniq -c</span><br><span class="line"></span><br><span class="line">1 friend</span><br><span class="line">3 hello</span><br><span class="line">2 world</span><br></pre></td></tr></table></figure><p>仅显示存在重复的行，并在行首显示该行重复的次数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sort testfile | uniq -dc</span><br><span class="line"></span><br><span class="line">3 hello</span><br><span class="line">2 world</span><br></pre></td></tr></table></figure><p>仅显示不重复的行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sort testfile | uniq -u</span><br><span class="line">friend</span><br></pre></td></tr></table></figure><h1 id="cut"><a class="markdownIt-Anchor" href="#cut"></a> cut</h1><p>cut命令可以从一个文本文件或者文本流中提取文本列。</p><p>cut语法</p><p>[root@www ~]# cut -d’分隔字符’ -f fields &lt;==用于有特定分隔字符<br>[root@www ~]# cut -c 字符区间            &lt;==用于排列整齐的信息<br>选项与参数：<br>-d  ：后面接分隔字符。与 -f 一起使用；<br>-f  ：依据 -d 的分隔字符将一段信息分割成为数段，用 -f 取出第几段的意思；<br>-c  ：以字符 (characters) 的单位取出固定字符区间；</p><p>PATH 变量如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# echo $PATH</span><br><span class="line">/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/X11R6/bin:/usr/games</span><br><span class="line"></span><br><span class="line">#1 | 2       | 3   | 4       | 5            | 6            | 7</span><br></pre></td></tr></table></figure><p>将 PATH 变量取出，我要找出第五个路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH | cut -d &apos;:&apos; -f 5</span><br><span class="line"></span><br><span class="line">/usr/local/bin</span><br></pre></td></tr></table></figure><p>将 PATH 变量取出，我要找出第三和第五个路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH | cut -d &apos;:&apos; -f 3,5</span><br><span class="line"></span><br><span class="line">/sbin:/usr/local/bin</span><br></pre></td></tr></table></figure><p>将 PATH 变量取出，我要找出第三到最后一个路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH | cut -d &apos;:&apos; -f 3-</span><br><span class="line">/sbin:/usr/sbin:/usr/local/bin:/usr/X11R6/bin:/usr/games</span><br></pre></td></tr></table></figure><p>将 PATH 变量取出，我要找出第一到第三个路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH | cut -d &apos;:&apos; -f 1-3</span><br><span class="line"></span><br><span class="line">/bin:/usr/bin:/sbin:</span><br></pre></td></tr></table></figure><p>将 PATH 变量取出，我要找出第一到第三，还有第五个路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH | cut -d &apos;:&apos; -f 1-3,5</span><br><span class="line">/bin:/usr/bin:/sbin:/usr/local/bin</span><br></pre></td></tr></table></figure><p>实用例子:只显示/etc/passwd的用户和shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd | cut -d &apos;:&apos; -f 1,7</span><br><span class="line"></span><br><span class="line">root:/bin/bash</span><br><span class="line">daemon:/bin/sh</span><br><span class="line">bin:/bin/sh</span><br></pre></td></tr></table></figure><h1 id="wc"><a class="markdownIt-Anchor" href="#wc"></a> wc</h1><p>统计文件里面有多少单词，多少行，多少字符。</p><p>wc语法</p><p>[root@www ~]# wc [-lwm]<br>选项与参数：<br>-l  ：仅列出行；<br>-w  ：仅列出多少字(英文单字)；<br>-m  ：多少字符；</p><p>默认使用wc统计/etc/passwd</p><p>wc /etc/passwd</p><p>40   45 1719 /etc/passwd<br>40是行数，45是单词数，1719是字节数</p><p>wc的命令比较简单使用，每个参数使用如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wc -l /etc/passwd   #统计行数，在对记录数时，很常用</span><br><span class="line"></span><br><span class="line">40 /etc/passwd       #表示系统有40个账户</span><br><span class="line"></span><br><span class="line">wc -w /etc/passwd  #统计单词出现次数</span><br><span class="line"></span><br><span class="line">45 /etc/passwd</span><br><span class="line"></span><br><span class="line">wc -m /etc/passwd  #统计文件的字符数</span><br><span class="line"></span><br><span class="line">1719</span><br></pre></td></tr></table></figure><p>参考 <a href="http://vbird.dic.ksu.edu.tw/linux_basic/0320bash_6.php#pipe_2" target="_blank" rel="noopener">http://vbird.dic.ksu.edu.tw/linux_basic/0320bash_6.php#pipe_2</a></p><pre><code>  http://www.cnblogs.com/stephen-liu74/archive/2011/11/10/2240461.html</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;sort 命令对 File 参数指定的文件中的行排序，并将结果写到标准输出。如果 File 参数指定多个文件，那么 sort 命令将这些文件连接起来，并当作一个文件进行排序。&lt;/p&gt;
&lt;p&gt;sort语法&lt;/p&gt;
&lt;p&gt;[root@www ~]# sort [-fbMnrtu
      
    
    </summary>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>shell编程基础</title>
    <link href="http://yoursite.com/post/6e95fc76.html"/>
    <id>http://yoursite.com/post/6e95fc76.html</id>
    <published>2018-05-06T10:34:02.000Z</published>
    <updated>2018-07-23T05:02:20.288Z</updated>
    
    <content type="html"><![CDATA[<h1 id="什么是shell"><a class="markdownIt-Anchor" href="#什么是shell"></a> 什么是shell</h1><ul><li>Shell是用户与内核进行交互操作的一种接口，目前最流行的Shell称为bashShell</li><li>Shell也是一门编程语言&lt;解释型的编程语言&gt;，即shell脚本</li><li>一个系统可以存在多个shell，可以通过cat /etc/shells命令查看系统中安装的shell，不同的shell可能支持的命令语法是不相同的</li></ul><h1 id="shell脚本的执行方式"><a class="markdownIt-Anchor" href="#shell脚本的执行方式"></a> Shell脚本的执行方式</h1><ul><li>第一种：输入脚本的绝对路径或相对路径</li></ul><p>首先要赋予+x权限</p><p>/root/helloWorld.sh</p><p>./helloWorld.sh</p><p>或者，不用赋予+x权限，而用解释器解释执行</p><p>sh  <a href="http://helloworld.sh" target="_blank" rel="noopener">helloworld.sh</a></p><ul><li><p>第二种：bash或sh +脚本</p><p>sh /root/helloWorld.sh</p><p>sh <a href="http://helloWorld.sh" target="_blank" rel="noopener">helloWorld.sh</a></p></li><li><p>第三种：在脚本的路径前再加&quot;.&quot;</p><p>. /root/helloWorld.sh</p><p>. ./helloWorld.sh</p></li><li><p>区别：第一种和第二种会新开一个bash，不同bash中的变量无法共享</p></li></ul><h1 id="shell中的变量"><a class="markdownIt-Anchor" href="#shell中的变量"></a> Shell中的变量</h1><ul><li><p>LinuxShell中的变量分为“系统变量”和“用户自定义变量”，可以通过set命令查看那系统变量</p></li><li><p>系统变量：$HOME、$PWD、$SHELL、$USER等等</p></li><li><p>显示当前shell中所有变量  :   set</p></li></ul><h1 id="定义变量"><a class="markdownIt-Anchor" href="#定义变量"></a> 定义变量</h1><ul><li>变量＝值 （例如STR=abc）</li><li>等号两侧不能有空格</li><li>变量名称一般习惯为大写</li><li>双引号和单引号有区别，双引号仅将空格、\脱意，单引号会将所有特殊字符脱意</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# x=hello world</span><br><span class="line">-bash: world: command not found</span><br><span class="line"></span><br><span class="line">[root@VM_0_14_centos ~]# x=&quot;hello world&quot;</span><br><span class="line">[root@VM_0_14_centos ~]# echo $x</span><br><span class="line">hello world</span><br><span class="line"></span><br><span class="line">[root@VM_0_14_centos ~]# y=bb</span><br><span class="line">[root@VM_0_14_centos ~]# x=&quot;hello $bb&quot;</span><br><span class="line">[root@VM_0_14_centos ~]# echo $x</span><br><span class="line">hello</span><br><span class="line">[root@VM_0_14_centos ~]# x=&quot;hello $y&quot;</span><br><span class="line">[root@VM_0_14_centos ~]# echo $x</span><br><span class="line">hello bb</span><br><span class="line">[root@VM_0_14_centos ~]# x=&apos;hello $y&apos;</span><br><span class="line">[root@VM_0_14_centos ~]# echo $x</span><br><span class="line">hello $y</span><br></pre></td></tr></table></figure><ul><li><p>A=9 unsetA 撤销变量 A</p></li><li><p>readonly B=2 声明静态的变量B=2 ，不能 unset</p></li><li><p>export变量名可把变量提升为全局环境变量，可供其他shell程序使用</p></li></ul><h1 id="将命令的返回值赋给变量"><a class="markdownIt-Anchor" href="#将命令的返回值赋给变量"></a> 将命令的返回值赋给变量</h1><ul><li>A=`ls -la` 反引号，运行里面的命令，并把结果返回给变量A</li><li>A=$(ls -la) 等价于反引号</li></ul><h1 id="shell中的特殊变量"><a class="markdownIt-Anchor" href="#shell中的特殊变量"></a> Shell中的特殊变量</h1><ul><li>$? 表示上一个命令退出的状态</li><li> 表示当前进程编号</li><li>$n 表示n位置的输入参数（n代表数字，n&gt;=1）</li><li>$#   表示参数的个数，常用于循环</li><li>$*和$@ 都表示参数列表</li></ul><p>*<em>$<em>与$@区别</em></em></p><ul><li>$* 和 $@ 都表示传递给函数或脚本的所有参数，不被双引号&quot;&quot;包含时，都以$1  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mo>…</mo></mrow><annotation encoding="application/x-tex">2  …</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base"><span class="mord">2</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span></span></span></span>n 的形式输出所有参数</li><li>当它们被双引号&quot; “包含时，”$*“会将所有的参数作为一个整体，以”$1$2 … n"的形式输出所有参数；"@“会将各个参数分开，以”$1&quot;“<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi mathvariant="normal">&quot;</mi><mo>…</mo><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">2&quot; … &quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base"><span class="mord">2</span><span class="mord">&quot;</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mord rule" style="margin-right:0.16666666666666666em;"></span><span class="mord">&quot;</span></span></span></span>n” 的形式输出所有参数</li></ul><h1 id="运算符"><a class="markdownIt-Anchor" href="#运算符"></a> 运算符</h1><ul><li>格式 :expr m + n或$((m+n)) <strong>注意expr运算符间要有空格</strong></li><li>例如计算（2 ＋3 ）×4 的值</li></ul><p>1 .分步计算<br>S=`expr 2 + 3`<br>expr $S \* 4</p><p>2.一步完成计算</p><p>expr `expr 2 + 3 ` * 4</p><p>echo `expr \`expr 2 + 3\` \* 4`   # 各种转义太麻烦了</p><p>或</p><p>$(((2+3)*4))</p><h1 id="for循环"><a class="markdownIt-Anchor" href="#for循环"></a> for循环</h1><ul><li><p>第一种：</p><p>for N in 1 2 3</p><p>do</p><p>echo $N</p><p>done</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# for N in 1 2 3</span><br><span class="line">&gt; </span><br><span class="line">&gt; do</span><br><span class="line">&gt; </span><br><span class="line">&gt;   echo $N</span><br><span class="line">&gt; </span><br><span class="line">&gt; done</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>或</p><p>for N in 1 2 3; do echo $N; done</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# for N in 1 2 3; do echo $N; done</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>或</p><p>for N in {1…3}; do echo $N; done</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# for N in &#123;1..3&#125;; do echo $N; done</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>​</p></li><li><p>•第二种：</p><p>for((i = 0;i&lt;= 5; i++))</p><p>do</p><p>echo “welcome $i times”</p><p>done</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# for((i = 0;i&lt;= 5; i++))</span><br><span class="line">&gt; </span><br><span class="line">&gt; do</span><br><span class="line">&gt; </span><br><span class="line">&gt;   echo &quot;welcome $i times&quot;</span><br><span class="line">&gt; </span><br><span class="line">&gt; done</span><br><span class="line">welcome 0 times</span><br><span class="line">welcome 1 times</span><br><span class="line">welcome 2 times</span><br><span class="line">welcome 3 times</span><br><span class="line">welcome 4 times</span><br><span class="line">welcome 5 times</span><br></pre></td></tr></table></figure><p>或</p><p>for((i = 0;i&lt;= 5; i++));do echo “welcome $i times”; done</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# for((i = 0;i&lt;= 5; i++));do echo &quot;welcome $i times&quot;; done</span><br><span class="line">welcome 0 times</span><br><span class="line">welcome 1 times</span><br><span class="line">welcome 2 times</span><br><span class="line">welcome 3 times</span><br><span class="line">welcome 4 times</span><br><span class="line">welcome 5 times</span><br></pre></td></tr></table></figure><p>​</p></li></ul><h1 id="while循环"><a class="markdownIt-Anchor" href="#while循环"></a> while循环</h1><ul><li>第一种</li></ul><p>while expression</p><p>do</p><p>command</p><p>…</p><p>done</p><ul><li><p>第二种</p><p>i=1</p><p>while((i&lt;=3))</p><p>do</p><p>echo $i</p><p>let i++</p><p>done</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# while((i&lt;=3))</span><br><span class="line">&gt; </span><br><span class="line">&gt; do</span><br><span class="line">&gt; </span><br><span class="line">&gt;   echo $i</span><br><span class="line">&gt; </span><br><span class="line">&gt;   let i++</span><br><span class="line">&gt; </span><br><span class="line">&gt; done</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure><h1 id="case语句"><a class="markdownIt-Anchor" href="#case语句"></a> case语句</h1><ul><li>格式</li></ul><p>case $1 in</p><p>start)</p><p>echo “starting”</p><p>;;</p><p>stop)</p><p>echo “stoping”</p><p>;;</p><p>*)</p><p>echo &quot;Usage: {start|stop} “</p><p>esac</p><p>$1 脚本后紧跟第一个参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# vim case.sh</span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">start)</span><br><span class="line">echo &quot;starting&quot;</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line">echo &quot;stoping&quot;</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">echo &quot;Usage: &#123;start|stop&#125; “</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@VM_0_14_centos ~]# chmod 777 case.sh</span><br><span class="line">[root@VM_0_14_centos ~]# ./case.sh start  </span><br><span class="line">starting</span><br></pre></td></tr></table></figure><h1 id="read命令"><a class="markdownIt-Anchor" href="#read命令"></a> read命令</h1><ul><li><p>read-p(提示语句)-n(字符个数) -t(等待时间)</p><p>read -p “please input your name:” NAME</p></li></ul><p>从终端交互式的获取输入参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]#  read -p &quot;please input your name:&quot; n</span><br><span class="line">please input your name:123</span><br><span class="line">[root@VM_0_14_centos ~]# echo $n</span><br><span class="line">123</span><br></pre></td></tr></table></figure><h1 id="if判断"><a class="markdownIt-Anchor" href="#if判断"></a> if判断</h1><ul><li>语法</li></ul><p>if condition<br>then<br>statements<br>[elif condition<br>then statements. …]<br>[else<br>statements ]<br>fi</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">read -p &quot;please input your name:&quot; NAME</span><br><span class="line">#printf &apos;%s\n&apos; $NAME</span><br><span class="line">if [ $NAME = root ]</span><br><span class="line">        then</span><br><span class="line">                echo &quot;hello $&#123;NAME&#125;,  welcome !&quot;</span><br><span class="line">        elif [ $NAME = itcast ]</span><br><span class="line">                then</span><br><span class="line">                        echo &quot;hello $&#123;NAME&#125;,  welcome !&quot;</span><br><span class="line">        else</span><br><span class="line">                echo &quot;SB, get out here !&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>将上面的脚本（<a href="http://hello.sh" target="_blank" rel="noopener">hello.sh</a>）运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# ./hello.sh        </span><br><span class="line">please input your name:root</span><br><span class="line">hello root,  welcome !</span><br></pre></td></tr></table></figure><h1 id="判断语句"><a class="markdownIt-Anchor" href="#判断语句"></a> 判断语句</h1><ul><li>[ condition ] (注意condition前后要有空格)</li></ul><p>#非空返回true，可使用$?验证（0为true，&gt;1为false）</p><p>[ itcast ] 任意有内容的字符串，返回值是0 因此是true</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# [ itcast ]</span><br><span class="line">[root@VM_0_14_centos ~]# echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>#空返回false</p><p>[  ]</p><ul><li><p>[condition ] &amp;&amp; echo OK</p><p>条件满足，执行echo OK</p><p>​</p></li></ul><p>[ condition ] &amp;&amp; echo OK || echo notok</p><p>条件满足，执行echo OK，不满足执行echo notok</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# [ condition ] &amp;&amp; echo OK || echo notok</span><br><span class="line">OK</span><br><span class="line">[root@VM_0_14_centos ~]# [ ] &amp;&amp; echo OK || echo notok</span><br><span class="line">notok</span><br></pre></td></tr></table></figure><p><strong>常用判断条件</strong></p><p>= 字符串比较</p><p>-lt 小于</p><p>-le 小于等于</p><p>-eq 等于</p><p>-gt 大于</p><p>-ge 大于等于</p><p>-ne 不等于</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# [ 3 -lt 2 ]</span><br><span class="line">[root@VM_0_14_centos ~]# echo $?    </span><br><span class="line">1</span><br><span class="line">[root@VM_0_14_centos ~]# [ 3 -gt 3 ]</span><br><span class="line">[root@VM_0_14_centos ~]# echo $?</span><br><span class="line">1</span><br><span class="line">[root@VM_0_14_centos ~]# [ 3 -ge 3 ] </span><br><span class="line">[root@VM_0_14_centos ~]# echo $?    </span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>-r 有读的权限</p><p>-w 有写的权限</p><p>-x 有执行的权限</p><p>-f 文件存在并且是一个常规的文件</p><p>-s 文件存在且不为空</p><p>-d 文件存在并是一个目录</p><p>-b文件存在并且是一个块设备</p><p>-L 文件存在并且是一个链接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# ls</span><br><span class="line">anaconda-ks.cfg  apps  case.sh  hello.sh  h.py  ma6174</span><br><span class="line">[root@VM_0_14_centos ~]# [ -f case.sh ]</span><br><span class="line">[root@VM_0_14_centos ~]# echo $?</span><br><span class="line">0</span><br><span class="line">[root@VM_0_14_centos ~]# [ -w cash.sh ]     ## 没有cash.sh 所以也就没有写的权限</span><br><span class="line">[root@VM_0_14_centos ~]# echo $?</span><br><span class="line">1</span><br><span class="line">[root@VM_0_14_centos ~]# [ -w case.sh ] </span><br><span class="line">[root@VM_0_14_centos ~]# echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure><h1 id="shell自定义函数"><a class="markdownIt-Anchor" href="#shell自定义函数"></a> Shell自定义函数</h1><ul><li>语法</li></ul><p>[ function ] funname [()]</p><p>{</p><p>action;</p><p>[return int;]</p><p>}</p><p>functionstart()  / function start / start()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">      1 #!/bin/bash</span><br><span class="line">      2 fSum 3 2; # fSum还没有定义，因此会报错</span><br><span class="line">      3 function fSum()</span><br><span class="line">      4 &#123;</span><br><span class="line">      5  echo $1,$2</span><br><span class="line">      6  return $(($1+$2));</span><br><span class="line">      7 &#125;</span><br><span class="line">      8 total=$?;</span><br><span class="line">      9 echo &quot;第一次调用后的返回结果：&quot;$total</span><br><span class="line">     10 fSum 5 7;</span><br><span class="line">     11 total=$?;          # total获得了函数返回值即return的值12</span><br><span class="line">     12 echo $total,$?;</span><br><span class="line">     </span><br><span class="line">[root@VM_0_14_centos ~]# ./hello.sh </span><br><span class="line">./hello.sh: line 2: fSum: command not found</span><br><span class="line">第一次调用后的返回结果：0</span><br><span class="line">5,7</span><br><span class="line">12,0</span><br></pre></td></tr></table></figure><ul><li>注意</li></ul><p>1.必须在调用函数地方之前，先声明函数，shell脚本是逐行运行。不会像其它语言一样先预编译</p><p>2.函数返回值，只能通过$? 系统变量获得，可以显示加：return返回，如果不加，将以最后一条命令运行结果，作为返回值。return后跟数值n(0-255)</p><h1 id="脚本调试"><a class="markdownIt-Anchor" href="#脚本调试"></a> 脚本调试</h1><ul><li>sh -vx <a href="http://helloWorld.sh" target="_blank" rel="noopener">helloWorld.sh</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# sh -vx ./hello.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">fSum 3 2;</span><br><span class="line">+ fSum 3 2</span><br><span class="line">./hello.sh: line 2: fSum: command not found</span><br><span class="line">function fSum()</span><br><span class="line">&#123;</span><br><span class="line"> echo $1,$2</span><br><span class="line"> return $(($1+$2));</span><br><span class="line">&#125;</span><br><span class="line">total=$?;</span><br><span class="line">+ total=0</span><br><span class="line">echo &quot;第一次调用后的返回结果：&quot;$total</span><br><span class="line">+ echo $&apos;\347\254\254\344\270\200\346\254\241\350\260\203\347\224\250\345\220\216\347\232\204\350\277\224\345\233\236\347\273\223\346\236\234\357\274\2320&apos;</span><br><span class="line">第一次调用后的返回结果：0</span><br><span class="line">fSum 5 7;</span><br><span class="line">+ fSum 5 7</span><br><span class="line">+ echo 5,7</span><br><span class="line">5,7</span><br><span class="line">+ return 12</span><br><span class="line">total=$?;</span><br><span class="line">+ total=12</span><br><span class="line">echo $total,$?;</span><br><span class="line">+ echo 12,0</span><br><span class="line">12,0</span><br></pre></td></tr></table></figure><ul><li>或者在脚本中增加set -x</li></ul><h1 id="sed命令"><a class="markdownIt-Anchor" href="#sed命令"></a> sed命令</h1><ul><li>sed全称是：Stream EDitor即流编辑器，是一个很好的文本处理工具，本身是一个管道命令，处理时，把当前处理的行存储在临时缓冲区中，接着用sed命令处理缓冲区中的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行。它是以行为单位进行处理，可以将数据行进行替换、删除、新增、选取等特定工作。</li></ul><p><strong>sed选项</strong></p><ul><li>-n ：使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN 的数据一般都会被列出到终端上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。</li><li>-e ：直接在命令列模式上进行 sed 的动作编辑；</li><li>-i ：直接修改读取的文件内容，而不是输出到终端。</li></ul><p>sed function</p><ul><li>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)</li><li>d ：删除，因为是删除啊，所以 d 后面通常不接任何内容</li><li>i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)</li><li>p ：列印，亦即将某个选择的数据印出。通常 p 会与参数 sed-n 一起运行</li><li>s ：取代，可以直接进行取代的工作！通常这个 s 的动作可以搭配正规表示法！例如1,20s/old/new/g</li></ul><h1 id="awk命令"><a class="markdownIt-Anchor" href="#awk命令"></a> awk命令</h1><ul><li>AWK是一种优良的文本处理工具。其名称得自于它的创始人 Alfred</li></ul><p>Aho 、Peter<br>Weinberger 和 Brian<br>Kernighan 姓氏的首个字母，AWK 提供了极其强大的功能：可以进行样式装入、流控制、数学运算符、进程控制语句甚至于内置的变量和函数。它具备了一个完整的语言所应具有的几乎所有精美特性。实际上<br>AWK 的确拥有自己的语言：AWK 程序设计语言，<br>三位创建者已将它正式定义为“样式扫描和处理语言”。它允许您创建简短的程序，这些程序读取输入文件、为数据排序、处理数据、对输入执行计算以及生成报表，还有无数其他的功能。</p><p><strong>awk命令格式</strong></p><p>awk<br>‘pattern1 {action1} pattern2 {action2} …’ filename</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;什么是shell&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#什么是shell&quot;&gt;&lt;/a&gt; 什么是shell&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Shell是用户与内核进行交互操作的一种接口，目前最流行的Shell称为bashShell&lt;/l
      
    
    </summary>
    
    
      <category term="大数据 linux" scheme="http://yoursite.com/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE-linux/"/>
    
  </entry>
  
  <entry>
    <title>linux一些基本软件的安装</title>
    <link href="http://yoursite.com/post/3f5ed2df.html"/>
    <id>http://yoursite.com/post/3f5ed2df.html</id>
    <published>2018-05-06T07:41:25.000Z</published>
    <updated>2018-07-23T05:02:20.268Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>大数据1：虚拟机配置及基本的linux命令</title>
    <link href="http://yoursite.com/post/9e6c268c.html"/>
    <id>http://yoursite.com/post/9e6c268c.html</id>
    <published>2018-05-06T01:55:47.000Z</published>
    <updated>2018-07-23T05:02:20.297Z</updated>
    
    <content type="html"><![CDATA[<h1 id="linux中的文件夹"><a class="markdownIt-Anchor" href="#linux中的文件夹"></a> linux中的文件夹</h1><ul><li><p>boot 存放用于系统引导时使用的各种文件</p></li><li><p>dev 设备</p></li><li><p>etc   (etcetera)存放系统配置文件，约定俗成配置文件放在该文件夹下，所有的配置文件都在该文件夹下。</p></li><li><p>home 用户目录 root用户有单独的root目录。</p></li><li><p>lib 头文件、动态链接库等c语言文件，各种软件是开源的，各种软件依赖不一样，很混乱，系统中搞一个库，大家都用到的库放在里面，软件就不用再带自己的库了。windows库是官方提供只有一套。</p></li></ul><p>​       在linux下安装软件很麻烦，安装a可能提示缺少b，再安装b，又提示缺少c… java中有maven，linux下有yum，提供一个中央仓库，自动安装相关依赖。</p><ul><li>media 外部的媒体，如光盘文件等，光驱、usb挂载。</li><li>usr (unix shared resources)，Unix共享资源，linux服务器系统，很多人用，可以把大家都用的软件放在该文件夹下。</li><li>sbin (superuser binaries)存放二进制可执行文件，只有root才能访问，系统管理的程序</li><li>bin (binaries)存放二进制可执行文件，普通管理程序</li><li>temp 临时目录</li><li>mnt  (mount)系统管理员安装临时文件系统的安装点</li><li>var  (variable)用于存放运行时需要改变数据的文件</li></ul><h1 id="网络配置"><a class="markdownIt-Anchor" href="#网络配置"></a> 网络配置</h1><p>子网掩码 属于哪个网段</p><p>IP 192.168.33.2</p><p>掩码 255.255.255.0</p><p>255全是8位二进制1， ip和子网掩码进行与操作，变成192.168.33.0，得到网段。</p><p>网关 网络总出口，路由器ip地址</p><p>dns 域名解析服务器</p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fr1fabi7exj20jt0cpq33.jpg" alt=""></p><p>主机名比ip好记，但无法直接ping，肯定不用直接再申请个域名，只要在各服务器上配置下hosts文件，加入主机名与相对应的ip即可。</p><p>如经常用的localhost，就是系统已经存在的hosts文件当中的一个与ip地址127.0.0.1的对应。</p><p>vm有虚拟网卡 vmnet8</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fr1gdjprqpj20x40l80tr.jpg" alt=""></p><h1 id="linux常用命令操作"><a class="markdownIt-Anchor" href="#linux常用命令操作"></a> linux常用命令操作</h1><p>1、日常操作命令</p><p>**查看当前所在的工作目录<br>pwd</p><p>**查看当前系统的时间<br>date</p><p>**查看有谁在线（哪些人登陆到了服务器）<br>who  查看当前在线<br>last 查看最近的登陆历史记录</p><p>2、文件系统操作<br>**<br>ls /    查看根目录下的子节点（文件夹和文件）信息<br>ls -al  -a是显示隐藏文件   -l是以更详细的列表形式显示</p><p>**切换目录<br>cd  /home</p><p>**创建文件夹<br>mkdir aaa     这是相对路径的写法<br>mkdir -p aaa/bbb/ccc<br>mkdir  /data    这是绝对路径的写法</p><p>**删除文件夹<br>rmdir   可以删除空目录<br>rm -r aaa   可以把aaa整个文件夹及其中的所有子节点全部删除，但是会有提示<br>rm -rf aaa   强制删除aaa，没有提示</p><p>**修改文件夹名称<br>mv aaa angelababy</p><p>**创建文件<br>touch  somefile.1   创建一个空文件</p><p>echo “i miss you”  在命令行输出该句</p><p>echo “i miss you” &gt; somefile.2  利用重定向“&gt;”的功能，将一条指令的输出结果写入到一个文件中，会覆盖原文件内容</p><p>echo “huang” &gt;&gt; somefile.2     将一条指令的输出结果追加到一个文件中，不会覆盖原文件内容</p><p>用vi文本编辑器来编辑生成文件<br>******最基本用法<br>vi  somefile.4<br>1、首先会进入“一般模式”，此模式只接受各种快捷键，不能编辑文件内容<br>2、按i键，就会从一般模式进入编辑模式，此模式下，敲入的都是文件内容<br>3、编辑完成之后，按Esc键退出编辑模式，回到一般模式；<br>4、再按：，进入“底行命令模式”，输入wq命令，回车即可</p><p>******一些常用快捷键<br>一些有用的快捷键（在一般模式下使用）：<br>a  在光标后一位开始插入<br>A   在该行的最后插入<br>I   在该行的最前面插入<br>gg   直接跳到文件的首行<br>G    直接跳到文件的末行<br>dd   删除行，如果  5dd   ，则一次性删除光标后的5行<br>yy  复制当前行,  复制多行，则  3yy，则复制当前行附近的3行<br>p   粘贴<br>v  进入字符选择模式，选择完成后，按y复制，按p粘贴<br>ctrl+v  进入块选择模式，选择完成后，按y复制，按p粘贴<br>shift+v  进入行选择模式，选择完成后，按y复制，按p粘贴</p><p>查找并替换（在底行命令模式中输入）<br>%s/sad/88888888888888     效果：查找文件中所有sad，替换为88888888888888<br>/you       效果：查找文件中出现的you，并定位到第一个找到的地方，按n可以定位到下一个匹配位置（按N定位到上一个）</p><p>*****拷贝文件</p><p>不写名字还是原来的名字</p><p>cp  somefile.1   /home/hadoop/</p><p>***查看文件内容<br>cat    somefile    一次性将文件内容全部输出（控制台）<br>more   somefile     可以翻页查看, 下翻一页(空格)    上翻一页（b）   退出（q）<br>less   somefile      可以翻页查看,下翻一页(空格)    上翻一页（b），上翻一行(↑)  下翻一行（↓）  可以搜索关键字，敲/，然后输入关键字即可（/keyword）</p><p>tail -10  install.log   查看文件尾部的10行 查看日志文件很有用</p><p>下面两个命令查看实时最新效果：</p><p>tail -f install.log    小f跟踪文件的唯一inode号，就算文件改名后，还是跟踪原来这个inode表示的文件<br>tail -F install.log    大F按照文件名来跟踪</p><p>head -10  install.log   查看文件头部的10行 用来</p><p>3、文件权限的操作</p><p>****linux文件权限的描述格式解读<br>drwxr-xr-x      （也可以用二进制表示  111 101 101  --&gt;  755）</p><p>d：标识节点类型（d：文件夹   -：文件  l:链接）<br>r：可读   w：可写    x：可执行<br>第一组rwx：  表示这个文件的拥有者对它的权限：可读可写可执行<br>第二组r-x：  表示这个文件的所属组对它的权限：可读，不可写，可执行<br>第三组r-x：  表示这个文件的其他用户（相对于上面两类用户）对它的权限：可读，不可写，可执行</p><p>****修改文件权限<br>chmod g-rw haha.dat    表示将haha.dat对所属组的rw权限取消<br>chmod o-rw haha.dat 表示将haha.dat对其他人的rw权限取消<br>chmod u+x haha.dat      表示将haha.dat对所属用户的权限增加x</p><p>也可以用数字的方式来修改权限<br>chmod 664 haha.dat<br>就会修改成   rw-rw-r–</p><p>如果要将一个文件夹的所有内容权限统一修改，则可以-R参数<br>chmod -R 770 aaa/<br>chown angela:angela aaa/    &lt;只有root能执行&gt;</p><p>目录没有执行权限的时候普通用户不能进入<br>文件只有读写权限的时候普通用户是可以删除的(删除文件不是修改它,是操作父及目录),只要父级目录有执行和修改的权限</p><p>4、基本的用户管理</p><p>*****添加用户<br>useradd  angela<br>要修改密码才能登陆<br>passwd angela  按提示输入密码即可</p><p>**为用户配置sudo权限<br>用root编辑 vi /etc/sudoers<br>在文件的如下位置，为hadoop添加一行即可<br>root    ALL=(ALL)       ALL<br>hadoop  ALL=(ALL)       ALL</p><p>然后，hadoop用户就可以用sudo来执行系统级别的指令<br>[hadoop@shizhan ~]$ sudo useradd huangxiaoming</p><p>5、系统管理操作<br>*****查看主机名<br>hostname<br>****修改主机名(重启后无效)<br>hostname hadoop</p><p>*****修改主机名(重启后永久生效)<br>vi /ect/sysconfig/network<br>****修改IP(重启后无效)<br>ifconfig eth0 192.168.12.22</p><p>****修改IP(重启后永久生效)<br>vi /etc/sysconfig/network-scripts/ifcfg-eth0</p><p>mount ****  挂载外部存储设备到文件系统中<br>mkdir   /mnt/cdrom      创建一个目录，用来挂载<br>mount -t iso9660 -o ro /dev/cdrom /mnt/cdrom/     将设备/dev/cdrom挂载到 挂载点 ：  /mnt/cdrom中</p><p>*****umount<br>umount /mnt/cdrom</p><p>*****统计文件或文件夹的大小<br>du -sh  /mnt/cdrom/Packages<br>df -h    查看磁盘的空间<br>****关机<br>halt<br>****重启<br>reboot</p><p>******配置主机之间的免密ssh登陆</p><p>ssh协议</p><p>远程登录的安全外壳协议</p><p>有两种身份验证机制：</p><p>1.用户名+密码验证</p><p>2.密钥验证</p><p>ssh 192.168.88.137 登陆该ip主机 需要输入密码</p><p>exit退出</p><p>scp 远程复制 hell.c 本机文件 <a href="mailto:root@192.168.88.137" target="_blank" rel="noopener">root@192.168.88.137</a> 远程主机名和用户名 ：后面跟要复制到的远程主机目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mini1 ~]# scp hell.c root@192.168.88.137:/home</span><br><span class="line">hell.c                                        100%   58    58.4KB/s   00:00</span><br></pre></td></tr></table></figure><p>免密码登陆，就用密钥</p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fr1ketd5pnj20vm0ft3z2.jpg" alt=""></p><p>假如 A  要登陆  B<br>在A上操作：<br>首先生成密钥对<br>ssh-keygen   (提示时，一直按回车即可)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2zea3hsm44dztx9vqa11Z ~]# ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br><span class="line">/root/.ssh/id_rsa already exists.</span><br><span class="line">Overwrite (y/n)? y</span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">5f:14:1c:2f:9b:6c:05:2e:31:d4:17:a4:19:d0:18:d3 root@iZ2zea3hsm44dztx9vqa11Z</span><br><span class="line">The key's randomart image is:</span><br><span class="line">+--[ RSA 2048]----+</span><br><span class="line">|         .BO=oo. |</span><br><span class="line">|          .=EB.  |</span><br><span class="line">|          . *.o  |</span><br><span class="line">|           + =   |</span><br><span class="line">|        S   *    |</span><br><span class="line">|         . o     |</span><br><span class="line">|          .      |</span><br><span class="line">|                 |</span><br><span class="line">|                 |</span><br><span class="line">+-----------------+</span><br><span class="line">[root@iZ2zea3hsm44dztx9vqa11Z ~]#</span><br></pre></td></tr></table></figure><p>再将A自己的公钥拷贝并追加到B的授权列表文件authorized_keys中<br>ssh-copy-id   B</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2zea3hsm44dztx9vqa11Z ~]# ssh-copy-id 58.87.97.204</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span><br><span class="line">root@58.87.97.204's password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   "ssh '58.87.97.204'"</span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br></pre></td></tr></table></figure><p>然后就可以免密登陆了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2zea3hsm44dztx9vqa11Z ~]# ssh 58.87.97.204</span><br><span class="line">Last failed login: Sun May  6 13:54:38 CST 2018 from 59.45.175.29 on ssh:notty</span><br><span class="line">There were 178 failed login attempts since the last successful login.</span><br><span class="line">Last login: Sun May  6 13:48:51 2018 from 47.93.36.67</span><br><span class="line">[root@VM_0_14_centos ~]#</span><br></pre></td></tr></table></figure><p>同理，配置B登陆A时一样的步骤再走一遍，在B上生成密钥，拷贝个A。</p><p>而在登陆阿里云主机时遇到以下问题：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">27:7a:b8:fb:97:04:6f:06:7a:3a:20:3c:52:40:a8:21 root@VM_0_14_centos</span><br><span class="line">The key&apos;s randomart image is:</span><br><span class="line">+--[ RSA 2048]----+</span><br><span class="line">|o.               |</span><br><span class="line">|E                |</span><br><span class="line">|oo               |</span><br><span class="line">|. .     o        |</span><br><span class="line">| o     .S+.      |</span><br><span class="line">|. + . .o.o=      |</span><br><span class="line">| . o .oo.+ .     |</span><br><span class="line">|      oo  o      |</span><br><span class="line">|      o+..       |</span><br><span class="line">+-----------------+</span><br><span class="line"></span><br><span class="line">[root@VM_0_14_centos ~]# ssh-copy-id 47.93.36.67</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span><br><span class="line">Permission denied (publickey,gssapi-keyex,gssapi-with-mic).</span><br></pre></td></tr></table></figure><p>需要配置阿里云上的文件：</p><p>vi /etc/ssh/sshd_config</p><p>下面这项为yes</p><p>PasswordAuthentication yes</p><p>PermitRootLogin也设为yes</p><p>设置文件和目录权限：</p><p>root的.ssh下</p><p>设置authorized_keys权限<br>$ chmod 600 authorized_keys</p><p>root下</p><p>设置.ssh目录权限<br>$ chmod 700 -R .ssh</p><p>如果其他用户，要在其他用户文件夹下设置</p><p>重启sshd服务</p><p>systemctl restart sshd.service</p><h6 id="ecs服务器ssh登录提示permission-denied-please-try-again"><a class="markdownIt-Anchor" href="#ecs服务器ssh登录提示permission-denied-please-try-again"></a> ECS服务器ssh登录提示“Permission denied, please try again”</h6><p>​               <strong>不用怀疑，一般情况下，就是你密码输入错误了。</strong></p><ul><li><strong>解决：</strong></li></ul><p>​               <strong>找到正确的密码输入。</strong></p><p>当然，也有可能是下面的情况：</p><p>在Windows中使用ssh客户端连接，提示“ssh服务器拒绝了密码，请再试一次”，或者在linux中通过ssh连接，提示“Permission denied, please try again”时，可尝试使用以下方式修复：</p><p>1、在ssh提示上述信息时，可以在管理控制台通过Web VNC连接管理终端连接服务器进行测试，如果使用root和密码可以登录，说明帐号与密码是正确的。</p><p>2、检查/etc/ssh/sshd_config中的PermitRootLogin，该参数指定是否允许root用户通过ssh远程连接服务器。PermitRootLogin设置yes时表示允许root通过ssh连接服务器，为no时为不允许。</p><p><img src="http://img01.taobaocdn.com/tfscom/TB1cCUEHXXXXXcKXFXXXXXXXXXX.jpg" alt="QQ糿20150212142405.jpg"></p><p>一般ssh密码错误，同时Web VNC可以登录的问题，此参数的设置引起问题的可能性比较大。</p><p>具体调整：</p><p>(1) 使用命令vi  /etc/ssh/sshd_config；</p><p>注意:vi后面有空格，再加上后面的文件名</p><p>(2) 按&quot;/&quot;键后进入搜索模式，输入PermitRootLogin后回车(注意是有大写的)，可以查找到该参数；</p><p>(3) 按&quot;a&quot;或&quot;i&quot;键可以进入编辑，将其修改为yes，即为允许root通过ssh进行连接；</p><p>(4) 按&quot;Esc&quot;键可以退出编辑，最后输入&quot; :wq！&quot;(包含冒号)，回车进行保存退出。(如果不保存，可以使用&quot; :q！&quot;回车)</p><p>(5) 然后重启sshd服务生效即可，重启命令可以使用:service sshd restart 。</p><p>******后台服务管理<br>service network status   查看指定服务的状态<br>service network stop     停止指定服务<br>service network start    启动指定服务<br>service network restart  重启指定服务<br>service --status-all  查看系统中所有的后台服务</p><p>设置后台服务的自启配置<br>chkconfig   查看所有服务器自启配置<br>chkconfig iptables off   关掉指定服务的自动启动<br>chkconfig iptables on   开启指定服务的自动启动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_14_centos ~]# chkconfig  </span><br><span class="line"></span><br><span class="line">Note: This output shows SysV services only and does not include native</span><br><span class="line">      systemd services. SysV configuration data might be overridden by native</span><br><span class="line">      systemd configuration.</span><br><span class="line"></span><br><span class="line">      If you want to list systemd services use &apos;systemctl list-unit-files&apos;.</span><br><span class="line">      To see services enabled on particular target use</span><br><span class="line">      &apos;systemctl list-dependencies [target]&apos;.</span><br><span class="line"></span><br><span class="line">YDService       0:off   1:off   2:on    3:on    4:on    5:on    6:off</span><br><span class="line">netconsole      0:off   1:off   2:off   3:off   4:off   5:off   6:off</span><br><span class="line">network         0:off   1:off   2:on    3:on    4:on    5:on    6:off</span><br></pre></td></tr></table></figure><p>***系统启动级别管理<br>vi  /etc/inittab</p><p>Default runlevel. The runlevels used are:</p><p>0 - halt (Do NOT set initdefault to this) # 关机</p><p>1 - Single user mode</p><p>2 - Multiuser, without NFS (The same as 3, if you do not have networking)</p><p>3 - Full multiuser mode # 全功能多用户模式</p><p>4 - unused</p><p>5 - X11 # 图形化界面</p><p>6 - reboot (Do NOT set initdefault to this) #重启</p><p>id:3:initdefault:</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;linux中的文件夹&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#linux中的文件夹&quot;&gt;&lt;/a&gt; linux中的文件夹&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;boot 存放用于系统引导时使用的各种文件&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;
      
    
    </summary>
    
    
      <category term="大数据" scheme="http://yoursite.com/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
  </entry>
  
  <entry>
    <title>R语言再基础</title>
    <link href="http://yoursite.com/post/52c64aaf.html"/>
    <id>http://yoursite.com/post/52c64aaf.html</id>
    <published>2018-05-05T07:59:49.000Z</published>
    <updated>2018-07-23T05:02:20.261Z</updated>
    
    <content type="html"><![CDATA[<h1 id="r语言基础数据结构"><a class="markdownIt-Anchor" href="#r语言基础数据结构"></a> R语言基础数据结构</h1><p>基本数据类型：向量、数组、列表</p><p>向量是最基本的，被称为原子型</p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fr0j5se574j20hc09p403.jpg" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 向量</span></span><br><span class="line"></span><br><span class="line">var1 &lt;- c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>) <span class="comment"># 字符型</span></span><br><span class="line">var2 &lt;- c(<span class="number">21</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">54</span>, <span class="number">32</span>) <span class="comment"># 数值型</span></span><br><span class="line">var3 &lt;- c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">FALSE</span>) <span class="comment"># 逻辑型</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 几种快速生成目标向量的快捷方式</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>:<span class="number">10</span> <span class="comment"># 连续整数序列</span></span><br><span class="line"></span><br><span class="line">rep(<span class="number">1</span>:<span class="number">3</span>, each = <span class="number">4</span>) <span class="comment"># 按照单个序列每一个元素重复指定次数</span></span><br><span class="line">rep(<span class="number">1</span>:<span class="number">3</span>, times = <span class="number">4</span>) <span class="comment"># 按照单个序列每一个元素重复指定次数</span></span><br><span class="line"></span><br><span class="line">seq(from = <span class="number">1</span>, to = <span class="number">100</span>, by = <span class="number">5</span>) <span class="comment"># 起点-终点-间隔</span></span><br><span class="line">seq(from = <span class="number">1</span>, by = <span class="number">5</span>, length = <span class="number">20</span>) <span class="comment"># 起点-间隔-长度</span></span><br><span class="line">seq(to = <span class="number">100</span>, by = <span class="number">5</span>, length = <span class="number">20</span>) <span class="comment"># 终点-间隔-长度</span></span><br><span class="line"></span><br><span class="line">rev(<span class="number">1</span>:<span class="number">5</span>) <span class="comment">#次序颠倒</span></span><br><span class="line"></span><br><span class="line">letters <span class="comment"># 内置小写字母字符串对象</span></span><br><span class="line">LETTERS <span class="comment"># 内置大写字母字符串对象</span></span><br><span class="line"></span><br><span class="line">sample(<span class="number">1</span>:<span class="number">10</span>, size = <span class="number">10</span>, replace = <span class="literal">FALSE</span>) <span class="comment"># 可放回抽样</span></span><br><span class="line">sample(<span class="number">1</span>:<span class="number">10</span>, size = <span class="number">10</span>, replace = <span class="literal">TRUE</span>) <span class="comment"># 不放回抽样</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在R语言中快速生成百分比</span></span><br><span class="line"></span><br><span class="line">sprintf(<span class="string">"%.2f%%"</span>, <span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line">sca::percent(seq(<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0.01</span>), d=<span class="number">2</span>, sep=<span class="string">""</span>)</span><br><span class="line">scales::percent(runif(<span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 矩阵</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># byrow 是否按行排列</span></span><br><span class="line">martx1 &lt;- matrix(<span class="number">1</span>:<span class="number">40</span>, nrow = <span class="number">8</span>, byrow = <span class="literal">FALSE</span>);martx1</span><br><span class="line">martx2 &lt;- matrix(<span class="number">1</span>:<span class="number">40</span>, nrow = <span class="number">8</span>, byrow = <span class="literal">TRUE</span>);martx2</span><br><span class="line">martx3 &lt;- matrix(<span class="number">1</span>:<span class="number">40</span>, ncol = <span class="number">8</span>, byrow = <span class="literal">FALSE</span>);martx3</span><br><span class="line">martx4 &lt;- matrix(<span class="number">1</span>:<span class="number">40</span>, ncol = <span class="number">8</span>, byrow = <span class="literal">TRUE</span>);martx4</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#dim参数长度为2时，输出结果即为矩阵（矩阵即时数字的二维呈现）</span></span><br><span class="line">array(<span class="number">1</span>:<span class="number">100</span>, dim = c(<span class="number">10</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># dim参数是一个数字向量，分别为行-列-第三维度</span></span><br><span class="line">array(<span class="number">1</span>:<span class="number">100</span>, dim = c(<span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>结果:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&gt; array(1:100, dim = c(4, 5, 5))</span><br><span class="line">, , 1</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]    1    5    9   13   17</span><br><span class="line">[2,]    2    6   10   14   18</span><br><span class="line">[3,]    3    7   11   15   19</span><br><span class="line">[4,]    4    8   12   16   20</span><br><span class="line"></span><br><span class="line">, , 2</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]   21   25   29   33   37</span><br><span class="line">[2,]   22   26   30   34   38</span><br><span class="line">[3,]   23   27   31   35   39</span><br><span class="line">[4,]   24   28   32   36   40</span><br><span class="line"></span><br><span class="line">, , 3</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]   41   45   49   53   57</span><br><span class="line">[2,]   42   46   50   54   58</span><br><span class="line">[3,]   43   47   51   55   59</span><br><span class="line">[4,]   44   48   52   56   60</span><br><span class="line"></span><br><span class="line">, , 4</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]   61   65   69   73   77</span><br><span class="line">[2,]   62   66   70   74   78</span><br><span class="line">[3,]   63   67   71   75   79</span><br><span class="line">[4,]   64   68   72   76   80</span><br><span class="line"></span><br><span class="line">, , 5</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]   81   85   89   93   97</span><br><span class="line">[2,]   82   86   90   94   98</span><br><span class="line">[3,]   83   87   91   95   99</span><br><span class="line">[4,]   84   88   92   96  100</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 数据框</span><br><span class="line">mydata1 &lt;- data.frame(</span><br><span class="line">  name1 = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;),</span><br><span class="line">  name2 = c(21, 34, 56, 54, 32),</span><br><span class="line">  name3 = c(TRUE, FALSE, TRUE, FALSE, FALSE)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; mydata1</span><br><span class="line">  name1 name2 name3</span><br><span class="line">1     A    21  TRUE</span><br><span class="line">2     B    34 FALSE</span><br><span class="line">3     C    56  TRUE</span><br><span class="line">4     D    54 FALSE</span><br><span class="line">5     E    32 FALSE</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表</span></span><br><span class="line"></span><br><span class="line">mylist &lt;- list(</span><br><span class="line">  object1 = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">  object2 = matrix(<span class="number">1</span>:<span class="number">20</span>, nrow = <span class="number">4</span>, byrow = <span class="literal">FALSE</span>),</span><br><span class="line">  object3 = array(<span class="number">1</span>:<span class="number">27</span>, dim = c(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>)),</span><br><span class="line">  object4 = data.frame(</span><br><span class="line">    name1 = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">    name2 = c(<span class="number">21</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">54</span>, <span class="number">32</span>),</span><br><span class="line">    name3 = c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">FALSE</span>)</span><br><span class="line">  )</span><br><span class="line">)</span><br><span class="line">mylist</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&gt; mylist</span><br><span class="line">$object1</span><br><span class="line">[1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;</span><br><span class="line"></span><br><span class="line">$object2</span><br><span class="line">     [,1] [,2] [,3] [,4] [,5]</span><br><span class="line">[1,]    1    5    9   13   17</span><br><span class="line">[2,]    2    6   10   14   18</span><br><span class="line">[3,]    3    7   11   15   19</span><br><span class="line">[4,]    4    8   12   16   20</span><br><span class="line"></span><br><span class="line">$object3</span><br><span class="line">, , 1</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]    1    4    7</span><br><span class="line">[2,]    2    5    8</span><br><span class="line">[3,]    3    6    9</span><br><span class="line"></span><br><span class="line">, , 2</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]   10   13   16</span><br><span class="line">[2,]   11   14   17</span><br><span class="line">[3,]   12   15   18</span><br><span class="line"></span><br><span class="line">, , 3</span><br><span class="line"></span><br><span class="line">     [,1] [,2] [,3]</span><br><span class="line">[1,]   19   22   25</span><br><span class="line">[2,]   20   23   26</span><br><span class="line">[3,]   21   24   27</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$object4</span><br><span class="line">  name1 name2 name3</span><br><span class="line">1     A    21  TRUE</span><br><span class="line">2     B    34 FALSE</span><br><span class="line">3     C    56  TRUE</span><br><span class="line">4     D    54 FALSE</span><br><span class="line">5     E    32 FALSE</span><br></pre></td></tr></table></figure><h1 id="变量格式转换与因子变量"><a class="markdownIt-Anchor" href="#变量格式转换与因子变量"></a> 变量格式转换与因子变量</h1><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fr0kpfvabqj20ne0bmgpw.jpg" alt=""></p><p>因子变量</p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fr0kun9g6ej20n40bdtav.jpg" alt=""></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var1 &lt;- c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>)</span><br><span class="line">&gt; typeof(var1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"character"</span></span><br><span class="line">&gt; mode(var1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"character"</span></span><br><span class="line">&gt; class(var1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"character"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; var2 &lt;- c(<span class="number">21</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">54</span>, <span class="number">32</span>)</span><br><span class="line">&gt; typeof(var2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"double"</span></span><br><span class="line">&gt; mode(var2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(var2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; var21 &lt;- c(<span class="number">21.5</span>, <span class="number">34.6</span>, <span class="number">56.3</span>, <span class="number">54.9</span>, <span class="number">3.2</span>)</span><br><span class="line">&gt; typeof(var21)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"double"</span></span><br><span class="line">&gt; mode(var21)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(var21)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; var22 &lt;- c(<span class="number">21L</span>, <span class="number">34L</span>, <span class="number">56L</span>, <span class="number">54L</span>, <span class="number">32L</span>)</span><br><span class="line">&gt; typeof(var22)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br><span class="line">&gt; mode(var22)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(var22)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; martx1 &lt;- matrix(<span class="number">1</span>:<span class="number">40</span>, nrow = <span class="number">8</span>, byrow = <span class="literal">FALSE</span>)</span><br><span class="line">&gt; typeof(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br><span class="line">&gt; mode(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"matrix"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用is._函数查看独享符合的类型</span></span><br><span class="line">&gt; is.integer(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br><span class="line">&gt; is.numeric(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br><span class="line">&gt; is.matrix(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br><span class="line">&gt; is.array(martx1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转为向量</span></span><br><span class="line">&gt; as.numeric(martx1)</span><br><span class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">24</span> <span class="number">25</span> <span class="number">26</span> <span class="number">27</span></span><br><span class="line">[<span class="number">28</span>] <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">32</span> <span class="number">33</span> <span class="number">34</span> <span class="number">35</span> <span class="number">36</span> <span class="number">37</span> <span class="number">38</span> <span class="number">39</span> <span class="number">40</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; mydata1 &lt;- data.frame(</span><br><span class="line">+     name1 = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">+     name2 = c(<span class="number">21</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">54</span>, <span class="number">32</span>),</span><br><span class="line">+     name3 = c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">FALSE</span>)</span><br><span class="line">+ )</span><br><span class="line">&gt; typeof(mydata1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"list"</span></span><br><span class="line">&gt; mode(mydata1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"list"</span></span><br><span class="line">&gt; class(mydata1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></span><br><span class="line">&gt; is.list(mydata1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br><span class="line">&gt; is.data.frame(mydata1)</span><br><span class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; myarray1 &lt;- array(<span class="number">1</span>:<span class="number">100</span>, dim=c(<span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">&gt; typeof(myarray1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br><span class="line">&gt; mode(myarray1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(myarray1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"array"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; mylist &lt;- list(</span><br><span class="line">+     object1 = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">+     object2 = matrix(<span class="number">1</span>:<span class="number">20</span>, nrow = <span class="number">4</span>, byrow = <span class="literal">FALSE</span>),</span><br><span class="line">+     object3 = array(<span class="number">1</span>:<span class="number">27</span>, dim = c(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>)),</span><br><span class="line">+     object4 = data.frame(</span><br><span class="line">+         name1 = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">+         name2 = c(<span class="number">21</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">54</span>, <span class="number">32</span>),</span><br><span class="line">+         name3 = c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">FALSE</span>)</span><br><span class="line">+     )</span><br><span class="line">+ )</span><br><span class="line">&gt; typeof(mylist)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"list"</span></span><br><span class="line">&gt; mode(mylist)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"list"</span></span><br><span class="line">&gt; class(mylist)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"list"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; fact1 &lt;- factor(</span><br><span class="line">+     x = rep(LETTERS[<span class="number">1</span>:<span class="number">5</span>], each = <span class="number">3</span>),</span><br><span class="line">+     levels = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">+     ordered = <span class="literal">FALSE</span></span><br><span class="line">+ )</span><br><span class="line">&gt; fact1</span><br><span class="line"> [<span class="number">1</span>] A A A B B B C C C D D D E E E</span><br><span class="line">Levels: A B C D E</span><br><span class="line">&gt; str(fact1)</span><br><span class="line"> Factor w/ <span class="number">5</span> levels <span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,<span class="string">"D"</span>,..: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="keyword">...</span></span><br><span class="line">&gt; typeof(fact1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br><span class="line">&gt; mode(fact1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(fact1)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"factor"</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; fact1 &lt;- factor(</span><br><span class="line">+     x = rep(LETTERS[<span class="number">1</span>:<span class="number">5</span>], each = <span class="number">3</span>),</span><br><span class="line">+     levels = c(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>),</span><br><span class="line">+     ordered = <span class="literal">TRUE</span></span><br><span class="line">+ )</span><br><span class="line">&gt; fact1</span><br><span class="line"> [<span class="number">1</span>] A A A B B B C C C D D D E E E</span><br><span class="line">Levels: A &lt; B &lt; C &lt; D &lt; E</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; fact2 &lt;- factor(</span><br><span class="line">+     x = rep(<span class="number">1</span>:<span class="number">5</span>, each = <span class="number">3</span>),</span><br><span class="line">+     levels = <span class="number">1</span>:<span class="number">5</span>,</span><br><span class="line">+     labels = c(<span class="string">"婴儿"</span>, <span class="string">"儿童"</span>, <span class="string">"少年"</span>, <span class="string">"青年"</span>, <span class="string">"老年"</span>),</span><br><span class="line">+     ordered = <span class="literal">TRUE</span></span><br><span class="line">+ )</span><br><span class="line">&gt; fact2</span><br><span class="line"> [<span class="number">1</span>] 婴儿 婴儿 婴儿 儿童 儿童 儿童 少年 少年 少年 青年 青年 青年 老年 老年 老年</span><br><span class="line">Levels: 婴儿 &lt; 儿童 &lt; 少年 &lt; 青年 &lt; 老年</span><br><span class="line">&gt; </span><br><span class="line">&gt; str(fact2)</span><br><span class="line"> Ord.factor w/ <span class="number">5</span> levels <span class="string">"婴儿"</span>&lt;<span class="string">"儿童"</span>&lt;..: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">4</span> <span class="keyword">...</span></span><br><span class="line">&gt; typeof(fact2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"integer"</span></span><br><span class="line">&gt; mode(fact2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></span><br><span class="line">&gt; class(fact2)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"ordered"</span> <span class="string">"factor"</span></span><br></pre></td></tr></table></figure><p>自定义区间分箱生成因子</p><p>使用自定义区间分箱</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; fact3 &lt;- cut(</span><br><span class="line">+     x = sample(<span class="number">1</span>:<span class="number">100</span>, size = <span class="number">100</span>, replace = <span class="literal">TRUE</span>),</span><br><span class="line">+     breaks = c(<span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>),</span><br><span class="line">+     labels = c(<span class="string">"0~20"</span>, <span class="string">"20~40"</span>, <span class="string">"40~60"</span>, <span class="string">"60~80"</span>, <span class="string">"80~100"</span>),</span><br><span class="line">+     include.lowest = <span class="literal">TRUE</span>, <span class="comment"># 默认是左开右闭的 这样包括最小值，第一个区间是左闭右闭的，其他仍是左开右闭</span></span><br><span class="line">+     ordered = <span class="literal">TRUE</span></span><br><span class="line">+ )</span><br><span class="line">&gt; fact3</span><br><span class="line">  [<span class="number">1</span>] <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>   <span class="number">40</span>~<span class="number">60</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">40</span>~<span class="number">60</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span>  <span class="number">60</span>~<span class="number">80</span> </span><br><span class="line"> [<span class="number">12</span>] <span class="number">40</span>~<span class="number">60</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">60</span>~<span class="number">80</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span>  <span class="number">60</span>~<span class="number">80</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">60</span>~<span class="number">80</span> </span><br><span class="line"> [<span class="number">23</span>] <span class="number">40</span>~<span class="number">60</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">80</span>~<span class="number">100</span> <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">60</span>~<span class="number">80</span>  <span class="number">60</span>~<span class="number">80</span>  <span class="number">60</span>~<span class="number">80</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">80</span>~<span class="number">100</span> <span class="number">80</span>~<span class="number">100</span></span><br><span class="line"> [<span class="number">34</span>] <span class="number">40</span>~<span class="number">60</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">60</span>~<span class="number">80</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>   <span class="number">60</span>~<span class="number">80</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span> </span><br><span class="line"> [<span class="number">45</span>] <span class="number">80</span>~<span class="number">100</span> <span class="number">0</span>~<span class="number">20</span>   <span class="number">60</span>~<span class="number">80</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">80</span>~<span class="number">100</span> <span class="number">40</span>~<span class="number">60</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>  </span><br><span class="line"> [<span class="number">56</span>] <span class="number">60</span>~<span class="number">80</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">80</span>~<span class="number">100</span> <span class="number">40</span>~<span class="number">60</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>  </span><br><span class="line"> [<span class="number">67</span>] <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>   <span class="number">20</span>~<span class="number">40</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">60</span>~<span class="number">80</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>  </span><br><span class="line"> [<span class="number">78</span>] <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>   <span class="number">0</span>~<span class="number">20</span>   <span class="number">40</span>~<span class="number">60</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">60</span>~<span class="number">80</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">80</span>~<span class="number">100</span> <span class="number">40</span>~<span class="number">60</span> </span><br><span class="line"> [<span class="number">89</span>] <span class="number">60</span>~<span class="number">80</span>  <span class="number">20</span>~<span class="number">40</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">60</span>~<span class="number">80</span>  <span class="number">80</span>~<span class="number">100</span> <span class="number">20</span>~<span class="number">40</span>  <span class="number">40</span>~<span class="number">60</span>  <span class="number">60</span>~<span class="number">80</span>  <span class="number">0</span>~<span class="number">20</span>   <span class="number">60</span>~<span class="number">80</span>  <span class="number">40</span>~<span class="number">60</span> </span><br><span class="line">[<span class="number">100</span>] <span class="number">40</span>~<span class="number">60</span> </span><br><span class="line">Levels: <span class="number">0</span>~<span class="number">20</span> &lt; <span class="number">20</span>~<span class="number">40</span> &lt; <span class="number">40</span>~<span class="number">60</span> &lt; <span class="number">60</span>~<span class="number">80</span> &lt; <span class="number">80</span>~<span class="number">100</span></span><br></pre></td></tr></table></figure><p>使用分位数作为分箱区间</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; value1 = sample(<span class="number">1</span>:<span class="number">100</span>, size=<span class="number">100</span>, replace = <span class="literal">TRUE</span>)</span><br><span class="line">&gt; </span><br><span class="line">&gt; qa &lt;- quantile(</span><br><span class="line">+     x = value1,</span><br><span class="line">+     probs = seq(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.2</span>)</span><br><span class="line">+ )</span><br><span class="line">&gt; qa</span><br><span class="line">   <span class="number">0</span>%   <span class="number">20</span>%   <span class="number">40</span>%   <span class="number">60</span>%   <span class="number">80</span>%  <span class="number">100</span>% </span><br><span class="line">  <span class="number">1.0</span>  <span class="number">13.6</span>  <span class="number">35.6</span>  <span class="number">59.6</span>  <span class="number">78.2</span> <span class="number">100.0</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&gt; fact3 &lt;- cut(</span><br><span class="line">+     x = value1,</span><br><span class="line">+     breaks = c(<span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>),</span><br><span class="line">+     labels = c(<span class="string">"0~20%"</span>, <span class="string">"20~40%"</span>, <span class="string">"40~60%"</span>, <span class="string">"60~80%"</span>, <span class="string">"80~100%"</span>),</span><br><span class="line">+     include.lowest = <span class="literal">TRUE</span>,</span><br><span class="line">+     ordered = <span class="literal">TRUE</span></span><br><span class="line">+ )</span><br><span class="line">&gt; fact3</span><br><span class="line">  [<span class="number">1</span>] <span class="number">40</span>~<span class="number">60</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">60</span>~<span class="number">80</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">60</span>~<span class="number">80</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">40</span>~<span class="number">60</span>% </span><br><span class="line"> [<span class="number">11</span>] <span class="number">60</span>~<span class="number">80</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">80</span>~<span class="number">100</span>% <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">80</span>~<span class="number">100</span>% <span class="number">40</span>~<span class="number">60</span>%  <span class="number">40</span>~<span class="number">60</span>% </span><br><span class="line"> [<span class="number">21</span>] <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%   <span class="number">40</span>~<span class="number">60</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">60</span>~<span class="number">80</span>% </span><br><span class="line"> [<span class="number">31</span>] <span class="number">0</span>~<span class="number">20</span>%   <span class="number">80</span>~<span class="number">100</span>% <span class="number">80</span>~<span class="number">100</span>% <span class="number">20</span>~<span class="number">40</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">0</span>~<span class="number">20</span>%   <span class="number">80</span>~<span class="number">100</span>%</span><br><span class="line"> [<span class="number">41</span>] <span class="number">20</span>~<span class="number">40</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">20</span>~<span class="number">40</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%  </span><br><span class="line"> [<span class="number">51</span>] <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">40</span>~<span class="number">60</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">60</span>~<span class="number">80</span>% </span><br><span class="line"> [<span class="number">61</span>] <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%   <span class="number">40</span>~<span class="number">60</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%  </span><br><span class="line"> [<span class="number">71</span>] <span class="number">40</span>~<span class="number">60</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">80</span>~<span class="number">100</span>% <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">80</span>~<span class="number">100</span>% <span class="number">80</span>~<span class="number">100</span>% <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">20</span>~<span class="number">40</span>% </span><br><span class="line"> [<span class="number">81</span>] <span class="number">20</span>~<span class="number">40</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">80</span>~<span class="number">100</span>% <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">20</span>~<span class="number">40</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">40</span>~<span class="number">60</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%  </span><br><span class="line"> [<span class="number">91</span>] <span class="number">0</span>~<span class="number">20</span>%   <span class="number">80</span>~<span class="number">100</span>% <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">0</span>~<span class="number">20</span>%   <span class="number">0</span>~<span class="number">20</span>%   <span class="number">60</span>~<span class="number">80</span>%  <span class="number">60</span>~<span class="number">80</span>%  <span class="number">60</span>~<span class="number">80</span>% </span><br><span class="line">Levels: <span class="number">0</span>~<span class="number">20</span>% &lt; <span class="number">20</span>~<span class="number">40</span>% &lt; <span class="number">40</span>~<span class="number">60</span>% &lt; <span class="number">60</span>~<span class="number">80</span>% &lt; <span class="number">80</span>~<span class="number">100</span>%</span><br></pre></td></tr></table></figure><h1 id="数据索引与切片-聚合"><a class="markdownIt-Anchor" href="#数据索引与切片-聚合"></a> 数据索引与切片、聚合</h1><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fr0quguzfuj20pz0bw410.jpg" alt=""></p><p>索引向量</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; variable1 &lt;- <span class="number">1</span>:<span class="number">100</span></span><br><span class="line">&gt; <span class="comment"># 索引前10个值</span></span><br><span class="line">&gt; variable1[<span class="number">1</span>:<span class="number">10</span>]</span><br><span class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span><br><span class="line">&gt; <span class="comment"># 索引第4、6、8、9个值</span></span><br><span class="line">&gt; variable1[c(<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>)]</span><br><span class="line">[<span class="number">1</span>] <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">9</span></span><br><span class="line">&gt; <span class="comment"># 布尔索引</span></span><br><span class="line">&gt; variable1[sample(x = c(<span class="literal">TRUE</span>, <span class="literal">FALSE</span>), size = <span class="number">100</span>, replace = <span class="literal">TRUE</span>)]</span><br><span class="line"> [<span class="number">1</span>]  <span class="number">4</span>  <span class="number">8</span> <span class="number">10</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">22</span> <span class="number">24</span> <span class="number">25</span> <span class="number">28</span> <span class="number">29</span> <span class="number">30</span> <span class="number">33</span> <span class="number">35</span> <span class="number">39</span> <span class="number">43</span> <span class="number">44</span> <span class="number">45</span> <span class="number">51</span> <span class="number">52</span> <span class="number">53</span> <span class="number">55</span></span><br><span class="line">[<span class="number">28</span>] <span class="number">59</span> <span class="number">60</span> <span class="number">62</span> <span class="number">63</span> <span class="number">69</span> <span class="number">70</span> <span class="number">73</span> <span class="number">75</span> <span class="number">76</span> <span class="number">77</span> <span class="number">79</span> <span class="number">81</span> <span class="number">83</span> <span class="number">91</span> <span class="number">92</span> <span class="number">93</span> <span class="number">98</span> <span class="number">99</span></span><br><span class="line">&gt; <span class="comment"># 条件索引（偶数）</span></span><br><span class="line">&gt; variable1[variable1%%<span class="number">2</span> == <span class="number">0</span>]</span><br><span class="line"> [<span class="number">1</span>]   <span class="number">2</span>   <span class="number">4</span>   <span class="number">6</span>   <span class="number">8</span>  <span class="number">10</span>  <span class="number">12</span>  <span class="number">14</span>  <span class="number">16</span>  <span class="number">18</span>  <span class="number">20</span>  <span class="number">22</span>  <span class="number">24</span>  <span class="number">26</span>  <span class="number">28</span>  <span class="number">30</span>  <span class="number">32</span>  <span class="number">34</span>  <span class="number">36</span>  <span class="number">38</span>  <span class="number">40</span></span><br><span class="line">[<span class="number">21</span>]  <span class="number">42</span>  <span class="number">44</span>  <span class="number">46</span>  <span class="number">48</span>  <span class="number">50</span>  <span class="number">52</span>  <span class="number">54</span>  <span class="number">56</span>  <span class="number">58</span>  <span class="number">60</span>  <span class="number">62</span>  <span class="number">64</span>  <span class="number">66</span>  <span class="number">68</span>  <span class="number">70</span>  <span class="number">72</span>  <span class="number">74</span>  <span class="number">76</span>  <span class="number">78</span>  <span class="number">80</span></span><br><span class="line">[<span class="number">41</span>]  <span class="number">82</span>  <span class="number">84</span>  <span class="number">86</span>  <span class="number">88</span>  <span class="number">90</span>  <span class="number">92</span>  <span class="number">94</span>  <span class="number">96</span>  <span class="number">98</span> <span class="number">100</span></span><br></pre></td></tr></table></figure><p>索引数据框</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入数据集数据，是个数据框</span></span><br><span class="line">&gt; mydata1 &lt;- ggplot2::mpg</span><br><span class="line">&gt; head(mydata1)</span><br><span class="line"><span class="comment"># A tibble: 6 x 11</span></span><br><span class="line">  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class  </span><br><span class="line">  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  </span><br><span class="line"><span class="number">1</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> auto(l5)   f        <span class="number">18</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">2</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> manual(m5) f        <span class="number">21</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">3</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> manual(m6) f        <span class="number">20</span>    <span class="number">31</span> p     compact</span><br><span class="line"><span class="number">4</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> auto(av)   f        <span class="number">21</span>    <span class="number">30</span> p     compact</span><br><span class="line"><span class="number">5</span> audi         a4     <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> auto(l5)   f        <span class="number">16</span>    <span class="number">26</span> p     compact</span><br><span class="line"><span class="number">6</span> audi         a4     <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> manual(m5) f        <span class="number">18</span>    <span class="number">26</span> p     compact</span><br><span class="line">&gt; str(mydata1)</span><br><span class="line">Classes ‘tbl_df’, ‘tbl’ and <span class="string">'data.frame'</span>:<span class="number">234</span> obs. of  <span class="number">11</span> variables:</span><br><span class="line"> $ manufacturer: chr  <span class="string">"audi"</span> <span class="string">"audi"</span> <span class="string">"audi"</span> <span class="string">"audi"</span> <span class="keyword">...</span></span><br><span class="line"> $ model       : chr  <span class="string">"a4"</span> <span class="string">"a4"</span> <span class="string">"a4"</span> <span class="string">"a4"</span> <span class="keyword">...</span></span><br><span class="line"> $ displ       : num  <span class="number">1.8</span> <span class="number">1.8</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2.8</span> <span class="number">2.8</span> <span class="number">3.1</span> <span class="number">1.8</span> <span class="number">1.8</span> <span class="number">2</span> <span class="keyword">...</span></span><br><span class="line"> $ year        : int  <span class="number">1999</span> <span class="number">1999</span> <span class="number">2008</span> <span class="number">2008</span> <span class="number">1999</span> <span class="number">1999</span> <span class="number">2008</span> <span class="number">1999</span> <span class="number">1999</span> <span class="number">2008</span> <span class="keyword">...</span></span><br><span class="line"> $ cyl         : int  <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="number">6</span> <span class="number">6</span> <span class="number">6</span> <span class="number">4</span> <span class="number">4</span> <span class="number">4</span> <span class="keyword">...</span></span><br><span class="line"> $ trans       : chr  <span class="string">"auto(l5)"</span> <span class="string">"manual(m5)"</span> <span class="string">"manual(m6)"</span> <span class="string">"auto(av)"</span> <span class="keyword">...</span></span><br><span class="line"> $ drv         : chr  <span class="string">"f"</span> <span class="string">"f"</span> <span class="string">"f"</span> <span class="string">"f"</span> <span class="keyword">...</span></span><br><span class="line"> $ cty         : int  <span class="number">18</span> <span class="number">21</span> <span class="number">20</span> <span class="number">21</span> <span class="number">16</span> <span class="number">18</span> <span class="number">18</span> <span class="number">18</span> <span class="number">16</span> <span class="number">20</span> <span class="keyword">...</span></span><br><span class="line"> $ hwy         : int  <span class="number">29</span> <span class="number">29</span> <span class="number">31</span> <span class="number">30</span> <span class="number">26</span> <span class="number">26</span> <span class="number">27</span> <span class="number">26</span> <span class="number">25</span> <span class="number">28</span> <span class="keyword">...</span></span><br><span class="line"> $ fl          : chr  <span class="string">"p"</span> <span class="string">"p"</span> <span class="string">"p"</span> <span class="string">"p"</span> <span class="keyword">...</span></span><br><span class="line"> $ class       : chr  <span class="string">"compact"</span> <span class="string">"compact"</span> <span class="string">"compact"</span> <span class="string">"compact"</span> <span class="keyword">...</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 列索引</span></span><br><span class="line">&gt; mydata1[, c(<span class="number">2</span>, <span class="number">3</span>)]</span><br><span class="line"><span class="comment"># A tibble: 234 x 2</span></span><br><span class="line">   model      displ</span><br><span class="line">   &lt;chr&gt;      &lt;dbl&gt;</span><br><span class="line"> <span class="number">1</span> a4          <span class="number">1.80</span></span><br><span class="line"> <span class="number">2</span> a4          <span class="number">1.80</span></span><br><span class="line"> <span class="number">3</span> a4          <span class="number">2.00</span></span><br><span class="line"> <span class="number">4</span> a4          <span class="number">2.00</span></span><br><span class="line"> <span class="number">5</span> a4          <span class="number">2.80</span></span><br><span class="line"> <span class="number">6</span> a4          <span class="number">2.80</span></span><br><span class="line"> <span class="number">7</span> a4          <span class="number">3.10</span></span><br><span class="line"> <span class="number">8</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line"> <span class="number">9</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line"><span class="number">10</span> a4 quattro  <span class="number">2.00</span></span><br><span class="line"><span class="comment"># ... with 224 more rows</span></span><br><span class="line">&gt; mydata1[, c(<span class="string">"model"</span>, <span class="string">"displ"</span>)]</span><br><span class="line"><span class="comment"># A tibble: 234 x 2</span></span><br><span class="line">   model      displ</span><br><span class="line">   &lt;chr&gt;      &lt;dbl&gt;</span><br><span class="line"> <span class="number">1</span> a4          <span class="number">1.80</span></span><br><span class="line"> <span class="number">2</span> a4          <span class="number">1.80</span></span><br><span class="line"> <span class="number">3</span> a4          <span class="number">2.00</span></span><br><span class="line"> <span class="number">4</span> a4          <span class="number">2.00</span></span><br><span class="line"> <span class="number">5</span> a4          <span class="number">2.80</span></span><br><span class="line"> <span class="number">6</span> a4          <span class="number">2.80</span></span><br><span class="line"> <span class="number">7</span> a4          <span class="number">3.10</span></span><br><span class="line"> <span class="number">8</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line"> <span class="number">9</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line"><span class="number">10</span> a4 quattro  <span class="number">2.00</span></span><br><span class="line"><span class="comment"># ... with 224 more rows</span></span><br><span class="line">&gt; <span class="comment"># 行索引</span></span><br><span class="line">&gt; mydata1[<span class="number">1</span>:<span class="number">5</span>, ]</span><br><span class="line"><span class="comment"># A tibble: 5 x 11</span></span><br><span class="line">  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class  </span><br><span class="line">  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  </span><br><span class="line"><span class="number">1</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> auto(l5)   f        <span class="number">18</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">2</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> manual(m5) f        <span class="number">21</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">3</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> manual(m6) f        <span class="number">20</span>    <span class="number">31</span> p     compact</span><br><span class="line"><span class="number">4</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> auto(av)   f        <span class="number">21</span>    <span class="number">30</span> p     compact</span><br><span class="line"><span class="number">5</span> audi         a4     <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> auto(l5)   f        <span class="number">16</span>    <span class="number">26</span> p     compact</span><br><span class="line">&gt; mydata1[c(<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>), ]</span><br><span class="line"><span class="comment"># A tibble: 5 x 11</span></span><br><span class="line">  manufacturer model      displ  year   cyl trans      drv     cty   hwy fl    class</span><br><span class="line">  &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span><br><span class="line"><span class="number">1</span> audi         a4          <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> auto(l5)   f        <span class="number">18</span>    <span class="number">29</span> p     comp~</span><br><span class="line"><span class="number">2</span> audi         a4          <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> auto(av)   f        <span class="number">21</span>    <span class="number">30</span> p     comp~</span><br><span class="line"><span class="number">3</span> audi         a4          <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> manual(m5) f        <span class="number">18</span>    <span class="number">26</span> p     comp~</span><br><span class="line"><span class="number">4</span> audi         a4 quattro  <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> manual(m5) <span class="number">4</span>        <span class="number">18</span>    <span class="number">26</span> p     comp~</span><br><span class="line"><span class="number">5</span> audi         a4 quattro  <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> auto(l5)   <span class="number">4</span>        <span class="number">16</span>    <span class="number">25</span> p     comp~</span><br><span class="line">&gt; mydata1[c(<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>), c(<span class="string">"model"</span>, <span class="string">"displ"</span>)]</span><br><span class="line"><span class="comment"># A tibble: 5 x 2</span></span><br><span class="line">  model      displ</span><br><span class="line">  &lt;chr&gt;      &lt;dbl&gt;</span><br><span class="line"><span class="number">1</span> a4          <span class="number">1.80</span></span><br><span class="line"><span class="number">2</span> a4          <span class="number">2.00</span></span><br><span class="line"><span class="number">3</span> a4          <span class="number">2.80</span></span><br><span class="line"><span class="number">4</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line"><span class="number">5</span> a4 quattro  <span class="number">1.80</span></span><br><span class="line">&gt; <span class="comment"># 条件索引</span></span><br><span class="line">&gt; <span class="comment"># 或条件</span></span><br><span class="line">&gt; mydata1[mydata1$model == <span class="string">"audi"</span> | mydata1$manufacturer == <span class="string">"mercury"</span>, ]</span><br><span class="line"><span class="comment"># A tibble: 4 x 11</span></span><br><span class="line">  manufacturer model           displ  year   cyl trans drv     cty   hwy fl    class</span><br><span class="line">  &lt;chr&gt;        &lt;chr&gt;           &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span><br><span class="line"><span class="number">1</span> mercury      mountaineer 4wd  <span class="number">4.00</span>  <span class="number">1999</span>     <span class="number">6</span> auto~ <span class="number">4</span>        <span class="number">14</span>    <span class="number">17</span> r     suv  </span><br><span class="line"><span class="number">2</span> mercury      mountaineer 4wd  <span class="number">4.00</span>  <span class="number">2008</span>     <span class="number">6</span> auto~ <span class="number">4</span>        <span class="number">13</span>    <span class="number">19</span> r     suv  </span><br><span class="line"><span class="number">3</span> mercury      mountaineer 4wd  <span class="number">4.60</span>  <span class="number">2008</span>     <span class="number">8</span> auto~ <span class="number">4</span>        <span class="number">13</span>    <span class="number">19</span> r     suv  </span><br><span class="line"><span class="number">4</span> mercury      mountaineer 4wd  <span class="number">5.00</span>  <span class="number">1999</span>     <span class="number">8</span> auto~ <span class="number">4</span>        <span class="number">13</span>    <span class="number">17</span> r     suv  </span><br><span class="line">&gt; <span class="comment"># 且条件</span></span><br><span class="line">&gt; mydata1[mydata1$model == <span class="string">"a4"</span> &amp; mydata1$manufacturer == <span class="string">"audi"</span>, ]</span><br><span class="line"><span class="comment"># A tibble: 7 x 11</span></span><br><span class="line">  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class  </span><br><span class="line">  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  </span><br><span class="line"><span class="number">1</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> auto(l5)   f        <span class="number">18</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">2</span> audi         a4     <span class="number">1.80</span>  <span class="number">1999</span>     <span class="number">4</span> manual(m5) f        <span class="number">21</span>    <span class="number">29</span> p     compact</span><br><span class="line"><span class="number">3</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> manual(m6) f        <span class="number">20</span>    <span class="number">31</span> p     compact</span><br><span class="line"><span class="number">4</span> audi         a4     <span class="number">2.00</span>  <span class="number">2008</span>     <span class="number">4</span> auto(av)   f        <span class="number">21</span>    <span class="number">30</span> p     compact</span><br><span class="line"><span class="number">5</span> audi         a4     <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> auto(l5)   f        <span class="number">16</span>    <span class="number">26</span> p     compact</span><br><span class="line"><span class="number">6</span> audi         a4     <span class="number">2.80</span>  <span class="number">1999</span>     <span class="number">6</span> manual(m5) f        <span class="number">18</span>    <span class="number">26</span> p     compact</span><br><span class="line"><span class="number">7</span> audi         a4     <span class="number">3.10</span>  <span class="number">2008</span>     <span class="number">6</span> auto(av)   f        <span class="number">18</span>    <span class="number">27</span> p     compact</span><br></pre></td></tr></table></figure><p>使用内置的subset函数来实现基本的切片索引</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># 使用内置的subset函数来实现基本的切片索引</span></span><br><span class="line">&gt; subset(mydata1, model ==<span class="string">"audi"</span> | manufacturer == <span class="string">"mercury"</span>, select = c(<span class="string">"model"</span>, <span class="string">"manufacturer"</span>, <span class="string">"year"</span>))</span><br><span class="line"><span class="comment"># A tibble: 4 x 3</span></span><br><span class="line">  model           manufacturer  year</span><br><span class="line">  &lt;chr&gt;           &lt;chr&gt;        &lt;int&gt;</span><br><span class="line"><span class="number">1</span> mountaineer 4wd mercury       <span class="number">1999</span></span><br><span class="line"><span class="number">2</span> mountaineer 4wd mercury       <span class="number">2008</span></span><br><span class="line"><span class="number">3</span> mountaineer 4wd mercury       <span class="number">2008</span></span><br><span class="line"><span class="number">4</span> mountaineer 4wd mercury       <span class="number">1999</span></span><br><span class="line">&gt; subset(mydata1, model == <span class="string">"a4"</span> | manufacturer == <span class="string">"audi"</span>, select = c(<span class="string">"model"</span>, <span class="string">"manufacturer"</span>, <span class="string">"year"</span>))</span><br><span class="line"><span class="comment"># A tibble: 18 x 3</span></span><br><span class="line">   model      manufacturer  year</span><br><span class="line">   &lt;chr&gt;      &lt;chr&gt;        &lt;int&gt;</span><br><span class="line"> <span class="number">1</span> a4         audi          <span class="number">1999</span></span><br><span class="line"> <span class="number">2</span> a4         audi          <span class="number">1999</span></span><br><span class="line"> <span class="number">3</span> a4         audi          <span class="number">2008</span></span><br><span class="line"> <span class="number">4</span> a4         audi          <span class="number">2008</span></span><br><span class="line"> <span class="number">5</span> a4         audi          <span class="number">1999</span></span><br><span class="line"> <span class="number">6</span> a4         audi          <span class="number">1999</span></span><br><span class="line"> <span class="number">7</span> a4         audi          <span class="number">2008</span></span><br><span class="line"> <span class="number">8</span> a4 quattro audi          <span class="number">1999</span></span><br><span class="line"> <span class="number">9</span> a4 quattro audi          <span class="number">1999</span></span><br><span class="line"><span class="number">10</span> a4 quattro audi          <span class="number">2008</span></span><br><span class="line"><span class="number">11</span> a4 quattro audi          <span class="number">2008</span></span><br><span class="line"><span class="number">12</span> a4 quattro audi          <span class="number">1999</span></span><br><span class="line"><span class="number">13</span> a4 quattro audi          <span class="number">1999</span></span><br><span class="line"><span class="number">14</span> a4 quattro audi          <span class="number">2008</span></span><br><span class="line"><span class="number">15</span> a4 quattro audi          <span class="number">2008</span></span><br><span class="line"><span class="number">16</span> a6 quattro audi          <span class="number">1999</span></span><br><span class="line"><span class="number">17</span> a6 quattro audi          <span class="number">2008</span></span><br><span class="line"><span class="number">18</span> a6 quattro audi          <span class="number">2008</span></span><br></pre></td></tr></table></figure><p>使用dplyr包里面更为高效的函数实现切片索引</p><p>%&gt;%管道函数 左侧传给右侧</p><p>filter筛选行 select筛选列</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">library</span>(dplyr)</span><br><span class="line"></span><br><span class="line">载入程辑包：‘dplyr’</span><br><span class="line"></span><br><span class="line">The following objects are masked from ‘package:stats’:</span><br><span class="line"></span><br><span class="line">    filter, lag</span><br><span class="line"></span><br><span class="line">The following objects are masked from ‘package:base’:</span><br><span class="line"></span><br><span class="line">    intersect, setdiff, setequal, union</span><br><span class="line"></span><br><span class="line">Warning message:</span><br><span class="line">程辑包‘dplyr’是用R版本<span class="number">3.4</span><span class="number">.3</span> 来建造的 </span><br><span class="line">&gt; </span><br><span class="line">&gt; mydata1 %&gt;% filter(model==<span class="string">"audi"</span> | manufacturer==<span class="string">"mercury"</span>) %&gt;% select(model, manufacturer,year)</span><br><span class="line"><span class="comment"># A tibble: 4 x 3</span></span><br><span class="line">  model           manufacturer  year</span><br><span class="line">  &lt;chr&gt;           &lt;chr&gt;        &lt;int&gt;</span><br><span class="line"><span class="number">1</span> mountaineer 4wd mercury       <span class="number">1999</span></span><br><span class="line"><span class="number">2</span> mountaineer 4wd mercury       <span class="number">2008</span></span><br><span class="line"><span class="number">3</span> mountaineer 4wd mercury       <span class="number">2008</span></span><br><span class="line"><span class="number">4</span> mountaineer 4wd mercury       <span class="number">1999</span></span><br><span class="line">Warning message:</span><br><span class="line">package ‘bindrcpp’ was built under R version <span class="number">3.4</span><span class="number">.4</span> </span><br><span class="line">&gt; mydata1 %&gt;% filter(model==<span class="string">"a4"</span> &amp; manufacturer==<span class="string">"audi"</span>) %&gt;% select(model, manufacturer, year)</span><br><span class="line"><span class="comment"># A tibble: 7 x 3</span></span><br><span class="line">  model manufacturer  year</span><br><span class="line">  &lt;chr&gt; &lt;chr&gt;        &lt;int&gt;</span><br><span class="line"><span class="number">1</span> a4    audi          <span class="number">1999</span></span><br><span class="line"><span class="number">2</span> a4    audi          <span class="number">1999</span></span><br><span class="line"><span class="number">3</span> a4    audi          <span class="number">2008</span></span><br><span class="line"><span class="number">4</span> a4    audi          <span class="number">2008</span></span><br><span class="line"><span class="number">5</span> a4    audi          <span class="number">1999</span></span><br><span class="line"><span class="number">6</span> a4    audi          <span class="number">1999</span></span><br><span class="line"><span class="number">7</span> a4    audi          <span class="number">2008</span></span><br></pre></td></tr></table></figure><p>数据聚合计算</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&gt; iris1 &lt;- iris</span><br><span class="line">&gt; head(iris1)</span><br><span class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span><br><span class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">5</span>          <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</span><br><span class="line"><span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>  setosa</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># transform函数只能基于已有变量进行计算，无法基于新生成的变量进行计算</span></span><br><span class="line">&gt; iris1 &lt;- transform(</span><br><span class="line">+     iris1,</span><br><span class="line">+     dek=Sepal.Length/Sepal.Width,</span><br><span class="line">+     pek=Petal.Length+Petal.Width</span><br><span class="line">+ )</span><br><span class="line">&gt; iris1</span><br><span class="line">    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species      dek pek</span><br><span class="line"><span class="number">1</span>            <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa <span class="number">1.457143</span> <span class="number">1.6</span></span><br><span class="line"><span class="number">2</span>            <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa <span class="number">1.633333</span> <span class="number">1.6</span></span><br><span class="line"><span class="number">3</span>            <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa <span class="number">1.468750</span> <span class="number">1.5</span></span><br><span class="line"><span class="number">4</span>            <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa <span class="number">1.483871</span> <span class="number">1.7</span></span><br><span class="line"><span class="number">5</span>            <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa <span class="number">1.388889</span> <span class="number">1.6</span></span><br><span class="line"><span class="number">6</span>            <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>     setosa <span class="number">1.384615</span> <span class="number">2.1</span></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"><span class="number">139</span>          <span class="number">6.0</span>         <span class="number">3.0</span>          <span class="number">4.8</span>         <span class="number">1.8</span>  virginica <span class="number">2.000000</span> <span class="number">6.6</span></span><br><span class="line"><span class="number">140</span>          <span class="number">6.9</span>         <span class="number">3.1</span>          <span class="number">5.4</span>         <span class="number">2.1</span>  virginica <span class="number">2.225806</span> <span class="number">7.5</span></span><br><span class="line"><span class="number">141</span>          <span class="number">6.7</span>         <span class="number">3.1</span>          <span class="number">5.6</span>         <span class="number">2.4</span>  virginica <span class="number">2.161290</span> <span class="number">8.0</span></span><br><span class="line"><span class="number">142</span>          <span class="number">6.9</span>         <span class="number">3.1</span>          <span class="number">5.1</span>         <span class="number">2.3</span>  virginica <span class="number">2.225806</span> <span class="number">7.4</span></span><br><span class="line"> [ reached getOption(<span class="string">"max.print"</span>) -- omitted <span class="number">8</span> rows ]</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># mutate函数实现了基于新生成的变量进行计算的需求</span></span><br><span class="line">&gt; iris1 &lt;- dplyr::mutate(</span><br><span class="line">+     iris1,</span><br><span class="line">+     dek=Sepal.Length+Sepal.Width,</span><br><span class="line">+     jek=sqrt(dek)</span><br><span class="line">+ )</span><br><span class="line">&gt; iris1</span><br><span class="line">    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species  dek pek      jek</span><br><span class="line"><span class="number">1</span>            <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa  <span class="number">8.6</span> <span class="number">1.6</span> <span class="number">2.932576</span></span><br><span class="line"><span class="number">2</span>            <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa  <span class="number">7.9</span> <span class="number">1.6</span> <span class="number">2.810694</span></span><br><span class="line"><span class="number">3</span>            <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa  <span class="number">7.9</span> <span class="number">1.5</span> <span class="number">2.810694</span></span><br><span class="line"><span class="number">4</span>            <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa  <span class="number">7.7</span> <span class="number">1.7</span> <span class="number">2.774887</span></span><br><span class="line"><span class="number">5</span>            <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa  <span class="number">8.6</span> <span class="number">1.6</span> <span class="number">2.932576</span></span><br><span class="line"><span class="number">6</span>            <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>     setosa  <span class="number">9.3</span> <span class="number">2.1</span> <span class="number">3.049590</span></span><br><span class="line"><span class="number">7</span>            <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>     setosa  <span class="number">8.0</span> <span class="number">1.7</span> <span class="number">2.828427</span></span><br><span class="line"><span class="number">8</span>            <span class="number">5.0</span>         <span class="number">3.4</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa  <span class="number">8.4</span> <span class="number">1.7</span> <span class="number">2.898275</span></span><br><span class="line"><span class="number">9</span>            <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa  <span class="number">7.3</span> <span class="number">1.6</span> <span class="number">2.701851</span></span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line"><span class="number">121</span>          <span class="number">6.9</span>         <span class="number">3.2</span>          <span class="number">5.7</span>         <span class="number">2.3</span>  virginica <span class="number">10.1</span> <span class="number">8.0</span> <span class="number">3.178050</span></span><br><span class="line"><span class="number">122</span>          <span class="number">5.6</span>         <span class="number">2.8</span>          <span class="number">4.9</span>         <span class="number">2.0</span>  virginica  <span class="number">8.4</span> <span class="number">6.9</span> <span class="number">2.898275</span></span><br><span class="line"><span class="number">123</span>          <span class="number">7.7</span>         <span class="number">2.8</span>          <span class="number">6.7</span>         <span class="number">2.0</span>  virginica <span class="number">10.5</span> <span class="number">8.7</span> <span class="number">3.240370</span></span><br><span class="line"><span class="number">124</span>          <span class="number">6.3</span>         <span class="number">2.7</span>          <span class="number">4.9</span>         <span class="number">1.8</span>  virginica  <span class="number">9.0</span> <span class="number">6.7</span> <span class="number">3.000000</span></span><br><span class="line"><span class="number">125</span>          <span class="number">6.7</span>         <span class="number">3.3</span>          <span class="number">5.7</span>         <span class="number">2.1</span>  virginica <span class="number">10.0</span> <span class="number">7.8</span> <span class="number">3.162278</span></span><br><span class="line"> [ reached getOption(<span class="string">"max.print"</span>) -- omitted <span class="number">25</span> rows ]</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># within函数</span></span><br><span class="line">&gt; mydata &lt;- data.frame(</span><br><span class="line">+     Name = sample(LETTERS[<span class="number">1</span>:<span class="number">20</span>]),</span><br><span class="line">+     old = runif(<span class="number">20</span>, <span class="number">5</span>, <span class="number">65</span>) %&gt;% round(<span class="number">0</span>)</span><br><span class="line">+ )</span><br><span class="line">&gt; </span><br><span class="line">&gt; mydata &lt;- within(mydata,&#123;</span><br><span class="line">+     agecat &lt;- <span class="literal">NA</span></span><br><span class="line">+     agecat[old &gt; <span class="number">55</span>] &lt;- <span class="string">"Elder"</span></span><br><span class="line">+     agecat[old &gt;= <span class="number">35</span> &amp; old &lt;= <span class="number">55</span>] &lt;- <span class="string">"Middle Aged"</span></span><br><span class="line">+     agecat[old &lt; <span class="number">35</span>] &lt;- <span class="string">"Young"</span></span><br><span class="line">+ &#125;)</span><br><span class="line">&gt; mydata</span><br><span class="line">   Name old      agecat</span><br><span class="line"><span class="number">1</span>     Q  <span class="number">14</span>       Young</span><br><span class="line"><span class="number">2</span>     C  <span class="number">31</span>       Young</span><br><span class="line"><span class="number">3</span>     E  <span class="number">27</span>       Young</span><br><span class="line"><span class="number">4</span>     S  <span class="number">32</span>       Young</span><br><span class="line"><span class="number">5</span>     A  <span class="number">36</span> Middle Aged</span><br><span class="line"><span class="number">6</span>     D  <span class="number">25</span>       Young</span><br><span class="line"><span class="number">7</span>     B  <span class="number">11</span>       Young</span><br><span class="line"><span class="number">8</span>     L  <span class="number">53</span> Middle Aged</span><br><span class="line"><span class="number">9</span>     I  <span class="number">31</span>       Young</span><br><span class="line"><span class="number">10</span>    G  <span class="number">25</span>       Young</span><br><span class="line"><span class="number">11</span>    R  <span class="number">16</span>       Young</span><br><span class="line"><span class="number">12</span>    P  <span class="number">51</span> Middle Aged</span><br><span class="line"><span class="number">13</span>    J  <span class="number">30</span>       Young</span><br><span class="line"><span class="number">14</span>    N  <span class="number">38</span> Middle Aged</span><br><span class="line"><span class="number">15</span>    K  <span class="number">20</span>       Young</span><br><span class="line"><span class="number">16</span>    H  <span class="number">53</span> Middle Aged</span><br><span class="line"><span class="number">17</span>    O  <span class="number">13</span>       Young</span><br><span class="line"><span class="number">18</span>    M  <span class="number">63</span>       Elder</span><br><span class="line"><span class="number">19</span>    <span class="literal">F</span>  <span class="number">65</span>       Elder</span><br><span class="line"><span class="number">20</span>    <span class="literal">T</span>  <span class="number">22</span>       Young</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&gt; mydata$old_n &lt;- ifelse(</span><br><span class="line">+     mydata$old &gt; <span class="number">55</span>, <span class="string">"Elder"</span>,</span><br><span class="line">+     ifelse(</span><br><span class="line">          <span class="comment"># 满足mydata$old &gt;= 35 &amp; mydata$old &lt;= "Middle Aged"，否则是"Young"</span></span><br><span class="line">+         mydata$old &gt;= <span class="number">35</span> &amp; mydata$old &lt;= <span class="number">55</span>, <span class="string">"Middle Aged"</span>, <span class="string">"Young"</span></span><br><span class="line">+     )</span><br><span class="line">+ )</span><br><span class="line">&gt; </span><br><span class="line">&gt; mydata</span><br><span class="line">   Name old      agecat       old_n</span><br><span class="line"><span class="number">1</span>     Q  <span class="number">14</span>       Young       Young</span><br><span class="line"><span class="number">2</span>     C  <span class="number">31</span>       Young       Young</span><br><span class="line"><span class="number">3</span>     E  <span class="number">27</span>       Young       Young</span><br><span class="line"><span class="number">4</span>     S  <span class="number">32</span>       Young       Young</span><br><span class="line"><span class="number">5</span>     A  <span class="number">36</span> Middle Aged Middle Aged</span><br><span class="line"><span class="number">6</span>     D  <span class="number">25</span>       Young       Young</span><br><span class="line"><span class="number">7</span>     B  <span class="number">11</span>       Young       Young</span><br><span class="line"><span class="number">8</span>     L  <span class="number">53</span> Middle Aged Middle Aged</span><br><span class="line"><span class="number">9</span>     I  <span class="number">31</span>       Young       Young</span><br><span class="line"><span class="number">10</span>    G  <span class="number">25</span>       Young       Young</span><br><span class="line"><span class="number">11</span>    R  <span class="number">16</span>       Young       Young</span><br><span class="line"><span class="number">12</span>    P  <span class="number">51</span> Middle Aged Middle Aged</span><br><span class="line"><span class="number">13</span>    J  <span class="number">30</span>       Young       Young</span><br><span class="line"><span class="number">14</span>    N  <span class="number">38</span> Middle Aged Middle Aged</span><br><span class="line"><span class="number">15</span>    K  <span class="number">20</span>       Young       Young</span><br><span class="line"><span class="number">16</span>    H  <span class="number">53</span> Middle Aged Middle Aged</span><br><span class="line"><span class="number">17</span>    O  <span class="number">13</span>       Young       Young</span><br><span class="line"><span class="number">18</span>    M  <span class="number">63</span>       Elder       Elder</span><br><span class="line"><span class="number">19</span>    <span class="literal">F</span>  <span class="number">65</span>       Elder       Elder</span><br><span class="line"><span class="number">20</span>    <span class="literal">T</span>  <span class="number">22</span>       Young       Young</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># aggregate聚合函数（只能实现一个聚合指标）</span></span><br><span class="line"><span class="comment"># ~右边Species是分组依据，左边是要计算的数据，iris1是数据框名称，mean是要进行的运算</span></span><br><span class="line">&gt; aggregate(Sepal.Length~Species, iris1, mean)</span><br><span class="line">     Species Sepal.Length</span><br><span class="line"><span class="number">1</span>     setosa        <span class="number">5.006</span></span><br><span class="line"><span class="number">2</span> versicolor        <span class="number">5.936</span></span><br><span class="line"><span class="number">3</span>  virginica        <span class="number">6.588</span></span><br><span class="line">&gt; aggregate(Sepal.Length~Species, iris1, sum)</span><br><span class="line">     Species Sepal.Length</span><br><span class="line"><span class="number">1</span>     setosa        <span class="number">250.3</span></span><br><span class="line"><span class="number">2</span> versicolor        <span class="number">296.8</span></span><br><span class="line"><span class="number">3</span>  virginica        <span class="number">329.4</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># group_by+summarize实现了基于分组的自由聚合（与SQL中的标准聚合语法group by +聚合函数差不多）</span></span><br><span class="line">&gt; iris1 %&gt;% </span><br><span class="line">+     group_by(Species) %&gt;%</span><br><span class="line">+     <span class="comment"># 可聚合多个变量</span></span><br><span class="line">+      summarize(</span><br><span class="line">+         means = mean(Sepal.Length),</span><br><span class="line">+         sums = sum(Sepal.Length)</span><br><span class="line">+     )</span><br><span class="line"><span class="comment"># A tibble: 3 x 3</span></span><br><span class="line">  Species    means  sums</span><br><span class="line">  &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;</span><br><span class="line"><span class="number">1</span> setosa      <span class="number">5.01</span>  <span class="number">250.</span></span><br><span class="line"><span class="number">2</span> versicolor  <span class="number">5.94</span>  <span class="number">297.</span></span><br><span class="line"><span class="number">3</span> virginica   <span class="number">6.59</span>  <span class="number">329.</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment"># tapply专门用于聚合变量，但也只能聚合一个</span></span><br><span class="line">&gt; tapply(iris1$Sepal.Length, iris$Species, mean)</span><br><span class="line">    setosa versicolor  virginica </span><br><span class="line">     <span class="number">5.006</span>      <span class="number">5.936</span>      <span class="number">6.588</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># plyr包里面的ddply函数是一个极其高效的向量化聚合函数</span></span><br><span class="line">&gt; <span class="keyword">library</span>(<span class="string">'plyr'</span>)</span><br><span class="line">&gt; ddply(</span><br><span class="line">+     iris1,</span><br><span class="line">+     .(Species),</span><br><span class="line">+     summarize,</span><br><span class="line">+     means = mean(Sepal.Length),</span><br><span class="line">+     sums = sum(Sepal.Length)</span><br><span class="line">+ )</span><br><span class="line">     Species means  sums</span><br><span class="line"><span class="number">1</span>     setosa <span class="number">5.006</span> <span class="number">250.3</span></span><br><span class="line"><span class="number">2</span> versicolor <span class="number">5.936</span> <span class="number">296.8</span></span><br><span class="line"><span class="number">3</span>  virginica <span class="number">6.588</span> <span class="number">329.4</span></span><br></pre></td></tr></table></figure><h1 id="数据合并-追加与塑性"><a class="markdownIt-Anchor" href="#数据合并-追加与塑性"></a> 数据合并、追加与塑性</h1><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fr0w2xxa0xj20rq090wi9.jpg" alt=""></p><h1 id="字符串处理与正则表达式"><a class="markdownIt-Anchor" href="#字符串处理与正则表达式"></a> 字符串处理与正则表达式</h1><h1 id="管道函数与向量化运算"><a class="markdownIt-Anchor" href="#管道函数与向量化运算"></a> 管道函数与向量化运算</h1><h1 id="非结构化数据与列表"><a class="markdownIt-Anchor" href="#非结构化数据与列表"></a> 非结构化数据与列表</h1><h1 id="r语言与数据库交互"><a class="markdownIt-Anchor" href="#r语言与数据库交互"></a> R语言与数据库交互</h1><h1 id="数据梳理神器datatable"><a class="markdownIt-Anchor" href="#数据梳理神器datatable"></a> 数据梳理神器（data.table)</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;r语言基础数据结构&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#r语言基础数据结构&quot;&gt;&lt;/a&gt; R语言基础数据结构&lt;/h1&gt;
&lt;p&gt;基本数据类型：向量、数组、列表&lt;/p&gt;
&lt;p&gt;向量是最基本的，被称为原子型&lt;/p&gt;
&lt;p&gt;&lt;img s
      
    
    </summary>
    
    
      <category term="R" scheme="http://yoursite.com/tags/R/"/>
    
  </entry>
  
  <entry>
    <title>用Eclipse创建第一个java程序</title>
    <link href="http://yoursite.com/post/a1360cb8.html"/>
    <id>http://yoursite.com/post/a1360cb8.html</id>
    <published>2018-05-05T05:57:32.000Z</published>
    <updated>2018-07-23T05:02:20.305Z</updated>
    
    <content type="html"><![CDATA[<p>启动eclipse</p><p>File ----&gt; New ----&gt; Create Java Project</p><p>输入项目名称，自己起名即可，如helloworld</p><p>新创建的项目结构如下：</p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fr0fdplqs2j20yx0hkdhs.jpg" alt=""></p><p>在scr下，右键点击Package</p><p>name中输入my：</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fr0fgi324hj20mp0h5jsd.jpg" alt=""></p><p>src下面会多一个叫my的包</p><p>下面添加代码</p><p>右键my</p><p>New ----&gt; Class</p><p>Name输入HelloWorld</p><p>勾选public static void main(String[] args)</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fr0ftmnrg7j20gi0j5js7.jpg" alt=""></p><p>my下多了一个java文件：</p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fr0fvce59ij20t90d1757.jpg" alt=""></p><p>于是可以在HelloWorld.java中编写第一个程序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        System.out.println(<span class="string">"helloworld"</span>);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>右键 Run as ----&gt; 1 Java Application</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;启动eclipse&lt;/p&gt;
&lt;p&gt;File ----&amp;gt; New ----&amp;gt; Create Java Project&lt;/p&gt;
&lt;p&gt;输入项目名称，自己起名即可，如helloworld&lt;/p&gt;
&lt;p&gt;新创建的项目结构如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http
      
    
    </summary>
    
      <category term="java" scheme="http://yoursite.com/categories/java/"/>
    
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>seaborn常用图形</title>
    <link href="http://yoursite.com/post/534f1aa6.html"/>
    <id>http://yoursite.com/post/534f1aa6.html</id>
    <published>2018-05-03T02:36:20.000Z</published>
    <updated>2018-07-23T05:02:20.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="style"><a class="markdownIt-Anchor" href="#style"></a> style</h1><h2 id="风格管理"><a class="markdownIt-Anchor" href="#风格管理"></a> 风格管理</h2><ul><li>darkgrid/whitegrid：更关注数值</li><li>dark/white：更关注整体趋势</li><li>ticks：强化刻度</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.set_style(<span class="string">"whitegrid"</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.despine()</span><br></pre></td></tr></table></figure><h2 id="尺度参数设置"><a class="markdownIt-Anchor" href="#尺度参数设置"></a> 尺度参数设置</h2><ul><li>paper</li><li>talk</li><li>notebook</li><li>poster</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.set_context(<span class="string">"poster"</span>)</span><br></pre></td></tr></table></figure><h2 id="颜色管理"><a class="markdownIt-Anchor" href="#颜色管理"></a> 颜色管理</h2><h3 id="分类调色板"><a class="markdownIt-Anchor" href="#分类调色板"></a> 分类调色板</h3><ul><li>适用于分类描述的数据，而且分类之间无序</li><li>hls颜色系统，色调+亮度+饱和度（hue + luminance + saturation）</li><li>husl颜色系统，hls中不同颜色存在视差，eg.黄色偏亮，蓝色偏暗，husl使得更加平衡</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sns.set_palette(sns.color_palette(<span class="string">"hls"</span>, <span class="number">10</span>), desat=<span class="number">0.9</span>)</span><br><span class="line">current_palette = sns.color_palette()</span><br><span class="line">sns.palplot(current_palette)</span><br></pre></td></tr></table></figure><h3 id="序列调色板"><a class="markdownIt-Anchor" href="#序列调色板"></a> 序列调色板</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.palplot(sns.color_palette(&quot;Greens&quot;,10))</span><br></pre></td></tr></table></figure><h3 id="交叉调色板"><a class="markdownIt-Anchor" href="#交叉调色板"></a> 交叉调色板</h3><ul><li>主要通过亮度和饱和度区分有序分类</li><li>关注单级数据</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.palplot(sns.color_palette(<span class="string">"coolwarm"</span>,<span class="number">11</span>))</span><br></pre></td></tr></table></figure><h1 id="变量间的关系"><a class="markdownIt-Anchor" href="#变量间的关系"></a> 变量间的关系</h1><h2 id="绘制线性回归模型"><a class="markdownIt-Anchor" href="#绘制线性回归模型"></a> 绘制线性回归模型</h2><p><strong>一般形式</strong></p><ul><li><p>最简单的方式：散点图 + 线性回归 + 95%置信区间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, data=tips) <span class="comment"># confidence interval</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="C:%5CUsers%5Cmy%5CAppData%5CLocal%5CTemp%5C1525330528669.png" alt=""></p><p><strong>局部加权回归散点平滑</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, data=tips, lowess=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy5oa68rqj20dx09uq32.jpg" alt=""></p><p><strong>方法1 加抖动</strong></p><p>有时散点图上的点会重合在一起，可以加个抖动给抖动开。</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy5u34qobj20dr0bwdfz.jpg" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(x=<span class="string">"size"</span>, y=<span class="string">"tip"</span>, data=tips, x_jitter=<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy5veeuy6j20c80a2wem.jpg" alt=""></p><p><strong>方法2 离散取值上用均值和置信区间代替散点</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(x=<span class="string">"size"</span>, y=<span class="string">"tip"</span>, data=tips, x_estimator=np.mean)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy5ze28b8j20dh09vmx9.jpg" alt=""></p><h2 id="拟合不同模型"><a class="markdownIt-Anchor" href="#拟合不同模型"></a> 拟合不同模型</h2><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy617u1vlj20ll0dyjro.jpg" alt=""></p><p><strong>指定阶数</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lmplot(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, data=anscombe.query(<span class="string">"dataset == 'II'"</span>), ci=<span class="keyword">None</span>, scatter_kws=&#123;<span class="string">"s"</span>: <span class="number">80</span>&#125;, order=<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy65xeiopj20ea09r74c.jpg" alt=""></p><p><strong>异常值</strong></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy67ivgeqj20lx0bjmxb.jpg" alt=""></p><p><strong>逻辑回归</strong></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy69i81bxj20jz0e3t94.jpg" alt=""></p><p><strong>残差曲线</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy6cr90rkj20kx09pdfx.jpg" alt=""></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy6e05dmij20i00bx0sw.jpg" alt=""></p><h2 id="变量间条件关系"><a class="markdownIt-Anchor" href="#变量间条件关系"></a> 变量间条件关系</h2><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy6fkiee2j20f70c3aaj.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy6gjosj2j20i00cjwf1.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy6hl0q1wj20nh0dq759.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy6im9jr0j20m10jcq5a.jpg" alt=""></p><h2 id="控制图片的大小和形状"><a class="markdownIt-Anchor" href="#控制图片的大小和形状"></a> 控制图片的大小和形状</h2><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy6kce1dhj20ja0i43zv.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy6lgmbktj20s308nab1.jpg" alt=""></p><h1 id="分布"><a class="markdownIt-Anchor" href="#分布"></a> 分布</h1><h2 id="单变量"><a class="markdownIt-Anchor" href="#单变量"></a> 单变量</h2><p><strong>灰度图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy7r0efr9j20iy09nmx7.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy7ri9jp4j20cz0a3dfv.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy7rc01j5j20ee099glr.jpg" alt=""></p><p><strong>核密度估计</strong></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy8ag8sz2j20ij09ddg1.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8amiqllj20cz0cumxo.jpg" alt=""></p><p><strong>模型参数拟合</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy8c3g3uxj20cs09omxc.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy8czr5lqj20c709gmxf.jpg" alt=""></p><h2 id="双变量分布"><a class="markdownIt-Anchor" href="#双变量分布"></a> 双变量分布</h2><p><strong>散点图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy8e1tzl6j20dh0dj0t9.jpg" alt=""></p><p><strong>六角箱图</strong></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8f8yq7rj20gn0h3mza.jpg" alt=""></p><p><strong>核密度估计</strong></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8gbe27qj20f70dqaae.jpg" alt=""></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy8hf6490j20fs0gr3zs.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy8iih6sdj20k60fdaad.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8je2i4wj20l00g2754.jpg" alt=""></p><h2 id="数据集中的两两关系"><a class="markdownIt-Anchor" href="#数据集中的两两关系"></a> 数据集中的两两关系</h2><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy8kzuf0bj20iy0hgmzm.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8m6rz2cj20gl0i142b.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8n5kd43j20i40he40s.jpg" alt=""></p><h1 id="分类数据"><a class="markdownIt-Anchor" href="#分类数据"></a> 分类数据</h1><h2 id="分类散点图"><a class="markdownIt-Anchor" href="#分类散点图"></a> 分类散点图</h2><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy8ujlfxfj20dl0b3aa9.jpg" alt=""></p><p>点重叠在一起，可以抖动</p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy8vanbgoj20e009x3yr.jpg" alt=""></p><p>或者蜂群图</p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy8wriu3nj20gm0c8t95.jpg" alt=""></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy8xzapfej20dn0awaah.jpg" alt=""></p><h2 id="分类分布图"><a class="markdownIt-Anchor" href="#分类分布图"></a> 分类分布图</h2><p><strong>箱图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqycef36fjj20d20addfx.jpg" alt=""></p><p><strong>提琴图</strong></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqycg24kfoj20ep098wew.jpg" alt=""></p><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqycg7uqe7j20i709hgm4.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqycgp8ui8j20hv09j0t9.jpg" alt=""></p><h2 id="分类统计估计图"><a class="markdownIt-Anchor" href="#分类统计估计图"></a> 分类统计估计图</h2><p><strong>统计柱状图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy90jxp3lj20m70fuwex.jpg" alt=""></p><p><strong>灰度柱状图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy91hevqqj20fi09hdfu.jpg" alt=""></p><p><strong>点图</strong></p><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy929o6wjj20lm0fzmxr.jpg" alt=""></p><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy936948qj20kw0i2aan.jpg" alt=""></p><p><strong>分类子图</strong></p><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy940hiprj20k409mdga.jpg" alt=""></p><p><strong>多分类标准的子图</strong></p><p><img src="C:%5CUsers%5Cmy%5CDesktop%5C%E5%9B%BE%E7%89%87%5C%E5%A4%9A%E5%88%86%E7%B1%BB.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;style&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#style&quot;&gt;&lt;/a&gt; style&lt;/h1&gt;
&lt;h2 id=&quot;风格管理&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#风格管理&quot;&gt;&lt;/a&gt; 风格管理&lt;
      
    
    </summary>
    
    
      <category term="matplotlib python数据可视化" scheme="http://yoursite.com/tags/matplotlib-python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>matplotlib常用图形</title>
    <link href="http://yoursite.com/post/e123bc90.html"/>
    <id>http://yoursite.com/post/e123bc90.html</id>
    <published>2018-05-03T02:36:06.000Z</published>
    <updated>2018-07-23T05:02:20.275Z</updated>
    
    <content type="html"><![CDATA[<h1 id="常用设置"><a class="markdownIt-Anchor" href="#常用设置"></a> 常用设置</h1><ul><li>获得当前图表对象 fig = matplotlib.pyplot.gcf() # gcf = get current figure</li><li>常用图表对象设置 fig.set_size_inches(10,10), matplotlib.pyplot.figure(figsize=(14,7))</li><li>保存当前图表对象 matplotlib.pyplot.savefig(“figure1.png”)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 设置一些全局的资源参数，可以进行个性化修改</span><br><span class="line">import matplotlib</span><br><span class="line"># 设置图片尺寸 14&quot; x 7&quot;</span><br><span class="line"># rc: resource configuration</span><br><span class="line">matplotlib.rc(&apos;figure&apos;, figsize = (14, 7))</span><br><span class="line"># 设置字体 14</span><br><span class="line">matplotlib.rc(&apos;font&apos;, size = 14)</span><br><span class="line"># 不显示网格</span><br><span class="line">matplotlib.rc(&apos;axes&apos;, grid = False)</span><br><span class="line"># 设置背景颜色是白色</span><br><span class="line">matplotlib.rc(&apos;axes&apos;, facecolor = &apos;white&apos;)</span><br></pre></td></tr></table></figure><p><strong>颜色/线条/标记</strong></p><ul><li>pyplot.plot(x, color=‘g’)</li><li>pyplot.plot(x, linestyle=’–’)</li><li>pyplot.plot(x, marker=’+’)</li><li>pyplot.plot(x, ‘ro-’)</li></ul><p><strong>标题</strong></p><ul><li>pyplot.title(“xxxx”)</li></ul><p><strong>坐标轴标签</strong></p><ul><li>pyplot.xlabel(“xxxx”)</li><li>pyplot.ylabel(“xxxx”)</li></ul><p><strong>图注</strong></p><ul><li>pyplot.legend(loc=“best”)配合pyplot.plot(label=“xxxx”)</li></ul><p><strong>网格</strong></p><ul><li>pyplot.grid(color=“xxx”, linestyle=&quot;-&quot;, alpha=0.5)</li></ul><h1 id="关联分析"><a class="markdownIt-Anchor" href="#关联分析"></a> 关联分析</h1><h2 id="散点图"><a class="markdownIt-Anchor" href="#散点图"></a> 散点图</h2><p>分析变量关系</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scatterplot</span><span class="params">(x_data, y_data, x_label, y_label, title)</span>:</span></span><br><span class="line">    <span class="comment"># 创建一个绘图对象</span></span><br><span class="line">    fig, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 不显示顶部和右侧的坐标线</span></span><br><span class="line">    ax.spines[<span class="string">'top'</span>].set_color(<span class="string">'none'</span>)</span><br><span class="line">    ax.spines[<span class="string">'right'</span>].set_color(<span class="string">'none'</span>)</span><br><span class="line">    <span class="comment"># 设置数据、点的大小、点的颜色和透明度</span></span><br><span class="line">    ax.scatter(x_data, y_data, s = <span class="number">20</span>, color = <span class="string">'#539caf'</span>, alpha = <span class="number">0.2</span>) <span class="comment"># 配色查询：http://tool.oschina.net/commons?type=3</span></span><br><span class="line">    <span class="comment"># 添加标题和坐标说明</span></span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 绘制散点图</span></span><br><span class="line">scatterplot(x_data = daily_data[<span class="string">'temp'</span>]</span><br><span class="line">            , y_data = daily_data[<span class="string">'cnt'</span>]</span><br><span class="line">            , x_label = <span class="string">'Normalized temperature (C)'</span></span><br><span class="line">            , y_label = <span class="string">'Check outs'</span></span><br><span class="line">            , title = <span class="string">'Number of Check Outs vs Temperature'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy0r93wz7j20mi0blabo.jpg" alt=""></p><h2 id="曲线图"><a class="markdownIt-Anchor" href="#曲线图"></a> 曲线图</h2><p>拟合变量关系</p><h3 id="一般曲线图"><a class="markdownIt-Anchor" href="#一般曲线图"></a> 一般曲线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lineplot</span><span class="params">(x_data, y_data, x_label, y_label, title)</span>:</span></span><br><span class="line">    <span class="comment"># 创建绘图对象</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 绘制拟合曲线，lw=linewidth，alpha=transparancy</span></span><br><span class="line">    ax.plot(x_data, y_data, lw = <span class="number">2</span>, color = <span class="string">'#539caf'</span>, alpha = <span class="number">0.5</span>)</span><br><span class="line">    <span class="comment"># 添加标题和坐标说明</span></span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 调用绘图函数</span></span><br><span class="line">lineplot(x_data = daily_data[<span class="string">'temp'</span>]</span><br><span class="line">         , y_data = fitted_values</span><br><span class="line">         , x_label = <span class="string">'Normalized temperature (C)'</span></span><br><span class="line">         , y_label = <span class="string">'Check outs'</span></span><br><span class="line">         , title = <span class="string">'Line of Best Fit for Number of Check Outs vs Temperature'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy0ts1nj6j20nu0bh3z5.jpg" alt=""></p><h3 id="带置信区间的曲线图"><a class="markdownIt-Anchor" href="#带置信区间的曲线图"></a> 带置信区间的曲线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lineplotCI</span><span class="params">(x_data, y_data, sorted_x, low_CI, upper_CI, x_label, y_label, title)</span>:</span></span><br><span class="line">    <span class="comment"># 创建绘图对象</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 绘制预测曲线</span></span><br><span class="line">    ax.plot(x_data, y_data, lw = <span class="number">1</span>, color = <span class="string">'#539caf'</span>, alpha = <span class="number">1</span>, label = <span class="string">'Fit'</span>)</span><br><span class="line">    <span class="comment"># 绘制置信区间，顺序填充</span></span><br><span class="line">    ax.fill_between(sorted_x, low_CI, upper_CI, color = <span class="string">'#539caf'</span>, alpha = <span class="number">0.4</span>, label = <span class="string">'95% CI'</span>)</span><br><span class="line">    <span class="comment"># 添加标题和坐标说明</span></span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    <span class="comment"># 显示图例，配合label参数，loc=“best”自适应方式</span></span><br><span class="line">    ax.legend(loc = <span class="string">'best'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Call the function to create plot</span></span><br><span class="line">lineplotCI(x_data = daily_data[<span class="string">'temp'</span>]</span><br><span class="line">           , y_data = fitted_values</span><br><span class="line">           , sorted_x = CI_df[<span class="string">'x_data'</span>]</span><br><span class="line">           , low_CI = CI_df[<span class="string">'low_CI'</span>]</span><br><span class="line">           , upper_CI = CI_df[<span class="string">'upper_CI'</span>]</span><br><span class="line">           , x_label = <span class="string">'Normalized temperature (C)'</span></span><br><span class="line">           , y_label = <span class="string">'Check outs'</span></span><br><span class="line">           , title = <span class="string">'Line of Best Fit for Number of Check Outs vs Temperature'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy0wjkhvhj20my0bkjsc.jpg" alt=""></p><h3 id="双坐标曲线"><a class="markdownIt-Anchor" href="#双坐标曲线"></a> 双坐标曲线</h3><ul><li>曲线拟合不满足置信阈值时，考虑增加独立变量</li><li>分析不同尺度多变量的关系</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lineplot2y</span><span class="params">(x_data, x_label, y1_data, y1_color, y1_label, y2_data, y2_color, y2_label, title)</span>:</span></span><br><span class="line">    _, ax1 = plt.subplots()</span><br><span class="line">    ax1.plot(x_data, y1_data, color = y1_color)</span><br><span class="line">    <span class="comment"># 添加标题和坐标说明</span></span><br><span class="line">    ax1.set_ylabel(y1_label, color = y1_color)</span><br><span class="line">    ax1.set_xlabel(x_label)</span><br><span class="line">    ax1.set_title(title)</span><br><span class="line">    ax2 = ax1.twinx() <span class="comment"># 两个绘图对象共享横坐标轴</span></span><br><span class="line">    ax2.plot(x_data, y2_data, color = y2_color)</span><br><span class="line">    ax2.set_ylabel(y2_label, color = y2_color)</span><br><span class="line">    <span class="comment"># 右侧坐标轴可见</span></span><br><span class="line">    ax2.spines[<span class="string">'right'</span>].set_visible(<span class="keyword">True</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 调用绘图函数</span></span><br><span class="line">lineplot2y(x_data = daily_data[<span class="string">'dteday'</span>]</span><br><span class="line">           , x_label = <span class="string">'Day'</span></span><br><span class="line">           , y1_data = daily_data[<span class="string">'cnt'</span>]</span><br><span class="line">           , y1_color = <span class="string">'#539caf'</span></span><br><span class="line">           , y1_label = <span class="string">'Check outs'</span></span><br><span class="line">           , y2_data = daily_data[<span class="string">'windspeed'</span>]</span><br><span class="line">           , y2_color = <span class="string">'#7663b0'</span></span><br><span class="line">           , y2_label = <span class="string">'Normalized windspeed'</span></span><br><span class="line">           , title = <span class="string">'Check Outs and Windspeed Over Time'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx1.sinaimg.cn/mw690/c3a5a043ly1fqy0ypi8azj20nt0avjwh.jpg" alt=""></p><h1 id="分布分析"><a class="markdownIt-Anchor" href="#分布分析"></a> 分布分析</h1><h2 id="灰度图"><a class="markdownIt-Anchor" href="#灰度图"></a> 灰度图</h2><p>粗略区间计数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制灰度图的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">histogram</span><span class="params">(data, x_label, y_label, title)</span>:</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    res = ax.hist(data, color = <span class="string">'#539caf'</span>, bins=<span class="number">50</span>, edgecolor=<span class="string">'k'</span>) <span class="comment"># 设置bin的数量</span></span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图函数调用</span></span><br><span class="line">res = histogram(data = daily_data[<span class="string">'registered'</span>]</span><br><span class="line">           , x_label = <span class="string">'Check outs'</span></span><br><span class="line">           , y_label = <span class="string">'Frequency'</span></span><br><span class="line">           , title = <span class="string">'Distribution of Registered Check Outs'</span>)</span><br><span class="line">res[<span class="number">0</span>] <span class="comment"># value of bins</span></span><br><span class="line">res[<span class="number">1</span>] <span class="comment"># boundary of bins</span></span><br></pre></td></tr></table></figure><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy12d5w72j20mg0c0dgc.jpg" alt=""></p><h2 id="堆叠直方图"><a class="markdownIt-Anchor" href="#堆叠直方图"></a> 堆叠直方图</h2><p>比较两个分布</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制堆叠的直方图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">overlaid_histogram</span><span class="params">(data1, data1_name, data1_color, data2, data2_name, data2_color, x_label, y_label, title)</span>:</span></span><br><span class="line">    <span class="comment"># 归一化数据区间，对齐两个直方图的bins</span></span><br><span class="line">    max_nbins = <span class="number">20</span></span><br><span class="line">    data_range = [min(min(data1), min(data2)), max(max(data1), max(data2))]</span><br><span class="line">    binwidth = (data_range[<span class="number">1</span>] - data_range[<span class="number">0</span>]) / max_nbins</span><br><span class="line">    bins = np.arange(data_range[<span class="number">0</span>], data_range[<span class="number">1</span>] + binwidth, binwidth) <span class="comment"># 生成直方图bins区间</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create the plot</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    ax.hist(data1, bins = bins, color = data1_color, alpha = <span class="number">1</span>, label = data1_name, edgecolor=<span class="string">'k'</span>)</span><br><span class="line">    ax.hist(data2, bins = bins, color = data2_color, alpha = <span class="number">0.75</span>, label = data2_name, edgecolor=<span class="string">'k'</span>)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.legend(loc = <span class="string">'best'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Call the function to create plot</span></span><br><span class="line">overlaid_histogram(data1 = daily_data[<span class="string">'registered'</span>]</span><br><span class="line">                   , data1_name = <span class="string">'Registered'</span></span><br><span class="line">                   , data1_color = <span class="string">'#539caf'</span></span><br><span class="line">                   , data2 = daily_data[<span class="string">'casual'</span>]</span><br><span class="line">                   , data2_name = <span class="string">'Casual'</span></span><br><span class="line">                   , data2_color = <span class="string">'#7663b0'</span></span><br><span class="line">                   , x_label = <span class="string">'Check outs'</span></span><br><span class="line">                   , y_label = <span class="string">'Frequency'</span></span><br><span class="line">                   , title = <span class="string">'Distribution of Check Outs By Type'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy23p0kepj20nc0bk74t.jpg" alt=""></p><h2 id="密度图"><a class="markdownIt-Anchor" href="#密度图"></a> 密度图</h2><ul><li>精细刻画概率分布</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 计算概率密度</span><br><span class="line">from scipy.stats import gaussian_kde</span><br><span class="line">data = daily_data[&apos;registered&apos;]</span><br><span class="line">density_est = gaussian_kde(data) # kernal density estimate: https://en.wikipedia.org/wiki/Kernel_density_estimation</span><br><span class="line"># 控制平滑程度，数值越大，越平滑哈</span><br><span class="line">density_est.covariance_factor = lambda : 0.5</span><br><span class="line">density_est._compute_covariance()</span><br><span class="line">x_data = np.arange(min(data), max(data), 200)</span><br><span class="line"></span><br><span class="line"># 绘制密度估计曲线</span><br><span class="line">def densityplot(x_data, density_est, x_label, y_label, title):</span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    ax.plot(x_data, density_est(x_data), color = &apos;#539caf&apos;, lw = 4)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line"></span><br><span class="line"># 调用绘图函数</span><br><span class="line">densityplot(x_data = x_data</span><br><span class="line">            , density_est = density_est</span><br><span class="line">            , x_label = &apos;Check outs&apos;</span><br><span class="line">            , y_label = &apos;Frequency&apos;</span><br><span class="line">            , title = &apos;Distribution of Registered Check Outs&apos;)</span><br></pre></td></tr></table></figure><p><img src="http://wx4.sinaimg.cn/mw690/c3a5a043ly1fqy25jhljzj20mr0b50tl.jpg" alt=""></p><h1 id="组间分析"><a class="markdownIt-Anchor" href="#组间分析"></a> 组间分析</h1><ul><li>组间定量比较</li><li>分组粒度</li><li>组间聚类</li></ul><h2 id="柱状图"><a class="markdownIt-Anchor" href="#柱状图"></a> 柱状图</h2><ul><li><p>一级类间均值方差比较</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分天分析统计特征</span></span><br><span class="line">mean_total_co_day = daily_data[[<span class="string">'weekday'</span>, <span class="string">'cnt'</span>]].groupby(<span class="string">'weekday'</span>).agg([np.mean, np.std])</span><br><span class="line">mean_total_co_day.columns = mean_total_co_day.columns.droplevel()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义绘制柱状图的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">barplot</span><span class="params">(x_data, y_data, error_data, x_label, y_label, title)</span>:</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 柱状图</span></span><br><span class="line">    ax.bar(x_data, y_data, color = <span class="string">'#539caf'</span>, align = <span class="string">'center'</span>)</span><br><span class="line">    <span class="comment"># 绘制方差</span></span><br><span class="line">    <span class="comment"># ls='none'去掉bar之间的连线</span></span><br><span class="line">    ax.errorbar(x_data, y_data, yerr = error_data, color = <span class="string">'#297083'</span>, ls = <span class="string">'none'</span>, lw = <span class="number">5</span>) <span class="comment"># ls = line style</span></span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图函数调用</span></span><br><span class="line">barplot(x_data = mean_total_co_day.index.values</span><br><span class="line">        , y_data = mean_total_co_day[<span class="string">'mean'</span>]</span><br><span class="line">        , error_data = mean_total_co_day[<span class="string">'std'</span>]</span><br><span class="line">        , x_label = <span class="string">'Day of week'</span></span><br><span class="line">        , y_label = <span class="string">'Check outs'</span></span><br><span class="line">        , title = <span class="string">'Total Check Outs By Day of Week (0 = Sunday)'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy2dkhtaij20m80bk0t8.jpg" alt=""></p></li></ul><h2 id="堆积柱状图"><a class="markdownIt-Anchor" href="#堆积柱状图"></a> 堆积柱状图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分天统计注册和偶然使用的情况</span></span><br><span class="line">mean_by_reg_co_day = daily_data[[<span class="string">'weekday'</span>, <span class="string">'registered'</span>, <span class="string">'casual'</span>]].groupby(<span class="string">'weekday'</span>).mean()</span><br><span class="line"><span class="comment"># 分天统计注册和偶然使用的占比</span></span><br><span class="line">mean_by_reg_co_day[<span class="string">'total'</span>] = mean_by_reg_co_day[<span class="string">'registered'</span>] + mean_by_reg_co_day[<span class="string">'casual'</span>]</span><br><span class="line">mean_by_reg_co_day[<span class="string">'reg_prop'</span>] = mean_by_reg_co_day[<span class="string">'registered'</span>] / mean_by_reg_co_day[<span class="string">'total'</span>]</span><br><span class="line">mean_by_reg_co_day[<span class="string">'casual_prop'</span>] = mean_by_reg_co_day[<span class="string">'casual'</span>] / mean_by_reg_co_day[<span class="string">'total'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制堆积柱状图</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stackedbarplot</span><span class="params">(x_data, y_data_list, y_data_names, colors, x_label, y_label, title)</span>:</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 循环绘制堆积柱状图</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(y_data_list)):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            ax.bar(x_data, y_data_list[i], color = colors[i], align = <span class="string">'center'</span>, label = y_data_names[i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 采用堆积的方式，除了第一个分类，后面的分类都从前一个分类的柱状图接着画</span></span><br><span class="line">            <span class="comment"># 用归一化保证最终累积结果为1</span></span><br><span class="line">            ax.bar(x_data, y_data_list[i], color = colors[i], bottom = y_data_list[i - <span class="number">1</span>], align = <span class="string">'center'</span>, label = y_data_names[i])</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.legend(loc = <span class="string">'upper left'</span>) <span class="comment"># 设定图例位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用绘图函数</span></span><br><span class="line">stackedbarplot(x_data = mean_by_reg_co_day.index.values</span><br><span class="line">               , y_data_list = [mean_by_reg_co_day[<span class="string">'reg_prop'</span>], mean_by_reg_co_day[<span class="string">'casual_prop'</span>]]</span><br><span class="line">               , y_data_names = [<span class="string">'Registered'</span>, <span class="string">'Casual'</span>]</span><br><span class="line">               , colors = [<span class="string">'#539caf'</span>, <span class="string">'#7663b0'</span>]</span><br><span class="line">               , x_label = <span class="string">'Day of week'</span></span><br><span class="line">               , y_label = <span class="string">'Proportion of check outs'</span></span><br><span class="line">               , title = <span class="string">'Check Outs By Registration Status and Day of Week (0 = Sunday)'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx3.sinaimg.cn/mw690/c3a5a043ly1fqy2fupl5kj20mi0bvjs1.jpg" alt=""></p><h2 id="分组柱状图"><a class="markdownIt-Anchor" href="#分组柱状图"></a> 分组柱状图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制分组柱状图的函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">groupedbarplot</span><span class="params">(x_data, y_data_list, y_data_names, colors, x_label, y_label, title)</span>:</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line">    <span class="comment"># 设置每一组柱状图的宽度</span></span><br><span class="line">    total_width = <span class="number">0.8</span></span><br><span class="line">    <span class="comment"># 设置每一个柱状图的宽度</span></span><br><span class="line">    ind_width = total_width / len(y_data_list)</span><br><span class="line">    <span class="comment"># 计算每一个柱状图的中心偏移</span></span><br><span class="line">    alteration = np.arange(-total_width/<span class="number">2</span>+ind_width/<span class="number">2</span>, total_width/<span class="number">2</span>+ind_width/<span class="number">2</span>, ind_width)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 分别绘制每一个柱状图</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(y_data_list)):</span><br><span class="line">        <span class="comment"># 横向散开绘制</span></span><br><span class="line">        ax.bar(x_data + alteration[i], y_data_list[i], color = colors[i], label = y_data_names[i], width = ind_width)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line">    ax.legend(loc = <span class="string">'upper right'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用绘图函数</span></span><br><span class="line">groupedbarplot(x_data = mean_by_reg_co_day.index.values</span><br><span class="line">               , y_data_list = [mean_by_reg_co_day[<span class="string">'registered'</span>], mean_by_reg_co_day[<span class="string">'casual'</span>]]</span><br><span class="line">               , y_data_names = [<span class="string">'Registered'</span>, <span class="string">'Casual'</span>]</span><br><span class="line">               , colors = [<span class="string">'#539caf'</span>, <span class="string">'#7663b0'</span>]</span><br><span class="line">               , x_label = <span class="string">'Day of week'</span></span><br><span class="line">               , y_label = <span class="string">'Check outs'</span></span><br><span class="line">               , title = <span class="string">'Check Outs By Registration Status and Day of Week (0 = Sunday)'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy2hb37m7j20mc0bp0tc.jpg" alt=""></p><h2 id="箱式图"><a class="markdownIt-Anchor" href="#箱式图"></a> 箱式图</h2><ul><li>多级类间数据分布比较</li><li>柱状图 + 堆叠灰度图</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只需要指定分类的依据，就能自动绘制箱式图</span></span><br><span class="line">days = np.unique(daily_data[<span class="string">'weekday'</span>])</span><br><span class="line">bp_data = []</span><br><span class="line"><span class="keyword">for</span> day <span class="keyword">in</span> days:</span><br><span class="line">    bp_data.append(daily_data[daily_data[<span class="string">'weekday'</span>] == day][<span class="string">'registered'</span>].values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义绘图函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boxplot</span><span class="params">(x_data, y_data, base_color, median_color, x_label, y_label, title)</span>:</span></span><br><span class="line">    _, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置样式</span></span><br><span class="line">    ax.boxplot(y_data</span><br><span class="line">               <span class="comment"># 箱子是否颜色填充</span></span><br><span class="line">               , patch_artist = <span class="keyword">True</span></span><br><span class="line">               <span class="comment"># 中位数线颜色</span></span><br><span class="line">               , medianprops = &#123;<span class="string">'color'</span>: base_color&#125;</span><br><span class="line">               <span class="comment"># 箱子颜色设置，color：边框颜色，facecolor：填充颜色</span></span><br><span class="line">               , boxprops = &#123;<span class="string">'color'</span>: base_color, <span class="string">'facecolor'</span>: median_color&#125;</span><br><span class="line">               <span class="comment"># 猫须颜色whisker</span></span><br><span class="line">               , whiskerprops = &#123;<span class="string">'color'</span>: median_color&#125;</span><br><span class="line">               <span class="comment"># 猫须界限颜色whisker cap</span></span><br><span class="line">               , capprops = &#123;<span class="string">'color'</span>: base_color&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 箱图与x_data保持一致</span></span><br><span class="line">    ax.set_xticklabels(x_data)</span><br><span class="line">    ax.set_ylabel(y_label)</span><br><span class="line">    ax.set_xlabel(x_label)</span><br><span class="line">    ax.set_title(title)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用绘图函数</span></span><br><span class="line">boxplot(x_data = days</span><br><span class="line">        , y_data = bp_data</span><br><span class="line">        , base_color = <span class="string">'b'</span></span><br><span class="line">        , median_color = <span class="string">'r'</span></span><br><span class="line">        , x_label = <span class="string">'Day of week'</span></span><br><span class="line">        , y_label = <span class="string">'Check outs'</span></span><br><span class="line">        , title = <span class="string">'Total Check Outs By Day of Week (0 = Sunday)'</span>)</span><br></pre></td></tr></table></figure><p><img src="http://wx2.sinaimg.cn/mw690/c3a5a043ly1fqy2jfzh9vj20qi0csjrw.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;常用设置&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#常用设置&quot;&gt;&lt;/a&gt; 常用设置&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;获得当前图表对象 fig = matplotlib.pyplot.gcf() # gcf = get current f
      
    
    </summary>
    
    
      <category term="matplotlib python数据可视化" scheme="http://yoursite.com/tags/matplotlib-python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>python数据可视化</title>
    <link href="http://yoursite.com/post/4d591cd8.html"/>
    <id>http://yoursite.com/post/4d591cd8.html</id>
    <published>2018-05-03T02:17:20.000Z</published>
    <updated>2018-07-23T05:02:20.255Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
</feed>
